<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="Michael R. Kearney" />

<meta name="date" content="2022-03-27" />

<title>Microclimate model hourly input example</title>

<script src="data:application/javascript;base64,Ly8gUGFuZG9jIDIuOSBhZGRzIGF0dHJpYnV0ZXMgb24gYm90aCBoZWFkZXIgYW5kIGRpdi4gV2UgcmVtb3ZlIHRoZSBmb3JtZXIgKHRvCi8vIGJlIGNvbXBhdGlibGUgd2l0aCB0aGUgYmVoYXZpb3Igb2YgUGFuZG9jIDwgMi44KS4KZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignRE9NQ29udGVudExvYWRlZCcsIGZ1bmN0aW9uKGUpIHsKICB2YXIgaHMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCJkaXYuc2VjdGlvbltjbGFzcyo9J2xldmVsJ10gPiA6Zmlyc3QtY2hpbGQiKTsKICB2YXIgaSwgaCwgYTsKICBmb3IgKGkgPSAwOyBpIDwgaHMubGVuZ3RoOyBpKyspIHsKICAgIGggPSBoc1tpXTsKICAgIGlmICghL15oWzEtNl0kL2kudGVzdChoLnRhZ05hbWUpKSBjb250aW51ZTsgIC8vIGl0IHNob3VsZCBiZSBhIGhlYWRlciBoMS1oNgogICAgYSA9IGguYXR0cmlidXRlczsKICAgIHdoaWxlIChhLmxlbmd0aCA+IDApIGgucmVtb3ZlQXR0cmlidXRlKGFbMF0ubmFtZSk7CiAgfQp9KTsK"></script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>


<style type="text/css">
  code {
    white-space: pre;
  }
  .sourceCode {
    overflow: visible;
  }
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<link rel="stylesheet" href="data:text/css,body%20%7B%0Abackground%2Dcolor%3A%20%23fff%3B%0Amargin%3A%201em%20auto%3B%0Amax%2Dwidth%3A%20700px%3B%0Aoverflow%3A%20visible%3B%0Apadding%2Dleft%3A%202em%3B%0Apadding%2Dright%3A%202em%3B%0Afont%2Dfamily%3A%20%22Open%20Sans%22%2C%20%22Helvetica%20Neue%22%2C%20Helvetica%2C%20Arial%2C%20sans%2Dserif%3B%0Afont%2Dsize%3A%2014px%3B%0Aline%2Dheight%3A%201%2E35%3B%0A%7D%0A%23TOC%20%7B%0Aclear%3A%20both%3B%0Amargin%3A%200%200%2010px%2010px%3B%0Apadding%3A%204px%3B%0Awidth%3A%20400px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Aborder%2Dradius%3A%205px%3B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Afont%2Dsize%3A%2013px%3B%0Aline%2Dheight%3A%201%2E3%3B%0A%7D%0A%23TOC%20%2Etoctitle%20%7B%0Afont%2Dweight%3A%20bold%3B%0Afont%2Dsize%3A%2015px%3B%0Amargin%2Dleft%3A%205px%3B%0A%7D%0A%23TOC%20ul%20%7B%0Apadding%2Dleft%3A%2040px%3B%0Amargin%2Dleft%3A%20%2D1%2E5em%3B%0Amargin%2Dtop%3A%205px%3B%0Amargin%2Dbottom%3A%205px%3B%0A%7D%0A%23TOC%20ul%20ul%20%7B%0Amargin%2Dleft%3A%20%2D2em%3B%0A%7D%0A%23TOC%20li%20%7B%0Aline%2Dheight%3A%2016px%3B%0A%7D%0Atable%20%7B%0Amargin%3A%201em%20auto%3B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dcolor%3A%20%23DDDDDD%3B%0Aborder%2Dstyle%3A%20outset%3B%0Aborder%2Dcollapse%3A%20collapse%3B%0A%7D%0Atable%20th%20%7B%0Aborder%2Dwidth%3A%202px%3B%0Apadding%3A%205px%3B%0Aborder%2Dstyle%3A%20inset%3B%0A%7D%0Atable%20td%20%7B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dstyle%3A%20inset%3B%0Aline%2Dheight%3A%2018px%3B%0Apadding%3A%205px%205px%3B%0A%7D%0Atable%2C%20table%20th%2C%20table%20td%20%7B%0Aborder%2Dleft%2Dstyle%3A%20none%3B%0Aborder%2Dright%2Dstyle%3A%20none%3B%0A%7D%0Atable%20thead%2C%20table%20tr%2Eeven%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Ap%20%7B%0Amargin%3A%200%2E5em%200%3B%0A%7D%0Ablockquote%20%7B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Apadding%3A%200%2E25em%200%2E75em%3B%0A%7D%0Ahr%20%7B%0Aborder%2Dstyle%3A%20solid%3B%0Aborder%3A%20none%3B%0Aborder%2Dtop%3A%201px%20solid%20%23777%3B%0Amargin%3A%2028px%200%3B%0A%7D%0Adl%20%7B%0Amargin%2Dleft%3A%200%3B%0A%7D%0Adl%20dd%20%7B%0Amargin%2Dbottom%3A%2013px%3B%0Amargin%2Dleft%3A%2013px%3B%0A%7D%0Adl%20dt%20%7B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0Aul%20%7B%0Amargin%2Dtop%3A%200%3B%0A%7D%0Aul%20li%20%7B%0Alist%2Dstyle%3A%20circle%20outside%3B%0A%7D%0Aul%20ul%20%7B%0Amargin%2Dbottom%3A%200%3B%0A%7D%0Apre%2C%20code%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0Aborder%2Dradius%3A%203px%3B%0Acolor%3A%20%23333%3B%0Awhite%2Dspace%3A%20pre%2Dwrap%3B%20%0A%7D%0Apre%20%7B%0Aborder%2Dradius%3A%203px%3B%0Amargin%3A%205px%200px%2010px%200px%3B%0Apadding%3A%2010px%3B%0A%7D%0Apre%3Anot%28%5Bclass%5D%29%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Acode%20%7B%0Afont%2Dfamily%3A%20Consolas%2C%20Monaco%2C%20%27Courier%20New%27%2C%20monospace%3B%0Afont%2Dsize%3A%2085%25%3B%0A%7D%0Ap%20%3E%20code%2C%20li%20%3E%20code%20%7B%0Apadding%3A%202px%200px%3B%0A%7D%0Adiv%2Efigure%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0Aimg%20%7B%0Abackground%2Dcolor%3A%20%23FFFFFF%3B%0Apadding%3A%202px%3B%0Aborder%3A%201px%20solid%20%23DDDDDD%3B%0Aborder%2Dradius%3A%203px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Amargin%3A%200%205px%3B%0A%7D%0Ah1%20%7B%0Amargin%2Dtop%3A%200%3B%0Afont%2Dsize%3A%2035px%3B%0Aline%2Dheight%3A%2040px%3B%0A%7D%0Ah2%20%7B%0Aborder%2Dbottom%3A%204px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Apadding%2Dbottom%3A%202px%3B%0Afont%2Dsize%3A%20145%25%3B%0A%7D%0Ah3%20%7B%0Aborder%2Dbottom%3A%202px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Afont%2Dsize%3A%20120%25%3B%0A%7D%0Ah4%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23f7f7f7%3B%0Amargin%2Dleft%3A%208px%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Ah5%2C%20h6%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23ccc%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Aa%20%7B%0Acolor%3A%20%230033dd%3B%0Atext%2Ddecoration%3A%20none%3B%0A%7D%0Aa%3Ahover%20%7B%0Acolor%3A%20%236666ff%3B%20%7D%0Aa%3Avisited%20%7B%0Acolor%3A%20%23800080%3B%20%7D%0Aa%3Avisited%3Ahover%20%7B%0Acolor%3A%20%23BB00BB%3B%20%7D%0Aa%5Bhref%5E%3D%22http%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0Aa%5Bhref%5E%3D%22https%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0A%0Acode%20%3E%20span%2Ekw%20%7B%20color%3A%20%23555%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Edt%20%7B%20color%3A%20%23902000%3B%20%7D%20%0Acode%20%3E%20span%2Edv%20%7B%20color%3A%20%2340a070%3B%20%7D%20%0Acode%20%3E%20span%2Ebn%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Efl%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Ech%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Est%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Eco%20%7B%20color%3A%20%23888888%3B%20font%2Dstyle%3A%20italic%3B%20%7D%20%0Acode%20%3E%20span%2Eot%20%7B%20color%3A%20%23007020%3B%20%7D%20%0Acode%20%3E%20span%2Eal%20%7B%20color%3A%20%23ff0000%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Efu%20%7B%20color%3A%20%23900%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Eer%20%7B%20color%3A%20%23a61717%3B%20background%2Dcolor%3A%20%23e3d2d2%3B%20%7D%20%0A" type="text/css" />




</head>

<body>




<h1 class="title toc-ignore">Microclimate model hourly input example</h1>
<h4 class="author">Michael R. Kearney</h4>
<h4 class="date">2022-03-27</h4>



<div id="introduction" class="section level3">
<h3>Introduction</h3>
<p>This vignette provides an example of how to run the model using hourly input weather data from the Soil and Climate Network (SCAN) for the USA, working with data for Ford Dry Lake in California for 2015. This dataset is provided in the package as <code>Scan_FordDryLake_2015</code> and has been pre-processed to a small degree as described in the help for this dataset. You can take the R code in this vignette and adapt it to work with other datasets you might have collected yourself or have obtained from elsewhere. Note that there is also an experimental function, <code>micro_SCAN</code>, to run the model from the SCAN data in a more automated fashion. This vignette is Appendix 4 of the NicheMapR microclimate software note, Kearney, M. R., &amp; Porter, W. P. (2017). NicheMapR - an R package for biophysical modelling: the microclimate model. Ecography, 40(5), 664–674. <a href="doi:10.1111/ecog.02360" class="uri">doi:10.1111/ecog.02360</a>.</p>
</div>
<div id="getting-the-site-data" class="section level3">
<h3>Getting the site data</h3>
<p>First load the NicheMapR package and also the zoo package, from which we’ll use the na.approx function to fill in missing data.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(NicheMapR)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(zoo)</span></code></pre></div>
<pre><code>## Warning: package &#39;zoo&#39; was built under R version 4.0.5</code></pre>
<p>Also included in this package is a table of summary information on all the SCAN sites, <code>SCANsites</code>. Have a look at the first 5 by using the ‘head’ function:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(SCANsites)</span></code></pre></div>
<pre><code>##    network  id state                 name      lat        lon elev
## 1 SCAN      15    PR MARICAO FOREST       18.15000  -67.00468 2450
## 2 SCAN     581    MT LINDSAY              47.21415 -105.18702 2871
## 3 SCAN     674    ID ORCHARD RANGE SITE   43.32268 -115.99643 3200
## 4 SCAN     750    NV SHELDON              41.90450 -119.44360 5860
## 5 SCAN     808    MT TABLE MOUNTAIN       45.80272 -111.58655 4474
## 6 SCAN     965    AK IKALUKROK CREEK      68.08333 -163.00000  650
##             county NRCS Soil Survey Pedon Code GMT offset          start date
## 1         MAYAGUEZ                       28522         -4 2001-05-08 00:00:00
## 2           DAWSON                       33997         -7 2006-10-22 06:59:59
## 3              ADA                        NULL         -8 2004-03-19 12:59:59
## 4           WASHOE                       16312         -8 1996-09-17 14:00:00
## 5         GALLATIN                        NULL         -7 2006-10-25 15:00:00
## 6 NORTHWEST ARCTIC                        &lt;NA&gt;         -9 2006-10-01 00:00:00</code></pre>
<p>Now we’ll choose the Ford Dry Lake site and put some of the summary data that we need into variables:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>sitenum <span class="ot">&lt;-</span> <span class="st">&#39;2184&#39;</span> <span class="co"># Ford Dry Lake</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>site <span class="ot">&lt;-</span> <span class="fu">subset</span>(SCANsites, id <span class="sc">==</span> sitenum) <span class="co"># subset the SCANsites dataset for Ford Dry Lake</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>name <span class="ot">&lt;-</span> site<span class="sc">$</span>name <span class="co"># the name of the sites</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>Latitude <span class="ot">&lt;-</span> site<span class="sc">$</span>lat <span class="co"># the latitude in decimal degrees</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>Longitude <span class="ot">&lt;-</span> site<span class="sc">$</span>lon <span class="co"># the longitude in decimal degrees</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>Elevation <span class="ot">&lt;-</span> site<span class="sc">$</span>elev <span class="sc">/</span> <span class="fl">3.28084</span> <span class="co"># elevation, converted from feet to metres</span></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>TZoffset <span class="ot">&lt;-</span> site<span class="sc">$</span><span class="st">`</span><span class="at">GMT offset</span><span class="st">`</span> <span class="co"># the offset from Greenwich Mean Time, in hours</span></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>ystart <span class="ot">&lt;-</span> <span class="dv">2015</span> <span class="co"># start yeaar</span></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>yfinish <span class="ot">&lt;-</span> <span class="dv">2015</span> <span class="co"># end year</span></span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>nyears <span class="ot">&lt;-</span> yfinish <span class="sc">-</span> ystart <span class="sc">+</span> <span class="dv">1</span> <span class="co"># number of years to run</span></span></code></pre></div>
<p>The SCAN data for Ford Dry Lake is included as a preloaded datatable too, <code>SCAN_FordDryLake_2015</code>. We will now create a new variable called <code>weather</code> based on this dataset:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>weather <span class="ot">&lt;-</span> SCAN_FordDryLake_2015 <span class="co"># make SCAN_FordDrylake_2015 supplied package data the weather input variable</span></span></code></pre></div>
</div>
<div id="setting-the-model-modes" class="section level3">
<h3>Setting the model modes</h3>
<p>These parameters control how the model runs. We will run the model for both sun and shade, with the soil moisture and snow options on, and also note that the hourly parameter is also on so that it uses the hourly SCAN weather data as input</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>writecsv <span class="ot">&lt;-</span> <span class="dv">0</span> <span class="co"># make Fortran code write output as csv files</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>runshade <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="co"># run the model twice, once for each shade level (1) or just for the first shade level (0)?</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>runmoist <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="co"># run soil moisture model (0 = no, 1 = yes)?</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>snowmodel <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="co"># run the snow model (0 = no, 1 = yes)? - note that this runs slower</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>hourly <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="co"># run the model with hourly input data</span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>rainhourly <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="co"># run the model with hourly rainfall input data (irrelevant if hourly = 1)</span></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>microdaily <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="co"># run microclimate model where one iteration of each day occurs and last day gives initial conditions for present day</span></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>IR <span class="ot">&lt;-</span> <span class="dv">0</span> <span class="co"># compute clear-sky longwave radiation using Campbell and Norman (1998) eq. 10.10 (includes humidity)</span></span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>solonly <span class="ot">&lt;-</span> <span class="dv">0</span> <span class="co"># Only run SOLRAD to get solar radiation? 1=yes, 0=no</span></span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>message <span class="ot">&lt;-</span> <span class="dv">0</span> <span class="co"># do not allow the Fortran integrator to output warnings</span></span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>fail <span class="ot">&lt;-</span> <span class="dv">24</span><span class="sc">*</span><span class="dv">365</span> <span class="co"># how many restarts of the integrator before the Fortran program quits (avoids endless loops when solutions can&#39;t be found)</span></span></code></pre></div>
</div>
<div id="setting-the-times-and-location-info" class="section level3">
<h3>Setting the times and location info</h3>
<p>These parameters relate to the geographic location and the time period over which the model will run</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>longlat <span class="ot">&lt;-</span> <span class="fu">c</span>(Longitude, Latitude) <span class="co"># decimal degrees longitude and latitude from the SCAN site data table</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>doynum <span class="ot">&lt;-</span> <span class="fu">floor</span>(<span class="fu">nrow</span>(weather) <span class="sc">/</span> <span class="dv">24</span>) <span class="co"># number of days to run, determined by counting the number of rows in the weather dataset and dividing by 24 to get days, but keeping it as a whole number</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>idayst <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="co"># start day</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>ida <span class="ot">&lt;-</span> doynum <span class="co"># end day</span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>HEMIS <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(longlat[<span class="dv">2</span>] <span class="sc">&lt;</span> <span class="dv">0</span>, <span class="dv">2</span>, <span class="dv">1</span>) <span class="co"># chose hemisphere based on latitude</span></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>ALAT <span class="ot">&lt;-</span> <span class="fu">abs</span>(<span class="fu">trunc</span>(longlat[<span class="dv">2</span>])) <span class="co"># degrees latitude</span></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>AMINUT <span class="ot">&lt;-</span> (<span class="fu">abs</span>(longlat[<span class="dv">2</span>]) <span class="sc">-</span> ALAT) <span class="sc">*</span> <span class="dv">60</span> <span class="co"># minutes latitude</span></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>ALONG <span class="ot">&lt;-</span> <span class="fu">abs</span>(<span class="fu">trunc</span>(longlat[<span class="dv">1</span>])) <span class="co"># degrees longitude</span></span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>ALMINT <span class="ot">&lt;-</span> (<span class="fu">abs</span>(longlat[<span class="dv">1</span>]) <span class="sc">-</span> ALONG) <span class="sc">*</span> <span class="dv">60</span> <span class="co"># minutes latitude</span></span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>ALREF <span class="ot">&lt;-</span> ALONG <span class="co"># reference longitude for time zone</span></span></code></pre></div>
</div>
<div id="time-independent-microclimate-model-parameters" class="section level3">
<h3>Time-independent microclimate model parameters</h3>
<p>Now we set the non-temporal parameters including the depths we want to simulate (these have been matched in part to the depths at which the SCAN data are reported), terrain properties, and using the Global Aerosol Data Set (GADS) to get aerosol an aerosol attenuation profile. Note that the <code>TIMAXS</code> and <code>TIMINS</code> vectors which control how min/max weather data are interpolated to hourly profiles are specified but they will be redundnat because the <code>hourly</code> option was set to 1 above.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>EC <span class="ot">&lt;-</span> <span class="fl">0.0167238</span> <span class="co"># Eccenricity of the earth&#39;s orbit (current value 0.0167238, ranges between 0.0034 to 0.058)</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>RUF <span class="ot">&lt;-</span> <span class="fl">0.004</span> <span class="co"># Roughness height (m), , e.g. sand is 0.0005, grass may be 0.02, current allowed range: 0.00001 (snow) - 0.02 cm.</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>ZH <span class="ot">&lt;-</span> <span class="dv">0</span> <span class="co"># heat transfer roughness height (m) for Campbell and Norman air temperature/wind speed profile (invoked if greater than 1, 0.02 * canopy height in m if unknown)</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>D0 <span class="ot">&lt;-</span> <span class="dv">0</span> <span class="co"># zero plane displacement correction factor (m) for Campbell and Norman air temperature/wind speed profile (0.6 * canopy height in m if unknown)</span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Next four parameters are segmented velocity profiles due to bushes, rocks etc. on the surface</span></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a><span class="co">#IF NO EXPERIMENTAL WIND PROFILE DATA SET ALL THESE TO ZERO! (then roughness height is based on the parameter RUF)</span></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>Z01 <span class="ot">&lt;-</span> <span class="dv">0</span> <span class="co"># Top (1st) segment roughness height(m)</span></span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>Z02 <span class="ot">&lt;-</span> <span class="dv">0</span> <span class="co"># 2nd segment roughness height(m)</span></span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>ZH1 <span class="ot">&lt;-</span> <span class="dv">0</span> <span class="co"># Top of (1st) segment, height above surface(m)</span></span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>ZH2 <span class="ot">&lt;-</span> <span class="dv">0</span> <span class="co"># 2nd segment, height above surface(m)</span></span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>SLE <span class="ot">&lt;-</span> <span class="fl">0.96</span> <span class="co"># Substrate longwave IR emissivity (decimal %), typically close to 1</span></span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a>ERR <span class="ot">&lt;-</span> <span class="fl">1.5</span> <span class="co"># Integrator error for soil temperature calculations</span></span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a>Refhyt <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="co"># Reference height (m), reference height at which air temperature, wind speed and relative humidity input data are measured</span></span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a>DEP <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">2.5</span>, <span class="dv">5</span>, <span class="dv">10</span>, <span class="dv">15</span>, <span class="dv">20</span>, <span class="dv">30</span>, <span class="dv">50</span>, <span class="dv">100</span>, <span class="dv">200</span>) <span class="co"># Soil nodes (cm) - keep spacing close near the surface, last value is where it is assumed that the soil temperature is at the annual mean air temperature</span></span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a>Thcond <span class="ot">&lt;-</span> <span class="fl">2.5</span> <span class="co"># soil minerals thermal conductivity (W/mC)</span></span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a>Density <span class="ot">&lt;-</span> <span class="fl">2.56</span> <span class="co"># soil minerals density (Mg/m3)</span></span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true" tabindex="-1"></a>SpecHeat <span class="ot">&lt;-</span> <span class="dv">870</span> <span class="co"># soil minerals specific heat (J/kg-K)</span></span>
<span id="cb9-18"><a href="#cb9-18" aria-hidden="true" tabindex="-1"></a>BulkDensity <span class="ot">&lt;-</span> <span class="fl">1.3</span> <span class="co"># soil bulk density (Mg/m3)</span></span>
<span id="cb9-19"><a href="#cb9-19" aria-hidden="true" tabindex="-1"></a>SatWater <span class="ot">&lt;-</span> <span class="fl">0.26</span> <span class="co"># volumetric water content at saturation (0.1 bar matric potential) (m3/m3)</span></span>
<span id="cb9-20"><a href="#cb9-20" aria-hidden="true" tabindex="-1"></a>REFL <span class="ot">&lt;-</span> <span class="fl">0.20</span> <span class="co"># soil reflectance (decimal %)</span></span>
<span id="cb9-21"><a href="#cb9-21" aria-hidden="true" tabindex="-1"></a>ALTT <span class="ot">&lt;-</span> Elevation <span class="co"># altitude (m)</span></span>
<span id="cb9-22"><a href="#cb9-22" aria-hidden="true" tabindex="-1"></a>slope <span class="ot">&lt;-</span> <span class="dv">0</span> <span class="co"># slope (degrees, range 0-90)</span></span>
<span id="cb9-23"><a href="#cb9-23" aria-hidden="true" tabindex="-1"></a>azmuth <span class="ot">&lt;-</span> <span class="dv">180</span> <span class="co"># aspect (degrees, 0 = North, range 0-360)</span></span>
<span id="cb9-24"><a href="#cb9-24" aria-hidden="true" tabindex="-1"></a>hori <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>, <span class="dv">24</span>) <span class="co"># enter the horizon angles (degrees) so that they go from 0 degrees azimuth (north) clockwise in 15 degree intervals</span></span>
<span id="cb9-25"><a href="#cb9-25" aria-hidden="true" tabindex="-1"></a>VIEWF <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">sum</span>(<span class="fu">sin</span>(hori <span class="sc">*</span> pi <span class="sc">/</span> <span class="dv">180</span>)) <span class="sc">/</span> <span class="fu">length</span>(hori) <span class="co"># convert horizon angles to radians and calc view factor(s)</span></span>
<span id="cb9-26"><a href="#cb9-26" aria-hidden="true" tabindex="-1"></a>lamb <span class="ot">&lt;-</span> <span class="dv">0</span> <span class="co"># Return wavelength-specific solar radiation output?</span></span>
<span id="cb9-27"><a href="#cb9-27" aria-hidden="true" tabindex="-1"></a>IUV <span class="ot">&lt;-</span> <span class="dv">0</span> <span class="co"># Use gamma function for scattered solar radiation? (computationally intensive)</span></span>
<span id="cb9-28"><a href="#cb9-28" aria-hidden="true" tabindex="-1"></a>PCTWET <span class="ot">&lt;-</span> <span class="dv">0</span> <span class="co"># percentage of surface area acting as a free water surface (%)</span></span>
<span id="cb9-29"><a href="#cb9-29" aria-hidden="true" tabindex="-1"></a>CMH2O <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="co"># precipitable cm H2O in air column, 0.1 = VERY DRY; 1.0 = MOIST AIR CONDITIONS; 2.0 = HUMID, TROPICAL CONDITIONS (note this is for the whole atmospheric profile, not just near the ground)</span></span>
<span id="cb9-30"><a href="#cb9-30" aria-hidden="true" tabindex="-1"></a>TIMAXS <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>)   <span class="co"># Time of Maximums for Air Wind RelHum Cloud (h), air &amp; Wind max&#39;s relative to solar noon, humidity and cloud cover max&#39;s relative to sunrise</span></span>
<span id="cb9-31"><a href="#cb9-31" aria-hidden="true" tabindex="-1"></a>TIMINS <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>)   <span class="co"># Time of Minimums for Air Wind RelHum Cloud (h), air &amp; Wind min&#39;s relative to sunrise, humidity and cloud cover min&#39;s relative to solar noon</span></span>
<span id="cb9-32"><a href="#cb9-32" aria-hidden="true" tabindex="-1"></a>minshade <span class="ot">&lt;-</span> <span class="dv">0</span> <span class="co"># minimum available shade (%)</span></span>
<span id="cb9-33"><a href="#cb9-33" aria-hidden="true" tabindex="-1"></a>maxshade <span class="ot">&lt;-</span> <span class="dv">90</span> <span class="co"># maximum available shade (%)</span></span>
<span id="cb9-34"><a href="#cb9-34" aria-hidden="true" tabindex="-1"></a>Usrhyt <span class="ot">&lt;-</span> <span class="fl">0.01</span><span class="co"># local height (m) at which air temperature, relative humidity and wind speed calculatinos will be made</span></span>
<span id="cb9-35"><a href="#cb9-35" aria-hidden="true" tabindex="-1"></a><span class="co"># Aerosol profile using GADS</span></span>
<span id="cb9-36"><a href="#cb9-36" aria-hidden="true" tabindex="-1"></a>relhum <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb9-37"><a href="#cb9-37" aria-hidden="true" tabindex="-1"></a>optdep.summer <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">rungads</span>(longlat[<span class="dv">2</span>],longlat[<span class="dv">1</span>],relhum, <span class="dv">0</span>))</span>
<span id="cb9-38"><a href="#cb9-38" aria-hidden="true" tabindex="-1"></a>optdep.winter <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">rungads</span>(longlat[<span class="dv">2</span>],longlat[<span class="dv">1</span>],relhum, <span class="dv">1</span>))</span>
<span id="cb9-39"><a href="#cb9-39" aria-hidden="true" tabindex="-1"></a>optdep <span class="ot">&lt;-</span> <span class="fu">cbind</span>(optdep.winter[,<span class="dv">1</span>],<span class="fu">rowMeans</span>(<span class="fu">cbind</span>(optdep.summer[,<span class="dv">2</span>],optdep.winter[,<span class="dv">2</span>])))</span>
<span id="cb9-40"><a href="#cb9-40" aria-hidden="true" tabindex="-1"></a>optdep <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(optdep)</span>
<span id="cb9-41"><a href="#cb9-41" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(optdep)<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="st">&quot;LAMBDA&quot;</span>,<span class="st">&quot;OPTDEPTH&quot;</span>)</span>
<span id="cb9-42"><a href="#cb9-42" aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="fu">lm</span>(OPTDEPTH<span class="sc">~</span><span class="fu">poly</span>(LAMBDA, <span class="dv">6</span>, <span class="at">raw =</span> <span class="cn">TRUE</span>),<span class="at">data =</span> optdep)</span>
<span id="cb9-43"><a href="#cb9-43" aria-hidden="true" tabindex="-1"></a>LAMBDA <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">290</span>, <span class="dv">295</span>, <span class="dv">300</span>, <span class="dv">305</span>, <span class="dv">310</span>, <span class="dv">315</span>, <span class="dv">320</span>, <span class="dv">330</span>, <span class="dv">340</span>, <span class="dv">350</span>, <span class="dv">360</span>, <span class="dv">370</span>, <span class="dv">380</span>, <span class="dv">390</span>, <span class="dv">400</span>, <span class="dv">420</span>, <span class="dv">440</span>, <span class="dv">460</span>, <span class="dv">480</span>, <span class="dv">500</span>, <span class="dv">520</span>, <span class="dv">540</span>, <span class="dv">560</span>, <span class="dv">580</span>, <span class="dv">600</span>, <span class="dv">620</span>, <span class="dv">640</span>, <span class="dv">660</span>, <span class="dv">680</span>, <span class="dv">700</span>, <span class="dv">720</span>, <span class="dv">740</span>, <span class="dv">760</span>, <span class="dv">780</span>, <span class="dv">800</span>, <span class="dv">820</span>, <span class="dv">840</span>, <span class="dv">860</span>, <span class="dv">880</span>, <span class="dv">900</span>, <span class="dv">920</span>, <span class="dv">940</span>, <span class="dv">960</span>, <span class="dv">980</span>, <span class="dv">1000</span>, <span class="dv">1020</span>, <span class="dv">1080</span>, <span class="dv">1100</span>, <span class="dv">1120</span>, <span class="dv">1140</span>, <span class="dv">1160</span>, <span class="dv">1180</span>, <span class="dv">1200</span>, <span class="dv">1220</span>, <span class="dv">1240</span>, <span class="dv">1260</span>, <span class="dv">1280</span>, <span class="dv">1300</span>, <span class="dv">1320</span>, <span class="dv">1380</span>, <span class="dv">1400</span>, <span class="dv">1420</span>, <span class="dv">1440</span>, <span class="dv">1460</span>, <span class="dv">1480</span>, <span class="dv">1500</span>, <span class="dv">1540</span>, <span class="dv">1580</span>, <span class="dv">1600</span>, <span class="dv">1620</span>, <span class="dv">1640</span>, <span class="dv">1660</span>, <span class="dv">1700</span>, <span class="dv">1720</span>, <span class="dv">1780</span>, <span class="dv">1800</span>, <span class="dv">1860</span>, <span class="dv">1900</span>, <span class="dv">1950</span>, <span class="dv">2000</span>, <span class="dv">2020</span>, <span class="dv">2050</span>, <span class="dv">2100</span>, <span class="dv">2120</span>, <span class="dv">2150</span>, <span class="dv">2200</span>, <span class="dv">2260</span>, <span class="dv">2300</span>, <span class="dv">2320</span>, <span class="dv">2350</span>, <span class="dv">2380</span>, <span class="dv">2400</span>, <span class="dv">2420</span>, <span class="dv">2450</span>, <span class="dv">2490</span>, <span class="dv">2500</span>, <span class="dv">2600</span>, <span class="dv">2700</span>, <span class="dv">2800</span>, <span class="dv">2900</span>, <span class="dv">3000</span>, <span class="dv">3100</span>, <span class="dv">3200</span>, <span class="dv">3300</span>, <span class="dv">3400</span>, <span class="dv">3500</span>, <span class="dv">3600</span>, <span class="dv">3700</span>, <span class="dv">3800</span>, <span class="dv">3900</span>, <span class="dv">4000</span>)</span>
<span id="cb9-44"><a href="#cb9-44" aria-hidden="true" tabindex="-1"></a>TAI <span class="ot">&lt;-</span> <span class="fu">predict</span>(a, <span class="fu">data.frame</span>(LAMBDA))</span></code></pre></div>
</div>
<div id="time-dependent-microclimate-model-variables" class="section level3">
<h3>Time-dependent microclimate model variables</h3>
<p>Now we need to specify hourly air temperature, wind speed, relative humidity, solar radiation, precipitation and cloud cover. The first 5 come directly from the SCAN dataset, but this dataset doesn’t include cloud cover so we will have to estimate it as described below. Also, it is possible to supply precomputed zenith angles for when your simulation doesn’t start at midnight. But, if you don’t need to supply them, you give the model a vector of negative values.</p>
<p>To start with, we need to use the <code>na.approx</code> function from the <code>zoo</code> package to interpolate NA values.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># check if first element is NA and, if so, use next non-NA value for na.approx function</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(<span class="fu">is.na</span>(weather<span class="sc">$</span>TAVG.H[<span class="dv">1</span>])<span class="sc">==</span><span class="cn">TRUE</span>){ <span class="co"># mean hourly air temperature</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>  weather<span class="sc">$</span>TAVG.H[<span class="dv">1</span>]<span class="ot">&lt;-</span>weather<span class="sc">$</span>TAVG.H[<span class="fu">which</span>(<span class="sc">!</span><span class="fu">is.na</span>(weather<span class="sc">$</span>TAVG.H))[<span class="dv">1</span>]]</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(<span class="fu">is.na</span>(weather<span class="sc">$</span>WSPDV.H[<span class="dv">1</span>])<span class="sc">==</span><span class="cn">TRUE</span>){ <span class="co"># mean hourly wind speed</span></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>  weather<span class="sc">$</span>WSPDV.H[<span class="dv">1</span>]<span class="ot">&lt;-</span>weather<span class="sc">$</span>WSPDV.H[<span class="fu">which</span>(<span class="sc">!</span><span class="fu">is.na</span>(weather<span class="sc">$</span>WSPDV.H))[<span class="dv">1</span>]]</span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(<span class="fu">is.na</span>(weather<span class="sc">$</span>RHUM[<span class="dv">1</span>])<span class="sc">==</span><span class="cn">TRUE</span>){ <span class="co"># mean hourly relative humidity</span></span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>  weather<span class="sc">$</span>RHUM[<span class="dv">1</span>]<span class="ot">&lt;-</span>weather<span class="sc">$</span>RHUM[<span class="fu">which</span>(<span class="sc">!</span><span class="fu">is.na</span>(weather<span class="sc">$</span>RHUM))[<span class="dv">1</span>]]</span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(<span class="fu">is.na</span>(weather<span class="sc">$</span>SRADV.H[<span class="dv">1</span>])<span class="sc">==</span><span class="cn">TRUE</span>){ <span class="co"># mean hourly solar radiation</span></span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a>  weather<span class="sc">$</span>SRADV.H[<span class="dv">1</span>]<span class="ot">&lt;-</span>weather<span class="sc">$</span>SRADV.H[<span class="fu">which</span>(<span class="sc">!</span><span class="fu">is.na</span>(weather<span class="sc">$</span>SRADV.H))[<span class="dv">1</span>]]</span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(<span class="fu">is.na</span>(weather<span class="sc">$</span>PRCP.H[<span class="dv">1</span>])<span class="sc">==</span><span class="cn">TRUE</span>){ <span class="co"># hourly precipitation</span></span>
<span id="cb10-16"><a href="#cb10-16" aria-hidden="true" tabindex="-1"></a>  weather<span class="sc">$</span>PRCP.H[<span class="dv">1</span>]<span class="ot">&lt;-</span>weather<span class="sc">$</span>PRCP.H[<span class="fu">which</span>(<span class="sc">!</span><span class="fu">is.na</span>(weather<span class="sc">$</span>PRCP.H))[<span class="dv">1</span>]]</span>
<span id="cb10-17"><a href="#cb10-17" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb10-18"><a href="#cb10-18" aria-hidden="true" tabindex="-1"></a><span class="co"># use na.approx function from zoo package to fill in missing data</span></span>
<span id="cb10-19"><a href="#cb10-19" aria-hidden="true" tabindex="-1"></a>TAIRhr <span class="ot">&lt;-</span> weather<span class="sc">$</span>TAVG.H <span class="ot">&lt;-</span> <span class="fu">na.approx</span>(weather<span class="sc">$</span>TAVG.H)</span>
<span id="cb10-20"><a href="#cb10-20" aria-hidden="true" tabindex="-1"></a>RHhr <span class="ot">&lt;-</span> weather<span class="sc">$</span>RHUM.I <span class="ot">&lt;-</span> <span class="fu">na.approx</span>(weather<span class="sc">$</span>RHUM.I)</span>
<span id="cb10-21"><a href="#cb10-21" aria-hidden="true" tabindex="-1"></a>SOLRhr <span class="ot">&lt;-</span> weather<span class="sc">$</span>SRADV.H <span class="ot">&lt;-</span> <span class="fu">na.approx</span>(weather<span class="sc">$</span>SRADV.H)</span>
<span id="cb10-22"><a href="#cb10-22" aria-hidden="true" tabindex="-1"></a>RAINhr <span class="ot">&lt;-</span> weather<span class="sc">$</span>PRCP.H <span class="ot">&lt;-</span> <span class="fu">na.approx</span>(weather<span class="sc">$</span>PRCP.H <span class="sc">*</span> <span class="fl">25.4</span>) <span class="co"># convert rainfall from inches to mm</span></span>
<span id="cb10-23"><a href="#cb10-23" aria-hidden="true" tabindex="-1"></a>WNhr <span class="ot">&lt;-</span> weather<span class="sc">$</span>WSPDV.H <span class="ot">&lt;-</span> <span class="fu">na.approx</span>(weather<span class="sc">$</span>WSPDV.H <span class="sc">*</span> <span class="fl">0.44704</span>) <span class="co"># convert wind speed from miles/hour to m/s</span></span>
<span id="cb10-24"><a href="#cb10-24" aria-hidden="true" tabindex="-1"></a>ZENhr <span class="ot">&lt;-</span> TAIRhr <span class="sc">*</span> <span class="dv">0</span> <span class="sc">-</span> <span class="dv">1</span> <span class="co"># negative zenith angles to force model to compute them</span></span>
<span id="cb10-25"><a href="#cb10-25" aria-hidden="true" tabindex="-1"></a>IRDhr <span class="ot">&lt;-</span> TAIRhr <span class="sc">*</span> <span class="dv">0</span> <span class="sc">-</span> <span class="dv">1</span> <span class="co"># negative infrared values to force model to compute them</span></span></code></pre></div>
<p>Now we run the microclimate model using the <code>micro_global</code> function with the option <code>clearsky</code> set to 1 to obtain 365 days of clear sky solar radiation which we can then use in comparison to the observed solar radiation to infer cloud cover.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># run global microclimate model in clear sky mode to get clear sky radiation</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>micro <span class="ot">&lt;-</span> <span class="fu">micro_global</span>(<span class="at">loc =</span> <span class="fu">c</span>(Longitude, Latitude), <span class="at">timeinterval =</span> <span class="dv">365</span>, <span class="at">clearsky =</span> <span class="dv">1</span>)</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a><span class="co"># append dates</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>metout <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(micro<span class="sc">$</span>metout)</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>tzone <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">&quot;Etc/GMT&quot;</span>, TZoffset)</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>dates <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fu">ISOdate</span>(ystart, <span class="dv">1</span>, <span class="dv">1</span>, <span class="at">tz =</span> tzone)<span class="sc">-</span><span class="dv">3600</span> <span class="sc">*</span> <span class="dv">12</span>, <span class="fu">ISOdate</span>((ystart<span class="sc">+</span>nyears),<span class="dv">1</span>, <span class="dv">1</span>, <span class="at">tz =</span> tzone)<span class="sc">-</span><span class="dv">3600</span> <span class="sc">*</span> <span class="dv">13</span>, <span class="at">by=</span><span class="st">&quot;hours&quot;</span>)</span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>clear <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">cbind</span>(dates, <span class="fu">as.data.frame</span>(<span class="fu">rep</span>(micro<span class="sc">$</span>metout[<span class="dv">1</span><span class="sc">:</span>(<span class="dv">365</span> <span class="sc">*</span> <span class="dv">24</span>),<span class="dv">13</span>],nyears))),<span class="at">stringsAsFactors =</span> <span class="cn">FALSE</span>)</span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>doy <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="fu">seq</span>(<span class="dv">1</span>, <span class="dv">365</span>),nyears)[<span class="dv">1</span><span class="sc">:</span><span class="fu">floor</span>(<span class="fu">nrow</span>(weather)<span class="sc">/</span><span class="dv">24</span>)] <span class="co"># days of year to run</span></span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>clear <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(clear, <span class="at">stringsAsFactors =</span> <span class="cn">FALSE</span>)</span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(clear)<span class="ot">=</span><span class="fu">c</span>(<span class="st">&quot;datetime&quot;</span>, <span class="st">&quot;sol&quot;</span>)</span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a><span class="co"># find the maximum observed solar and adjust the clear sky prediction to this value </span></span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a>maxsol <span class="ot">&lt;-</span> <span class="fu">max</span>(SOLRhr)</span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a>clear2 <span class="ot">&lt;-</span> clear[, <span class="dv">2</span>]<span class="sc">*</span>(maxsol <span class="sc">/</span> <span class="fu">max</span>(clear[, <span class="dv">2</span>])) <span class="co"># get ratio of max observed to predicted max clear sky solar</span></span>
<span id="cb11-15"><a href="#cb11-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-16"><a href="#cb11-16" aria-hidden="true" tabindex="-1"></a><span class="co"># compute cloud cover from ratio of max to observed solar</span></span>
<span id="cb11-17"><a href="#cb11-17" aria-hidden="true" tabindex="-1"></a>sol <span class="ot">&lt;-</span> SOLRhr</span>
<span id="cb11-18"><a href="#cb11-18" aria-hidden="true" tabindex="-1"></a>clr <span class="ot">&lt;-</span> clear2</span>
<span id="cb11-19"><a href="#cb11-19" aria-hidden="true" tabindex="-1"></a>zenthresh <span class="ot">&lt;-</span> <span class="dv">85</span></span>
<span id="cb11-20"><a href="#cb11-20" aria-hidden="true" tabindex="-1"></a>sol[metout<span class="sc">$</span>ZEN <span class="sc">&gt;</span> zenthresh] <span class="ot">&lt;-</span> <span class="cn">NA</span> <span class="co"># remove values for nighttime (and very early morning/late afternoon)</span></span>
<span id="cb11-21"><a href="#cb11-21" aria-hidden="true" tabindex="-1"></a>clr[metout<span class="sc">$</span>ZEN <span class="sc">&gt;</span> zenthresh] <span class="ot">&lt;-</span> <span class="cn">NA</span> <span class="co"># remove values for nighttime (and very early morning/late afternoon)</span></span>
<span id="cb11-22"><a href="#cb11-22" aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span> ((clr <span class="sc">-</span> sol) <span class="sc">/</span> clr) <span class="sc">*</span> <span class="dv">100</span> <span class="co"># get ratio of observed to predicted solar, convert to %</span></span>
<span id="cb11-23"><a href="#cb11-23" aria-hidden="true" tabindex="-1"></a>a[a <span class="sc">&gt;</span> <span class="dv">100</span>] <span class="ot">&lt;-</span> <span class="dv">100</span> <span class="co"># cap max 100%</span></span>
<span id="cb11-24"><a href="#cb11-24" aria-hidden="true" tabindex="-1"></a>a[a <span class="sc">&lt;</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="dv">0</span> <span class="co"># cap min at 0%</span></span>
<span id="cb11-25"><a href="#cb11-25" aria-hidden="true" tabindex="-1"></a>a[<span class="fu">is.na</span>(a)] <span class="ot">&lt;-</span> <span class="dv">0</span> <span class="co"># replace NA with zero</span></span>
<span id="cb11-26"><a href="#cb11-26" aria-hidden="true" tabindex="-1"></a>a[<span class="fu">is.infinite</span>(a)]<span class="ot">=</span><span class="dv">0</span> <span class="co"># replace infinity with zero</span></span>
<span id="cb11-27"><a href="#cb11-27" aria-hidden="true" tabindex="-1"></a>a[a <span class="sc">==</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="cn">NA</span> <span class="co"># change all zeros to NA for na.approx</span></span>
<span id="cb11-28"><a href="#cb11-28" aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="fu">na.approx</span>(a, <span class="at">na.rm =</span> <span class="cn">FALSE</span>) <span class="co"># apply na.approx, but leave any trailing NAs</span></span>
<span id="cb11-29"><a href="#cb11-29" aria-hidden="true" tabindex="-1"></a>a[<span class="fu">is.na</span>(a)] <span class="ot">&lt;-</span> <span class="dv">0</span> <span class="co"># make trailing NAs zero</span></span>
<span id="cb11-30"><a href="#cb11-30" aria-hidden="true" tabindex="-1"></a>CLDhr <span class="ot">&lt;-</span> a <span class="co"># now we have hourly cloud cover </span></span></code></pre></div>
<p>We still need to give the model vectors of daily minimum and maximum weather data, even though they are not used when <code>hourly</code> is set to 1, so the next code chunk summarises the minima and maxima from the hourly data. If you set <code>hourly</code> to zero, you can see the difference having hourly data makes to the fit of the model to the observed SCAN data on soil temperature and soil moisture.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># aggregate hourly data to daily min / max</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>CCMAXX <span class="ot">&lt;-</span> <span class="fu">aggregate</span>(CLDhr, <span class="at">by =</span> <span class="fu">list</span>(weather<span class="sc">$</span>Date), <span class="at">FUN =</span> max)[,<span class="dv">2</span>]<span class="co">#c(100, 100) # max cloud cover (%)</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>CCMINN <span class="ot">&lt;-</span> <span class="fu">aggregate</span>(CLDhr, <span class="at">by =</span> <span class="fu">list</span>(weather<span class="sc">$</span>Date), <span class="at">FUN =</span> min)[,<span class="dv">2</span>]<span class="co">#c(0, 15.62) # min cloud cover (%)</span></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>TMAXX <span class="ot">&lt;-</span> <span class="fu">aggregate</span>(TAIRhr, <span class="at">by =</span> <span class="fu">list</span>(weather<span class="sc">$</span>Date), <span class="at">FUN =</span> max)[,<span class="dv">2</span>]<span class="co">#c(40.1, 31.6) # maximum air temperatures (°C)</span></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>TMINN <span class="ot">&lt;-</span> <span class="fu">aggregate</span>(TAIRhr, <span class="at">by =</span> <span class="fu">list</span>(weather<span class="sc">$</span>Date), <span class="at">FUN =</span> min)[,<span class="dv">2</span>]<span class="co">#c(19.01, 19.57) # minimum air temperatures (°C)</span></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>RAINFALL <span class="ot">&lt;-</span> <span class="fu">aggregate</span>(RAINhr, <span class="at">by =</span> <span class="fu">list</span>(weather<span class="sc">$</span>Date), <span class="at">FUN =</span> sum)[,<span class="dv">2</span>]<span class="co">#c(19.01, 19.57) # minimum air temperatures (°C)</span></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>RHMAXX <span class="ot">&lt;-</span> <span class="fu">aggregate</span>(RHhr, <span class="at">by =</span> <span class="fu">list</span>(weather<span class="sc">$</span>Date), <span class="at">FUN =</span> max)[,<span class="dv">2</span>]<span class="co">#c(90.16, 80.92) # max relative humidity (%)</span></span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>RHMINN <span class="ot">&lt;-</span> <span class="fu">aggregate</span>(RHhr, <span class="at">by =</span> <span class="fu">list</span>(weather<span class="sc">$</span>Date), <span class="at">FUN =</span> min)[,<span class="dv">2</span>]<span class="co">#c(11.05, 27.9) # min relative humidity (%)</span></span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>WNMAXX <span class="ot">&lt;-</span> <span class="fu">aggregate</span>(WNhr, <span class="at">by =</span> <span class="fu">list</span>(weather<span class="sc">$</span>Date), <span class="at">FUN =</span> max)[,<span class="dv">2</span>]<span class="co">#c(1.35, 2.0) # max wind speed (m/s)</span></span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>WNMINN <span class="ot">&lt;-</span> <span class="fu">aggregate</span>(WNhr, <span class="at">by =</span> <span class="fu">list</span>(weather<span class="sc">$</span>Date), <span class="at">FUN =</span> min)[,<span class="dv">2</span>]<span class="co">#c(0.485, 0.610) # min wind speed (m/s)</span></span></code></pre></div>
<p>Finally, we need the annual mean temperature and the running mean annual temperature for use as a boundary deep soil condition, as well as daily values of maximum and minimum shade, substrate emissivity and solar reflectance, and surface wetness, which we will keep constant across all days in this simulation. Also, for the deep soil boundary condtion, we only have one year of data so we cannot compute a running 365 day mean of the air temperature and instead we simply use a constant mean annual temperature.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>tannul <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">c</span>(TMAXX, TMINN)) <span class="co"># annual mean temperature for getting monthly deep soil temperature (°C)</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>tannulrun <span class="ot">&lt;-</span> <span class="fu">rep</span>(tannul, doynum) <span class="co"># monthly deep soil temperature (2m) (°C)</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a><span class="co"># creating the arrays of environmental variables that are assumed not to change with month for this simulation</span></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>MAXSHADES <span class="ot">&lt;-</span> <span class="fu">rep</span>(maxshade, doynum) <span class="co"># daily max shade (%)</span></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>MINSHADES <span class="ot">&lt;-</span> <span class="fu">rep</span>(minshade, doynum) <span class="co"># daily min shade (%)</span></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>SLES <span class="ot">&lt;-</span> <span class="fu">rep</span>(SLE, doynum) <span class="co"># set up vector of ground emissivities for each day</span></span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>REFLS <span class="ot">&lt;-</span> <span class="fu">rep</span>(REFL, doynum) <span class="co"># set up vector of soil reflectances for each day</span></span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>PCTWET <span class="ot">&lt;-</span> <span class="fu">rep</span>(PCTWET, doynum) <span class="co"># set up vector of soil wetness for each day</span></span></code></pre></div>
</div>
<div id="soil-thermal-properties" class="section level3">
<h3>Soil thermal properties</h3>
<p>Next we need to specify the soil properties. This code sets up for one soil type in terms of thermal properties, but below we will make the soil moisture-related properties transition at a certain depth.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co"># set up a profile of soil properites with depth for each day to be run</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>Numtyps <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="co"># number of soil types</span></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>Nodes <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="at">data =</span> <span class="dv">0</span>, <span class="at">nrow =</span> <span class="dv">10</span>, <span class="at">ncol =</span> doynum) <span class="co"># array of all possible soil nodes for max time span of 20 years</span></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>Nodes[<span class="dv">1</span>, <span class="dv">1</span><span class="sc">:</span>doynum]<span class="ot">&lt;-</span><span class="dv">10</span> <span class="co"># deepest node for first substrate type</span></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a><span class="co"># now make the soil properties matrix</span></span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a><span class="co"># columns are:</span></span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a><span class="co">#1) bulk density (Mg/m3)</span></span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a><span class="co">#2) volumetric water content at saturation (0.1 bar matric potential) (m3/m3)</span></span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a><span class="co">#3) thermal conductivity (W/mK)</span></span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a><span class="co">#4) specific heat capacity (J/kg-K)</span></span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a><span class="co">#5) mineral density (Mg/m3)</span></span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a>soilprops <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="at">data =</span> <span class="dv">0</span>, <span class="at">nrow =</span> <span class="dv">10</span>, <span class="at">ncol =</span> <span class="dv">5</span>) <span class="co"># create an empty soil properties matrix</span></span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true" tabindex="-1"></a>soilprops[<span class="dv">1</span>, <span class="dv">1</span>]<span class="ot">&lt;-</span>BulkDensity <span class="co"># insert soil bulk density to profile 1</span></span>
<span id="cb14-15"><a href="#cb14-15" aria-hidden="true" tabindex="-1"></a>soilprops[<span class="dv">1</span>, <span class="dv">2</span>]<span class="ot">&lt;-</span>SatWater <span class="co"># insert saturated water content to profile 1</span></span>
<span id="cb14-16"><a href="#cb14-16" aria-hidden="true" tabindex="-1"></a>soilprops[<span class="dv">1</span>, <span class="dv">3</span>]<span class="ot">&lt;-</span>Thcond <span class="co"># insert thermal conductivity to profile 1</span></span>
<span id="cb14-17"><a href="#cb14-17" aria-hidden="true" tabindex="-1"></a>soilprops[<span class="dv">1</span>, <span class="dv">4</span>]<span class="ot">&lt;-</span>SpecHeat <span class="co"># insert specific heat to profile 1</span></span>
<span id="cb14-18"><a href="#cb14-18" aria-hidden="true" tabindex="-1"></a>soilprops[<span class="dv">1</span>, <span class="dv">5</span>]<span class="ot">&lt;-</span>Density <span class="co"># insert mineral density to profile 1</span></span>
<span id="cb14-19"><a href="#cb14-19" aria-hidden="true" tabindex="-1"></a>soilinit <span class="ot">&lt;-</span> <span class="fu">rep</span>(tannul, <span class="dv">20</span>) <span class="co"># make iniital soil temps equal to mean annual</span></span></code></pre></div>
<p>###Soil moisture properties</p>
<p>Now we specify the soil moisture-related parameteres using Table 9.1 out of Campbell and Norman’s 1990 book ‘Environmental Biophysics’. Note that there are 19 total nodes because an extra node has been inserted between each of the 10 depths specified in the <code>DEP</code> array to improve the accuracy of the soil moisture calculations. First all 19 nodes are given the values for soil type 3, a sandy loam, and then the deeper nodes (greater than 15 cm) are overwritten with soil type 5 which is a silt loam. Also specified is the root density profile, the leaf area index (both default values based on Campbell’s 1985 book ‘Soil Physics with Basic’), and some other parameters that control how the rainfall is applied together with the initial soil moisture values.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co">#use Campbell and Norman Table 9.1 soil moisture properties</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>soiltype <span class="ot">&lt;-</span> <span class="dv">3</span> <span class="co"># 3 = sandy loam</span></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>PE <span class="ot">&lt;-</span> <span class="fu">rep</span>(CampNormTbl9_1[soiltype, <span class="dv">4</span>],<span class="dv">19</span>) <span class="co">#air entry potential J/kg</span></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>KS <span class="ot">&lt;-</span> <span class="fu">rep</span>(CampNormTbl9_1[soiltype, <span class="dv">6</span>],<span class="dv">19</span>) <span class="co">#saturated conductivity, kg s/m3</span></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>BB <span class="ot">&lt;-</span> <span class="fu">rep</span>(CampNormTbl9_1[soiltype, <span class="dv">5</span>],<span class="dv">19</span>) <span class="co">#soil &#39;b&#39; parameter</span></span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>BD <span class="ot">&lt;-</span> <span class="fu">rep</span>(BulkDensity, <span class="dv">19</span>) <span class="co"># soil bulk density, Mg/m3</span></span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>DD <span class="ot">&lt;-</span> <span class="fu">rep</span>(Density, <span class="dv">19</span>) <span class="co"># soil mineral density, Mg/m3</span></span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>soiltype <span class="ot">&lt;-</span> <span class="dv">5</span> <span class="co"># change deeper nodes to 5 = a silt loam</span></span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>PE[<span class="dv">10</span><span class="sc">:</span><span class="dv">19</span>]<span class="ot">&lt;-</span>CampNormTbl9_1[soiltype, <span class="dv">4</span>] <span class="co">#air entry potential J/kg</span></span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>KS[<span class="dv">10</span><span class="sc">:</span><span class="dv">19</span>]<span class="ot">&lt;-</span>CampNormTbl9_1[soiltype, <span class="dv">6</span>] <span class="co">#saturated conductivity, kg s/m3</span></span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a>BB[<span class="dv">10</span><span class="sc">:</span><span class="dv">19</span>]<span class="ot">&lt;-</span>CampNormTbl9_1[soiltype, <span class="dv">5</span>] <span class="co">#soil &#39;b&#39; parameter</span></span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a>L <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="fl">8.2</span>, <span class="fl">8.0</span>, <span class="fl">7.8</span>, <span class="fl">7.4</span>, <span class="fl">7.1</span>, <span class="fl">6.4</span>, <span class="fl">5.8</span>, <span class="fl">4.8</span>, <span class="fl">4.0</span>, <span class="fl">1.8</span>, <span class="fl">0.9</span>, <span class="fl">0.6</span>, <span class="fl">0.8</span>, <span class="fl">0.4</span> ,<span class="fl">0.4</span>, <span class="dv">0</span>, <span class="dv">0</span>) <span class="sc">*</span> <span class="dv">10000</span> <span class="co"># root density at each node, mm/m3 (from Campell 1985 Soil Physics with Basic, p. 131)</span></span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a>R1 <span class="ot">&lt;-</span> <span class="fl">0.001</span> <span class="co">#root radius, m}\cr\cr</span></span>
<span id="cb15-15"><a href="#cb15-15" aria-hidden="true" tabindex="-1"></a>RW <span class="ot">&lt;-</span> <span class="fl">2.5e+10</span> <span class="co">#resistance per unit length of root, m3 kg-1 s-1</span></span>
<span id="cb15-16"><a href="#cb15-16" aria-hidden="true" tabindex="-1"></a>RL <span class="ot">&lt;-</span> <span class="fl">2e+6</span> <span class="co">#resistance per unit length of leaf, m3 kg-1 s-1</span></span>
<span id="cb15-17"><a href="#cb15-17" aria-hidden="true" tabindex="-1"></a>PC <span class="ot">&lt;-</span> <span class="sc">-</span><span class="dv">1500</span> <span class="co">#critical leaf water potential for stomatal closure, J kg-1</span></span>
<span id="cb15-18"><a href="#cb15-18" aria-hidden="true" tabindex="-1"></a>SP <span class="ot">&lt;-</span> <span class="dv">10</span> <span class="co">#stability parameter for stomatal closure equation, -</span></span>
<span id="cb15-19"><a href="#cb15-19" aria-hidden="true" tabindex="-1"></a>IM <span class="ot">&lt;-</span> <span class="fl">1e-06</span> <span class="co">#maximum allowable mass balance error, kg</span></span>
<span id="cb15-20"><a href="#cb15-20" aria-hidden="true" tabindex="-1"></a>MAXCOUNT <span class="ot">&lt;-</span> <span class="dv">500</span> <span class="co">#maximum iterations for mass balance, -</span></span>
<span id="cb15-21"><a href="#cb15-21" aria-hidden="true" tabindex="-1"></a>LAI <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="fl">0.1</span>, doynum) <span class="co"># leaf area index, used to partition traspiration/evaporation from PET</span></span>
<span id="cb15-22"><a href="#cb15-22" aria-hidden="true" tabindex="-1"></a>rainmult <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="co"># rainfall multiplier to impose catchment</span></span>
<span id="cb15-23"><a href="#cb15-23" aria-hidden="true" tabindex="-1"></a>maxpool <span class="ot">&lt;-</span> <span class="dv">10</span> <span class="co"># max depth for water pooling on the surface, mm (to account for runoff)</span></span>
<span id="cb15-24"><a href="#cb15-24" aria-hidden="true" tabindex="-1"></a>evenrain <span class="ot">&lt;-</span> <span class="dv">0</span> <span class="co"># spread daily rainfall evenly across 24hrs (1) or one event at midnight (0)</span></span>
<span id="cb15-25"><a href="#cb15-25" aria-hidden="true" tabindex="-1"></a>SoilMoist_Init <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="fl">0.2</span>, <span class="dv">10</span>) <span class="co"># initial soil water content for each node, m3/m3</span></span>
<span id="cb15-26"><a href="#cb15-26" aria-hidden="true" tabindex="-1"></a>moists <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="at">nrow =</span> <span class="dv">10</span>, <span class="at">ncol =</span> doynum, <span class="at">data =</span> <span class="dv">0</span>) <span class="co"># set up an empty vector for soil moisture values through time</span></span>
<span id="cb15-27"><a href="#cb15-27" aria-hidden="true" tabindex="-1"></a>moists[<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>,]<span class="ot">&lt;-</span>SoilMoist_Init <span class="co"># insert inital soil moisture</span></span></code></pre></div>
</div>
<div id="snow-model-parameters" class="section level3">
<h3>Snow model parameters</h3>
<p>We also need to specify the snow model parameters - these ones tend to work well in general and at the site being considered there is no snowfall so they will not be of consequence.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>snowtemp <span class="ot">&lt;-</span> <span class="fl">1.5</span> <span class="co"># temperature at which precipitation falls as snow (used for snow model)</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>snowdens <span class="ot">&lt;-</span> <span class="fl">0.375</span> <span class="co"># snow density (Mg/m3)</span></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>densfun <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.5979</span>, <span class="fl">0.2178</span>, <span class="fl">0.001</span>, <span class="fl">0.0038</span>) <span class="co"># slope and intercept of linear model of snow density as a function of day of year - if it is c(0, 0) then fixed density used</span></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>snowmelt <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="co"># proportion of calculated snowmelt that doesn&#39;t refreeze</span></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>undercatch <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="co"># undercatch multipier for converting rainfall to snow</span></span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>rainmelt <span class="ot">&lt;-</span> <span class="fl">0.0125</span> <span class="co"># parameter in equation from Anderson&#39;s SNOW-17 model that melts snow with rainfall as a function of air temp</span></span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>snowcond <span class="ot">&lt;-</span> <span class="dv">0</span> <span class="co"># effective snow thermal conductivity W/mC (if zero, uses inbuilt function of density)</span></span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>intercept <span class="ot">&lt;-</span> <span class="dv">0</span> <span class="co"># snow interception fraction for when there&#39;s shade (0-1)</span></span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>grasshade <span class="ot">&lt;-</span> <span class="dv">0</span> <span class="co"># if 1, means shade is removed when snow is present, because shade is cast by grass/low veg</span></span></code></pre></div>
</div>
<div id="tide-parameters" class="section level3">
<h3>Tide parameters</h3>
<p>Finally, we need to give the model a vector of tide conditions although we are not running the model in intertidal mode so they also will be of no consequence.</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># intertidal simulation input vector (col 1 = tide in(1)/out(0), col 2 = sea water temperature in °C, col 3 = % wet from wave splash)</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>tides <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="at">data =</span> <span class="dv">0</span>, <span class="at">nrow =</span> <span class="dv">24</span> <span class="sc">*</span> doynum, <span class="at">ncol =</span> <span class="dv">3</span>) <span class="co"># matrix for tides</span></span></code></pre></div>
</div>
<div id="running-the-model" class="section level3">
<h3>Running the model</h3>
<p>The data inputs are all ready now and they need to be sent to the Fortran program. The single-value inputs are collected in on long vector called <code>microinput</code> and then this, together with the longer inputs, are then sent put into a list called <code>microin</code> and passed to the function <code>microclimate</code> which runs the model. We will return the results to a list object called <code>micro</code>.</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co"># microclimate input parameters list</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>microinput <span class="ot">&lt;-</span> <span class="fu">c</span>(doynum, RUF, ERR, Usrhyt, Refhyt, Numtyps, Z01, Z02, ZH1, ZH2, idayst, ida, HEMIS, ALAT, AMINUT, ALONG, ALMINT, ALREF, slope, azmuth, ALTT, CMH2O, microdaily, tannul, EC, VIEWF, snowtemp, snowdens, snowmelt, undercatch, rainmult, runshade, runmoist, maxpool, evenrain, snowmodel, rainmelt, writecsv, densfun, hourly, rainhourly, lamb, IUV, RW, PC, RL, SP, R1, IM, MAXCOUNT, IR, message, fail, snowcond, intercept, grasshade, solonly, ZH, D0)</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a><span class="co"># all microclimate data input list - all these variables are expected by the input argument of the fortran micro2014 subroutine</span></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>microin <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">microinput =</span> microinput, <span class="at">tides =</span> tides, <span class="at">doy =</span> doy, <span class="at">SLES =</span> SLES, <span class="at">DEP =</span> DEP, <span class="at">Nodes =</span> Nodes, <span class="at">MAXSHADES =</span> MAXSHADES, <span class="at">MINSHADES =</span> MINSHADES, <span class="at">TIMAXS =</span> TIMAXS, <span class="at">TIMINS =</span> TIMINS, <span class="at">TMAXX =</span> TMAXX, <span class="at">TMINN =</span> TMINN, <span class="at">RHMAXX =</span> RHMAXX, <span class="at">RHMINN =</span> RHMINN, <span class="at">CCMAXX =</span> CCMAXX, <span class="at">CCMINN =</span> CCMINN, <span class="at">WNMAXX =</span> WNMAXX, <span class="at">WNMINN =</span> WNMINN, <span class="at">TAIRhr =</span> TAIRhr, <span class="at">RHhr =</span> RHhr, <span class="at">WNhr =</span> WNhr, <span class="at">CLDhr =</span> CLDhr, <span class="at">SOLRhr =</span> SOLRhr, <span class="at">RAINhr =</span> RAINhr, <span class="at">ZENhr =</span> ZENhr, <span class="at">IRDhr =</span> IRDhr, <span class="at">REFLS =</span> REFLS, <span class="at">PCTWET =</span> PCTWET, <span class="at">soilinit =</span> soilinit, <span class="at">hori =</span> hori, <span class="at">TAI =</span> TAI, <span class="at">soilprops =</span> soilprops, <span class="at">moists =</span> moists, <span class="at">RAINFALL =</span> RAINFALL, <span class="at">tannulrun =</span> tannulrun, <span class="at">PE =</span> PE, <span class="at">KS =</span> KS, <span class="at">BB =</span> BB, <span class="at">BD =</span> BD, <span class="at">DD =</span> DD, <span class="at">L =</span> L, <span class="at">LAI =</span> LAI)</span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>micro <span class="ot">&lt;-</span> <span class="fu">microclimate</span>(microin) <span class="co"># run the model in Fortran</span></span></code></pre></div>
</div>
<div id="retrieving-the-output-and-plotting-the-results-against-observed-values" class="section level3">
<h3>Retrieving the output and plotting the results against observed values</h3>
<p>Now the model has run and we need to retrieve the output from the <code>micro</code> list and add the date/time vector to them from the original SCAN dataset.</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co"># retrieve ouptut</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>dates <span class="ot">&lt;-</span> weather<span class="sc">$</span>datetime[<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(micro<span class="sc">$</span>metout)]</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>metout <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(micro<span class="sc">$</span>metout) <span class="co"># retrieve above ground microclimatic conditions, min shade</span></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>shadmet <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(micro<span class="sc">$</span>shadmet) <span class="co"># retrieve above ground microclimatic conditions, max shade</span></span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>soil <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(micro<span class="sc">$</span>soil) <span class="co"># retrieve soil temperatures, minimum shade</span></span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>shadsoil <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(micro<span class="sc">$</span>shadsoil) <span class="co"># retrieve soil temperatures, maximum shade</span></span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>soilmoist <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(micro<span class="sc">$</span>soilmoist) <span class="co"># retrieve soil moisture, minimum shade</span></span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>shadmoist <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(micro<span class="sc">$</span>shadmoist) <span class="co"># retrieve soil moisture, maximum shade</span></span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a>humid <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(micro<span class="sc">$</span>humid) <span class="co"># retrieve soil humidity, minimum shade</span></span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a>shadhumid <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(micro<span class="sc">$</span>shadhumid) <span class="co"># retrieve soil humidity, maximum shade</span></span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a>soilpot <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(micro<span class="sc">$</span>soilpot) <span class="co"># retrieve soil water potential, minimum shade</span></span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a>shadpot <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(micro<span class="sc">$</span>shadpot) <span class="co"># retrieve soil water potential, maximum shade</span></span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-14"><a href="#cb19-14" aria-hidden="true" tabindex="-1"></a><span class="co"># append dates</span></span>
<span id="cb19-15"><a href="#cb19-15" aria-hidden="true" tabindex="-1"></a>metout <span class="ot">&lt;-</span> <span class="fu">cbind</span>(dates, metout)</span>
<span id="cb19-16"><a href="#cb19-16" aria-hidden="true" tabindex="-1"></a>shadmet <span class="ot">&lt;-</span> <span class="fu">cbind</span>(dates, shadmet)</span>
<span id="cb19-17"><a href="#cb19-17" aria-hidden="true" tabindex="-1"></a>soil <span class="ot">&lt;-</span> <span class="fu">cbind</span>(dates, soil)</span>
<span id="cb19-18"><a href="#cb19-18" aria-hidden="true" tabindex="-1"></a>shadsoil <span class="ot">&lt;-</span> <span class="fu">cbind</span>(dates, shadsoil)</span>
<span id="cb19-19"><a href="#cb19-19" aria-hidden="true" tabindex="-1"></a>soilmoist <span class="ot">&lt;-</span> <span class="fu">cbind</span>(dates, soilmoist)</span>
<span id="cb19-20"><a href="#cb19-20" aria-hidden="true" tabindex="-1"></a>shadmoist <span class="ot">&lt;-</span> <span class="fu">cbind</span>(dates, shadmoist)</span>
<span id="cb19-21"><a href="#cb19-21" aria-hidden="true" tabindex="-1"></a>humid <span class="ot">&lt;-</span> <span class="fu">cbind</span>(dates, humid)</span>
<span id="cb19-22"><a href="#cb19-22" aria-hidden="true" tabindex="-1"></a>shadhumid <span class="ot">&lt;-</span> <span class="fu">cbind</span>(dates, shadhumid)</span>
<span id="cb19-23"><a href="#cb19-23" aria-hidden="true" tabindex="-1"></a>soilpot <span class="ot">&lt;-</span> <span class="fu">cbind</span>(dates, soilpot)</span>
<span id="cb19-24"><a href="#cb19-24" aria-hidden="true" tabindex="-1"></a>shadpot <span class="ot">&lt;-</span> <span class="fu">cbind</span>(dates, shadpot)</span></code></pre></div>
<p>Finally, we can specify a time window by setting the variables <code>tstart</code> and <code>tfinish</code> and then make two composite plots each showing the predictions and observations for the 5 depths, for soil temperature and soil moisture, respectively.</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co"># choose a time window to plot</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>tstart <span class="ot">&lt;-</span> <span class="fu">as.POSIXct</span>(<span class="st">&quot;2015-05-01&quot;</span>,<span class="at">format=</span><span class="st">&quot;%Y-%m-%d&quot;</span>)</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>tfinish <span class="ot">&lt;-</span> <span class="fu">as.POSIXct</span>(<span class="st">&quot;2015-07-31&quot;</span>,<span class="at">format=</span><span class="st">&quot;%Y-%m-%d&quot;</span>)</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a><span class="co"># set up plot parameters</span></span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">5</span>, <span class="dv">1</span>)) <span class="co"># set up for 6 plots in 1 columns</span></span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">oma =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">2</span>) <span class="sc">+</span> <span class="fl">0.1</span>) <span class="co"># margin spacing stuff</span></span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">1</span>, <span class="dv">1</span>) <span class="sc">+</span> <span class="fl">0.1</span>) <span class="co"># margin spacing stuff</span></span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mgp =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">0</span>) ) <span class="co"># margin spacing stuff</span></span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a><span class="co"># plot the soil temperatures</span></span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(dates, soil<span class="sc">$</span>D5cm, <span class="at">type=</span><span class="st">&#39;l&#39;</span>,<span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">10</span>, <span class="dv">70</span>),<span class="at">xlim =</span> <span class="fu">c</span>(tstart, tfinish),<span class="at">xaxt =</span> <span class="st">&quot;n&quot;</span>,<span class="at">ylab =</span> <span class="fu">expression</span>(<span class="st">&quot;soil temperature (&quot;</span> <span class="sc">*</span> degree <span class="sc">*</span> C <span class="sc">*</span><span class="st">&quot;)&quot;</span>),<span class="at">xlab=</span><span class="st">&quot;&quot;</span>)</span>
<span id="cb20-13"><a href="#cb20-13" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(weather<span class="sc">$</span>datetime, weather<span class="sc">$</span>STO.I_2, <span class="at">type=</span><span class="st">&#39;l&#39;</span>,<span class="at">col=</span><span class="st">&quot;red&quot;</span>)</span>
<span id="cb20-14"><a href="#cb20-14" aria-hidden="true" tabindex="-1"></a><span class="fu">axis.POSIXct</span>(<span class="at">side =</span> <span class="dv">1</span>, <span class="at">x =</span> micro_shd<span class="sc">$</span>dates, <span class="at">at =</span> <span class="fu">seq</span>(tstart, tfinish, <span class="st">&quot;weeks&quot;</span>), <span class="at">format =</span> <span class="st">&quot;%d-%m&quot;</span>,  <span class="at">las =</span> <span class="dv">2</span>)</span>
<span id="cb20-15"><a href="#cb20-15" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(tstart, <span class="dv">10</span>,<span class="st">&quot;5cm&quot;</span>,<span class="at">col=</span><span class="st">&quot;black&quot;</span>,<span class="at">pos =</span> <span class="dv">4</span>, <span class="at">cex =</span> <span class="fl">1.5</span>)</span>
<span id="cb20-16"><a href="#cb20-16" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="at">lty =</span> <span class="dv">2</span>, <span class="at">col=</span><span class="st">&#39;light blue&#39;</span>)</span>
<span id="cb20-17"><a href="#cb20-17" aria-hidden="true" tabindex="-1"></a><span class="co">#points(dates, metout$SNOWDEP, type=&#39;h&#39;,col=&#39;light blue&#39;)</span></span>
<span id="cb20-18"><a href="#cb20-18" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(dates, soil<span class="sc">$</span>D10cm, <span class="at">type=</span><span class="st">&#39;l&#39;</span>,<span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">10</span>, <span class="dv">70</span>),<span class="at">xlim =</span> <span class="fu">c</span>(tstart, tfinish),<span class="at">xaxt =</span> <span class="st">&quot;n&quot;</span>,<span class="at">ylab =</span> <span class="fu">expression</span>(<span class="st">&quot;soil temperature (&quot;</span> <span class="sc">*</span> degree <span class="sc">*</span> C <span class="sc">*</span><span class="st">&quot;)&quot;</span>),<span class="at">xlab=</span><span class="st">&quot;&quot;</span>)</span>
<span id="cb20-19"><a href="#cb20-19" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(weather<span class="sc">$</span>datetime, weather<span class="sc">$</span>STO.I_4, <span class="at">type=</span><span class="st">&#39;l&#39;</span>,<span class="at">col=</span><span class="st">&quot;red&quot;</span>)</span>
<span id="cb20-20"><a href="#cb20-20" aria-hidden="true" tabindex="-1"></a><span class="fu">axis.POSIXct</span>(<span class="at">side =</span> <span class="dv">1</span>, <span class="at">x =</span> micro_shd<span class="sc">$</span>dates, <span class="at">at =</span> <span class="fu">seq</span>(tstart, tfinish, <span class="st">&quot;weeks&quot;</span>), <span class="at">format =</span> <span class="st">&quot;%d-%m&quot;</span>,  <span class="at">las =</span> <span class="dv">2</span>)</span>
<span id="cb20-21"><a href="#cb20-21" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(tstart, <span class="dv">10</span>,<span class="st">&quot;10cm&quot;</span>,<span class="at">col=</span><span class="st">&quot;black&quot;</span>,<span class="at">pos =</span> <span class="dv">4</span>, <span class="at">cex =</span> <span class="fl">1.5</span>)</span>
<span id="cb20-22"><a href="#cb20-22" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="at">lty =</span> <span class="dv">2</span>, <span class="at">col=</span><span class="st">&#39;light blue&#39;</span>)</span>
<span id="cb20-23"><a href="#cb20-23" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(dates, soil<span class="sc">$</span>D20cm, <span class="at">type=</span><span class="st">&#39;l&#39;</span>,<span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">10</span>, <span class="dv">70</span>),<span class="at">xlim =</span> <span class="fu">c</span>(tstart, tfinish),<span class="at">xaxt =</span> <span class="st">&quot;n&quot;</span>,<span class="at">ylab =</span> <span class="fu">expression</span>(<span class="st">&quot;soil temperature (&quot;</span> <span class="sc">*</span> degree <span class="sc">*</span> C <span class="sc">*</span><span class="st">&quot;)&quot;</span>),<span class="at">xlab=</span><span class="st">&quot;&quot;</span>)</span>
<span id="cb20-24"><a href="#cb20-24" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(weather<span class="sc">$</span>datetime, weather<span class="sc">$</span>STO.I_8, <span class="at">type=</span><span class="st">&#39;l&#39;</span>,<span class="at">col=</span><span class="st">&quot;red&quot;</span>)</span>
<span id="cb20-25"><a href="#cb20-25" aria-hidden="true" tabindex="-1"></a><span class="fu">axis.POSIXct</span>(<span class="at">side =</span> <span class="dv">1</span>, <span class="at">x =</span> micro_shd<span class="sc">$</span>dates, <span class="at">at =</span> <span class="fu">seq</span>(tstart, tfinish, <span class="st">&quot;weeks&quot;</span>), <span class="at">format =</span> <span class="st">&quot;%d-%m&quot;</span>,  <span class="at">las =</span> <span class="dv">2</span>)</span>
<span id="cb20-26"><a href="#cb20-26" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(tstart, <span class="dv">10</span>,<span class="st">&quot;20cm&quot;</span>,<span class="at">col=</span><span class="st">&quot;black&quot;</span>,<span class="at">pos =</span> <span class="dv">4</span>, <span class="at">cex =</span> <span class="fl">1.5</span>)</span>
<span id="cb20-27"><a href="#cb20-27" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="at">lty =</span> <span class="dv">2</span>, <span class="at">col=</span><span class="st">&#39;light blue&#39;</span>)</span>
<span id="cb20-28"><a href="#cb20-28" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(dates, soil<span class="sc">$</span>D50cm, <span class="at">type=</span><span class="st">&#39;l&#39;</span>,<span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">10</span>, <span class="dv">70</span>),<span class="at">xlim =</span> <span class="fu">c</span>(tstart, tfinish),<span class="at">xaxt =</span> <span class="st">&quot;n&quot;</span>,<span class="at">ylab =</span> <span class="fu">expression</span>(<span class="st">&quot;soil temperature (&quot;</span> <span class="sc">*</span> degree <span class="sc">*</span> C <span class="sc">*</span><span class="st">&quot;)&quot;</span>),<span class="at">xlab=</span><span class="st">&quot;&quot;</span>)</span>
<span id="cb20-29"><a href="#cb20-29" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(weather<span class="sc">$</span>datetime, weather<span class="sc">$</span>STO.I_20, <span class="at">type=</span><span class="st">&#39;l&#39;</span>,<span class="at">col=</span><span class="st">&quot;red&quot;</span>)</span>
<span id="cb20-30"><a href="#cb20-30" aria-hidden="true" tabindex="-1"></a><span class="fu">axis.POSIXct</span>(<span class="at">side =</span> <span class="dv">1</span>, <span class="at">x =</span> micro_shd<span class="sc">$</span>dates, <span class="at">at =</span> <span class="fu">seq</span>(tstart, tfinish, <span class="st">&quot;weeks&quot;</span>), <span class="at">format =</span> <span class="st">&quot;%d-%m&quot;</span>,  <span class="at">las =</span> <span class="dv">2</span>)</span>
<span id="cb20-31"><a href="#cb20-31" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(tstart, <span class="dv">10</span>,<span class="st">&quot;50cm&quot;</span>,<span class="at">col=</span><span class="st">&quot;black&quot;</span>,<span class="at">pos =</span> <span class="dv">4</span>, <span class="at">cex =</span> <span class="fl">1.5</span>)</span>
<span id="cb20-32"><a href="#cb20-32" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="at">lty =</span> <span class="dv">2</span>, <span class="at">col=</span><span class="st">&#39;light blue&#39;</span>)</span>
<span id="cb20-33"><a href="#cb20-33" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(dates, soil<span class="sc">$</span>D100cm, <span class="at">type=</span><span class="st">&#39;l&#39;</span>,<span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">10</span>, <span class="dv">70</span>),<span class="at">xlim =</span> <span class="fu">c</span>(tstart, tfinish),<span class="at">xaxt =</span> <span class="st">&quot;n&quot;</span>,<span class="at">ylab =</span> <span class="fu">expression</span>(<span class="st">&quot;soil temperature (&quot;</span> <span class="sc">*</span> degree <span class="sc">*</span> C <span class="sc">*</span><span class="st">&quot;)&quot;</span>),<span class="at">xlab=</span><span class="st">&quot;&quot;</span>)</span>
<span id="cb20-34"><a href="#cb20-34" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(weather<span class="sc">$</span>datetime, weather<span class="sc">$</span>STO.I_40, <span class="at">type=</span><span class="st">&#39;l&#39;</span>,<span class="at">col=</span><span class="st">&quot;red&quot;</span>)</span>
<span id="cb20-35"><a href="#cb20-35" aria-hidden="true" tabindex="-1"></a><span class="fu">axis.POSIXct</span>(<span class="at">side =</span> <span class="dv">1</span>, <span class="at">x =</span> micro_shd<span class="sc">$</span>dates, <span class="at">at =</span> <span class="fu">seq</span>(tstart, tfinish, <span class="st">&quot;weeks&quot;</span>), <span class="at">format =</span> <span class="st">&quot;%d-%m&quot;</span>,  <span class="at">las =</span> <span class="dv">2</span>)</span>
<span id="cb20-36"><a href="#cb20-36" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="at">lty =</span> <span class="dv">2</span>, <span class="at">col=</span><span class="st">&#39;light blue&#39;</span>)</span>
<span id="cb20-37"><a href="#cb20-37" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(tstart, <span class="dv">10</span>,<span class="st">&quot;100cm&quot;</span>,<span class="at">col=</span><span class="st">&quot;black&quot;</span>,<span class="at">pos =</span> <span class="dv">4</span>, <span class="at">cex =</span> <span class="fl">1.5</span>)</span>
<span id="cb20-38"><a href="#cb20-38" aria-hidden="true" tabindex="-1"></a><span class="fu">mtext</span>(site<span class="sc">$</span>name, <span class="at">outer =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co"># plot the soil moisture</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(dates, soilmoist<span class="sc">$</span>WC5cm <span class="sc">*</span> <span class="dv">100</span>, <span class="at">type=</span><span class="st">&#39;l&#39;</span>,<span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">60</span>),<span class="at">xaxt =</span> <span class="st">&quot;n&quot;</span>,<span class="at">xlim =</span> <span class="fu">c</span>(tstart, tfinish),<span class="at">col=</span><span class="st">&quot;blue&quot;</span>,<span class="at">ylab=</span><span class="st">&quot;soil moisture (%)&quot;</span>,<span class="at">xlab=</span><span class="st">&quot;&quot;</span>)</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a><span class="fu">axis.POSIXct</span>(<span class="at">side =</span> <span class="dv">1</span>, <span class="at">x =</span> micro_shd<span class="sc">$</span>dates, <span class="at">at =</span> <span class="fu">seq</span>(tstart, tfinish, <span class="st">&quot;weeks&quot;</span>), <span class="at">format =</span> <span class="st">&quot;%d-%m&quot;</span>,  <span class="at">las =</span> <span class="dv">2</span>)</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(weather<span class="sc">$</span>datetime, weather<span class="sc">$</span>SMS.I_2, <span class="at">type=</span><span class="st">&#39;l&#39;</span>,<span class="at">col=</span><span class="st">&quot;red&quot;</span>)</span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(tstart, <span class="dv">40</span>,<span class="st">&quot;5cm&quot;</span>,<span class="at">col=</span><span class="st">&quot;black&quot;</span>,<span class="at">pos =</span> <span class="dv">4</span>, <span class="at">cex =</span> <span class="fl">1.5</span>)</span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(dates, soilmoist<span class="sc">$</span>WC10cm <span class="sc">*</span> <span class="dv">100</span>, <span class="at">type=</span><span class="st">&#39;l&#39;</span>,<span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">60</span>),<span class="at">xaxt =</span> <span class="st">&quot;n&quot;</span>,<span class="at">xlim =</span> <span class="fu">c</span>(tstart, tfinish),<span class="at">col=</span><span class="st">&quot;blue&quot;</span>,<span class="at">ylab=</span><span class="st">&quot;soil moisture (%)&quot;</span>,<span class="at">xlab=</span><span class="st">&quot;&quot;</span>)</span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a><span class="fu">axis.POSIXct</span>(<span class="at">side =</span> <span class="dv">1</span>, <span class="at">x =</span> micro_shd<span class="sc">$</span>dates, <span class="at">at =</span> <span class="fu">seq</span>(tstart, tfinish, <span class="st">&quot;weeks&quot;</span>), <span class="at">format =</span> <span class="st">&quot;%d-%m&quot;</span>,  <span class="at">las =</span> <span class="dv">2</span>)</span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(weather<span class="sc">$</span>datetime, weather<span class="sc">$</span>SMS.I_4, <span class="at">type=</span><span class="st">&#39;l&#39;</span>,<span class="at">col=</span><span class="st">&quot;red&quot;</span>)</span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(tstart, <span class="dv">40</span>,<span class="st">&quot;10cm&quot;</span>,<span class="at">col=</span><span class="st">&quot;black&quot;</span>,<span class="at">pos =</span> <span class="dv">4</span>, <span class="at">cex =</span> <span class="fl">1.5</span>)</span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(dates, soilmoist<span class="sc">$</span>WC20cm <span class="sc">*</span> <span class="dv">100</span>, <span class="at">type=</span><span class="st">&#39;l&#39;</span>,<span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">60</span>),<span class="at">xaxt =</span> <span class="st">&quot;n&quot;</span>,<span class="at">xlim =</span> <span class="fu">c</span>(tstart, tfinish),<span class="at">col=</span><span class="st">&quot;blue&quot;</span>,<span class="at">ylab=</span><span class="st">&quot;soil moisture (%)&quot;</span>,<span class="at">xlab=</span><span class="st">&quot;&quot;</span>)</span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a><span class="fu">axis.POSIXct</span>(<span class="at">side =</span> <span class="dv">1</span>, <span class="at">x =</span> micro_shd<span class="sc">$</span>dates, <span class="at">at =</span> <span class="fu">seq</span>(tstart, tfinish, <span class="st">&quot;weeks&quot;</span>), <span class="at">format =</span> <span class="st">&quot;%d-%m&quot;</span>,  <span class="at">las =</span> <span class="dv">2</span>)</span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(weather<span class="sc">$</span>datetime, weather<span class="sc">$</span>SMS.I_8, <span class="at">type=</span><span class="st">&#39;l&#39;</span>,<span class="at">col=</span><span class="st">&quot;red&quot;</span>)</span>
<span id="cb21-13"><a href="#cb21-13" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(tstart, <span class="dv">40</span>,<span class="st">&quot;20cm&quot;</span>,<span class="at">col=</span><span class="st">&quot;black&quot;</span>,<span class="at">pos =</span> <span class="dv">4</span>, <span class="at">cex =</span> <span class="fl">1.5</span>)</span>
<span id="cb21-14"><a href="#cb21-14" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(dates, soilmoist<span class="sc">$</span>WC50cm <span class="sc">*</span> <span class="dv">100</span>, <span class="at">type=</span><span class="st">&#39;l&#39;</span>,<span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">60</span>),<span class="at">xaxt =</span> <span class="st">&quot;n&quot;</span>,<span class="at">xlim =</span> <span class="fu">c</span>(tstart, tfinish),<span class="at">col=</span><span class="st">&quot;blue&quot;</span>,<span class="at">ylab=</span><span class="st">&quot;soil moisture (%)&quot;</span>,<span class="at">xlab=</span><span class="st">&quot;&quot;</span>)</span>
<span id="cb21-15"><a href="#cb21-15" aria-hidden="true" tabindex="-1"></a><span class="fu">axis.POSIXct</span>(<span class="at">side =</span> <span class="dv">1</span>, <span class="at">x =</span> micro_shd<span class="sc">$</span>dates, <span class="at">at =</span> <span class="fu">seq</span>(tstart, tfinish, <span class="st">&quot;weeks&quot;</span>), <span class="at">format =</span> <span class="st">&quot;%d-%m&quot;</span>,  <span class="at">las =</span> <span class="dv">2</span>)</span>
<span id="cb21-16"><a href="#cb21-16" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(weather<span class="sc">$</span>datetime, weather<span class="sc">$</span>SMS.I_20, <span class="at">type=</span><span class="st">&#39;l&#39;</span>,<span class="at">col=</span><span class="st">&quot;red&quot;</span>)</span>
<span id="cb21-17"><a href="#cb21-17" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(tstart, <span class="dv">40</span>,<span class="st">&quot;50cm&quot;</span>,<span class="at">col=</span><span class="st">&quot;black&quot;</span>,<span class="at">pos =</span> <span class="dv">4</span>, <span class="at">cex =</span> <span class="fl">1.5</span>)</span>
<span id="cb21-18"><a href="#cb21-18" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(dates, soilmoist<span class="sc">$</span>WC100cm <span class="sc">*</span> <span class="dv">100</span>, <span class="at">type=</span><span class="st">&#39;l&#39;</span>,<span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">100</span>),<span class="at">xaxt =</span> <span class="st">&quot;n&quot;</span>,<span class="at">xlim =</span> <span class="fu">c</span>(tstart, tfinish),<span class="at">col=</span><span class="st">&quot;blue&quot;</span>,<span class="at">ylab=</span><span class="st">&quot;soil moisture (%)&quot;</span>,<span class="at">xlab=</span><span class="st">&quot;&quot;</span>)</span>
<span id="cb21-19"><a href="#cb21-19" aria-hidden="true" tabindex="-1"></a><span class="fu">axis.POSIXct</span>(<span class="at">side =</span> <span class="dv">1</span>, <span class="at">x =</span> micro_shd<span class="sc">$</span>dates, <span class="at">at =</span> <span class="fu">seq</span>(tstart, tfinish, <span class="st">&quot;weeks&quot;</span>), <span class="at">format =</span> <span class="st">&quot;%d-%m&quot;</span>,  <span class="at">las =</span> <span class="dv">2</span>)</span>
<span id="cb21-20"><a href="#cb21-20" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(weather<span class="sc">$</span>datetime, weather<span class="sc">$</span>SMS.I_40, <span class="at">type=</span><span class="st">&#39;l&#39;</span>,<span class="at">col=</span><span class="st">&quot;red&quot;</span>)</span>
<span id="cb21-21"><a href="#cb21-21" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(tstart, <span class="dv">40</span>,<span class="st">&quot;100cm&quot;</span>,<span class="at">col=</span><span class="st">&quot;black&quot;</span>,<span class="at">pos =</span> <span class="dv">4</span>, <span class="at">cex =</span> <span class="fl">1.5</span>)</span>
<span id="cb21-22"><a href="#cb21-22" aria-hidden="true" tabindex="-1"></a><span class="fu">mtext</span>(site<span class="sc">$</span>name, <span class="at">outer =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
