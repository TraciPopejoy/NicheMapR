<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="Michael Kearney" />

<meta name="date" content="2021-07-19" />

<title>Endotherm Model Tutorial II: component functions</title>

<script>// Hide empty <a> tag within highlighted CodeBlock for screen reader accessibility (see https://github.com/jgm/pandoc/issues/6352#issuecomment-626106786) -->
// v0.0.1
// Written by JooYoung Seo (jooyoung@psu.edu) and Atsushi Yasumoto on June 1st, 2020.

document.addEventListener('DOMContentLoaded', function() {
  const codeList = document.getElementsByClassName("sourceCode");
  for (var i = 0; i < codeList.length; i++) {
    var linkList = codeList[i].getElementsByTagName('a');
    for (var j = 0; j < linkList.length; j++) {
      if (linkList[j].innerHTML === "") {
        linkList[j].setAttribute('aria-hidden', 'true');
      }
    }
  }
});
</script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>


<style type="text/css">
  code {
    white-space: pre;
  }
  .sourceCode {
    overflow: visible;
  }
</style>
<style type="text/css" data-origin="pandoc">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Endotherm Model Tutorial II: component functions</h1>
<h4 class="author">Michael Kearney</h4>
<h4 class="date">2021-07-19</h4>



<div id="overview" class="section level2">
<h2>Overview</h2>
<p>This document provides an overview of an R implementation of the NicheMapR endotherm model, via the sub-functions of ‘endoR’ and ‘endoR_devel’. This implementation modularises the original version such that many of the internal subroutines and functions can be called separately. The idea is that the user has more flexibility in setting the model up for the behavioural and physiological responses of a particular animal. All the underlying theory, equations and subroutines are described in <a href="endotherm-model-equations.html">Endotherm Theory Tutorial</a>. Also the <a href="endotherm-model-tutorial.html">Endotherm Model Tutorial</a> shows how to use ‘endoR’ (and ‘endoR_devel’) as a whole.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a><span class="kw">library</span>(NicheMapR)</span>
<span id="cb1-2"><a href="#cb1-2"></a><span class="kw">library</span>(knitr)</span>
<span id="cb1-3"><a href="#cb1-3"></a><span class="kw">library</span>(plotrix)</span></code></pre></div>
</div>
<div id="running-the-separate-subroutines" class="section level2">
<h2>Running the separate subroutines</h2>
<div id="irprop" class="section level3">
<h3>IRPROP</h3>
<p>This subroutine computes the three parameters needed for computing conduction and infrared radiation through the fur.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1"></a><span class="co"># environmental input</span></span>
<span id="cb2-2"><a href="#cb2-2"></a>TA &lt;-<span class="st"> </span><span class="dv">20</span>  <span class="co"># air temperature, for calculation of conductivity of air (°C)</span></span>
<span id="cb2-3"><a href="#cb2-3"></a></span>
<span id="cb2-4"><a href="#cb2-4"></a><span class="co"># shape input</span></span>
<span id="cb2-5"><a href="#cb2-5"></a>PVEN &lt;-<span class="st"> </span><span class="fl">0.3</span>  <span class="co"># maximum fraction of surface area that is ventral (fractional, 0-1)</span></span>
<span id="cb2-6"><a href="#cb2-6"></a></span>
<span id="cb2-7"><a href="#cb2-7"></a><span class="co"># fur properties</span></span>
<span id="cb2-8"><a href="#cb2-8"></a>DHAIRD &lt;-<span class="st"> </span><span class="fl">3e-05</span>  <span class="co"># hair diameter, dorsal (m)</span></span>
<span id="cb2-9"><a href="#cb2-9"></a>DHAIRV &lt;-<span class="st"> </span><span class="fl">3e-05</span>  <span class="co"># hair diameter, ventral (m)</span></span>
<span id="cb2-10"><a href="#cb2-10"></a>LHAIRD &lt;-<span class="st"> </span><span class="fl">0.0239</span>  <span class="co"># hair length, dorsal (m)  </span></span>
<span id="cb2-11"><a href="#cb2-11"></a>LHAIRV &lt;-<span class="st"> </span><span class="fl">0.0239</span>  <span class="co"># hair length, ventral (m)  </span></span>
<span id="cb2-12"><a href="#cb2-12"></a>ZFURD &lt;-<span class="st"> </span><span class="fl">0.009</span>  <span class="co"># fur depth, dorsal (m)</span></span>
<span id="cb2-13"><a href="#cb2-13"></a>ZFURV &lt;-<span class="st"> </span><span class="fl">0.009</span>  <span class="co"># fur depth, ventral (m)</span></span>
<span id="cb2-14"><a href="#cb2-14"></a>ZFURCOMP &lt;-<span class="st"> </span>ZFURV  <span class="co"># depth of compressed fur (for conduction) (m)</span></span>
<span id="cb2-15"><a href="#cb2-15"></a>RHOD &lt;-<span class="st"> </span><span class="dv">39680000</span>  <span class="co"># hair density, dorsal (1/m2) </span></span>
<span id="cb2-16"><a href="#cb2-16"></a>RHOV &lt;-<span class="st"> </span><span class="dv">27810000</span>  <span class="co"># hair density, ventral (1/m2)</span></span>
<span id="cb2-17"><a href="#cb2-17"></a>REFLD &lt;-<span class="st"> </span><span class="fl">0.301</span>  <span class="co"># fur reflectivity dorsal (fractional, 0-1) </span></span>
<span id="cb2-18"><a href="#cb2-18"></a>REFLV &lt;-<span class="st"> </span><span class="fl">0.301</span>  <span class="co"># fur reflectivity ventral (fractional, 0-1)</span></span>
<span id="cb2-19"><a href="#cb2-19"></a>KHAIR &lt;-<span class="st"> </span><span class="fl">0.209</span>  <span class="co"># hair thermal conductivity (W/m°C)</span></span>
<span id="cb2-20"><a href="#cb2-20"></a></span>
<span id="cb2-21"><a href="#cb2-21"></a><span class="co"># call the subroutine</span></span>
<span id="cb2-22"><a href="#cb2-22"></a>IRPROP.out &lt;-<span class="st"> </span><span class="kw">IRPROP</span>(TA, DHAIRD, DHAIRV, LHAIRD, LHAIRV, ZFURD, </span>
<span id="cb2-23"><a href="#cb2-23"></a>    ZFURV, RHOD, RHOV, REFLD, REFLV, ZFURCOMP, PVEN, KHAIR)</span>
<span id="cb2-24"><a href="#cb2-24"></a></span>
<span id="cb2-25"><a href="#cb2-25"></a><span class="co"># output</span></span>
<span id="cb2-26"><a href="#cb2-26"></a>KEFARA &lt;-<span class="st"> </span>IRPROP.out[<span class="dv">1</span><span class="op">:</span><span class="dv">3</span>]  <span class="co"># effective thermal conductivity of fur array, mean, dorsal, ventral (W/mK)</span></span>
<span id="cb2-27"><a href="#cb2-27"></a>BETARA &lt;-<span class="st"> </span>IRPROP.out[<span class="dv">4</span><span class="op">:</span><span class="dv">6</span>]  <span class="co"># term involved in computing optical thickness (1/m)</span></span>
<span id="cb2-28"><a href="#cb2-28"></a>B1ARA &lt;-<span class="st"> </span>IRPROP.out[<span class="dv">7</span><span class="op">:</span><span class="dv">9</span>]  <span class="co"># optical thickness array, mean, dorsal, ventral (-)</span></span>
<span id="cb2-29"><a href="#cb2-29"></a>DHAR &lt;-<span class="st"> </span>IRPROP.out[<span class="dv">10</span><span class="op">:</span><span class="dv">12</span>]  <span class="co"># fur diameter array, mean, dorsal, ventral (m)</span></span>
<span id="cb2-30"><a href="#cb2-30"></a>LHAR &lt;-<span class="st"> </span>IRPROP.out[<span class="dv">13</span><span class="op">:</span><span class="dv">15</span>]  <span class="co"># fur length array, mean, dorsal, ventral (m)</span></span>
<span id="cb2-31"><a href="#cb2-31"></a>RHOAR &lt;-<span class="st"> </span>IRPROP.out[<span class="dv">16</span><span class="op">:</span><span class="dv">18</span>]  <span class="co"># fur density array, mean, dorsal, ventral (fibers/m2)  </span></span>
<span id="cb2-32"><a href="#cb2-32"></a>ZZFUR &lt;-<span class="st"> </span>IRPROP.out[<span class="dv">19</span><span class="op">:</span><span class="dv">21</span>]  <span class="co"># fur depth array, mean, dorsal, ventral (m)  </span></span>
<span id="cb2-33"><a href="#cb2-33"></a>REFLFR &lt;-<span class="st"> </span>IRPROP.out[<span class="dv">22</span><span class="op">:</span><span class="dv">24</span>]  <span class="co"># fur reflectivity array, mean, dorsal, ventral (fractional, 0-1)</span></span>
<span id="cb2-34"><a href="#cb2-34"></a>FURTST &lt;-<span class="st"> </span>IRPROP.out[<span class="dv">25</span>]  <span class="co"># test of presence of fur (length x diameter x density x depth) (-)</span></span>
<span id="cb2-35"><a href="#cb2-35"></a>KFURCMPRS &lt;-<span class="st"> </span>IRPROP.out[<span class="dv">26</span>]  <span class="co"># effective thermal conductivity of compressed ventral fur (W/mK)</span></span>
<span id="cb2-36"><a href="#cb2-36"></a></span>
<span id="cb2-37"><a href="#cb2-37"></a>IRPROP.lab &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;KEFARA mean&quot;</span>, <span class="st">&quot;KEFARA dorsal&quot;</span>, <span class="st">&quot;KEFARA ventral&quot;</span>, </span>
<span id="cb2-38"><a href="#cb2-38"></a>    <span class="st">&quot;BETARA mean&quot;</span>, <span class="st">&quot;BETARA dorsal&quot;</span>, <span class="st">&quot;BETARA ventral&quot;</span>, <span class="st">&quot;B1ARA mean&quot;</span>, </span>
<span id="cb2-39"><a href="#cb2-39"></a>    <span class="st">&quot;B1ARA dorsal&quot;</span>, <span class="st">&quot;B1ARA ventral&quot;</span>, <span class="st">&quot;DHAR mean&quot;</span>, <span class="st">&quot;DHAR dorsal&quot;</span>, </span>
<span id="cb2-40"><a href="#cb2-40"></a>    <span class="st">&quot;DHAR ventral&quot;</span>, <span class="st">&quot;LHAR mean&quot;</span>, <span class="st">&quot;LHAR dorsal&quot;</span>, <span class="st">&quot;LHAR ventral&quot;</span>, </span>
<span id="cb2-41"><a href="#cb2-41"></a>    <span class="st">&quot;RHOAR mean&quot;</span>, <span class="st">&quot;RHOAR dorsal&quot;</span>, <span class="st">&quot;RHOAR ventral&quot;</span>, <span class="st">&quot;ZZFUR mean&quot;</span>, </span>
<span id="cb2-42"><a href="#cb2-42"></a>    <span class="st">&quot;ZZFUR dorsal&quot;</span>, <span class="st">&quot;ZZFUR ventral&quot;</span>, <span class="st">&quot;REFLFR mean&quot;</span>, <span class="st">&quot;REFLFR dorsal&quot;</span>, </span>
<span id="cb2-43"><a href="#cb2-43"></a>    <span class="st">&quot;REFLFR ventral&quot;</span>, <span class="st">&quot;FURTST&quot;</span>, <span class="st">&quot;KFURCMPRS&quot;</span>)</span>
<span id="cb2-44"><a href="#cb2-44"></a><span class="kw">kable</span>(<span class="kw">cbind</span>(IRPROP.lab, IRPROP.out[<span class="dv">1</span><span class="op">:</span><span class="dv">26</span>]))</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">IRPROP.lab</th>
<th align="left"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">KEFARA mean</td>
<td align="left">0.0293068804352327</td>
</tr>
<tr class="even">
<td align="left">KEFARA dorsal</td>
<td align="left">0.0296911080500765</td>
</tr>
<tr class="odd">
<td align="left">KEFARA ventral</td>
<td align="left">0.0289267341187979</td>
</tr>
<tr class="even">
<td align="left">BETARA mean</td>
<td align="left">613.67390356235</td>
</tr>
<tr class="odd">
<td align="left">BETARA dorsal</td>
<td align="left">674.176485875967</td>
</tr>
<tr class="even">
<td align="left">BETARA ventral</td>
<td align="left">553.171321248733</td>
</tr>
<tr class="odd">
<td align="left">B1ARA mean</td>
<td align="left">5.52306513206115</td>
</tr>
<tr class="even">
<td align="left">B1ARA dorsal</td>
<td align="left">6.0675883728837</td>
</tr>
<tr class="odd">
<td align="left">B1ARA ventral</td>
<td align="left">4.9785418912386</td>
</tr>
<tr class="even">
<td align="left">DHAR mean</td>
<td align="left">3e-05</td>
</tr>
<tr class="odd">
<td align="left">DHAR dorsal</td>
<td align="left">3e-05</td>
</tr>
<tr class="even">
<td align="left">DHAR ventral</td>
<td align="left">3e-05</td>
</tr>
<tr class="odd">
<td align="left">LHAR mean</td>
<td align="left">0.0239</td>
</tr>
<tr class="even">
<td align="left">LHAR dorsal</td>
<td align="left">0.0239</td>
</tr>
<tr class="odd">
<td align="left">LHAR ventral</td>
<td align="left">0.0239</td>
</tr>
<tr class="even">
<td align="left">RHOAR mean</td>
<td align="left">36119000</td>
</tr>
<tr class="odd">
<td align="left">RHOAR dorsal</td>
<td align="left">39680000</td>
</tr>
<tr class="even">
<td align="left">RHOAR ventral</td>
<td align="left">32558000</td>
</tr>
<tr class="odd">
<td align="left">ZZFUR mean</td>
<td align="left">0.009</td>
</tr>
<tr class="even">
<td align="left">ZZFUR dorsal</td>
<td align="left">0.009</td>
</tr>
<tr class="odd">
<td align="left">ZZFUR ventral</td>
<td align="left">0.009</td>
</tr>
<tr class="even">
<td align="left">REFLFR mean</td>
<td align="left">0.301</td>
</tr>
<tr class="odd">
<td align="left">REFLFR dorsal</td>
<td align="left">0.301</td>
</tr>
<tr class="even">
<td align="left">REFLFR ventral</td>
<td align="left">0.301</td>
</tr>
<tr class="odd">
<td align="left">FURTST</td>
<td align="left">0.25605504</td>
</tr>
<tr class="even">
<td align="left">KFURCMPRS</td>
<td align="left">0.0289267341187979</td>
</tr>
</tbody>
</table>
<p>Example analysis of fur diameter on effective thermal conductivity of fur.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1"></a>DHAIRs &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dv">0</span>, <span class="dv">150</span>, <span class="dv">2</span>)  <span class="co"># hair diameters (micrometers)</span></span>
<span id="cb3-2"><a href="#cb3-2"></a>KEFARAs &lt;-<span class="st"> </span><span class="ot">NULL</span></span>
<span id="cb3-3"><a href="#cb3-3"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(DHAIRs)) {</span>
<span id="cb3-4"><a href="#cb3-4"></a>    KEFARAs[i] &lt;-<span class="st"> </span><span class="kw">IRPROP</span>(TA, DHAIRs[i] <span class="op">*</span><span class="st"> </span><span class="fl">1e-06</span>, DHAIRs[i] <span class="op">*</span><span class="st"> </span><span class="fl">1e-06</span>, </span>
<span id="cb3-5"><a href="#cb3-5"></a>        LHAIRD, LHAIRV, ZFURD, ZFURV, RHOD, RHOV, REFLD, REFLV, </span>
<span id="cb3-6"><a href="#cb3-6"></a>        ZFURCOMP, PVEN, KHAIR)[<span class="dv">1</span>]</span>
<span id="cb3-7"><a href="#cb3-7"></a>}</span>
<span id="cb3-8"><a href="#cb3-8"></a><span class="kw">plot</span>(KEFARAs <span class="op">~</span><span class="st"> </span>DHAIRs, <span class="dt">type =</span> <span class="st">&quot;p&quot;</span>, <span class="dt">pch =</span> <span class="dv">16</span>, <span class="dt">ylab =</span> <span class="st">&quot;effective fur conductivity, W K-1 m-1&quot;</span>, </span>
<span id="cb3-9"><a href="#cb3-9"></a>    <span class="dt">xlab =</span> <span class="st">&quot;hair diameter, um&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>Example analysis of fur density on effective thermal conductivity of fur.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1"></a>RHOs &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dv">0</span>, <span class="dv">50000</span>, <span class="dv">500</span>)  <span class="co"># hair densities (1/cm2)</span></span>
<span id="cb4-2"><a href="#cb4-2"></a>KEFARAs &lt;-<span class="st"> </span><span class="ot">NULL</span></span>
<span id="cb4-3"><a href="#cb4-3"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(RHOs)) {</span>
<span id="cb4-4"><a href="#cb4-4"></a>    KEFARAs[i] &lt;-<span class="st"> </span><span class="kw">IRPROP</span>(TA, DHAIRD, DHAIRV, LHAIRD, LHAIRV, </span>
<span id="cb4-5"><a href="#cb4-5"></a>        ZFURD, ZFURV, RHOs[i] <span class="op">*</span><span class="st"> </span><span class="dv">10000</span>, RHOs[i] <span class="op">*</span><span class="st"> </span><span class="dv">10000</span>, REFLD, </span>
<span id="cb4-6"><a href="#cb4-6"></a>        REFLV, ZFURCOMP, PVEN, KHAIR)[<span class="dv">1</span>]</span>
<span id="cb4-7"><a href="#cb4-7"></a>}</span>
<span id="cb4-8"><a href="#cb4-8"></a><span class="kw">plot</span>(KEFARAs <span class="op">~</span><span class="st"> </span>RHOs, <span class="dt">type =</span> <span class="st">&quot;p&quot;</span>, <span class="dt">pch =</span> <span class="dv">16</span>, <span class="dt">ylab =</span> <span class="st">&quot;effective fur conductivity, W K-1 m-1&quot;</span>, </span>
<span id="cb4-9"><a href="#cb4-9"></a>    <span class="dt">xlab =</span> <span class="st">&quot;hair density, 1/cm2&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>Example analysis of fur depth on effective thermal conductivity of fur.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1"></a>ZFURs &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dv">0</span>, <span class="dv">50</span>, <span class="dv">1</span>)  <span class="co"># hair depths (mm)</span></span>
<span id="cb5-2"><a href="#cb5-2"></a>KEFARAs &lt;-<span class="st"> </span><span class="ot">NULL</span></span>
<span id="cb5-3"><a href="#cb5-3"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(ZFURs)) {</span>
<span id="cb5-4"><a href="#cb5-4"></a>    KEFARAs[i] &lt;-<span class="st"> </span><span class="kw">IRPROP</span>(TA, DHAIRD, DHAIRV, LHAIRD, LHAIRV, </span>
<span id="cb5-5"><a href="#cb5-5"></a>        ZFURs[i] <span class="op">*</span><span class="st"> </span><span class="fl">0.001</span>, ZFURs[i] <span class="op">*</span><span class="st"> </span><span class="fl">0.001</span>, RHOD, RHOV, REFLD, </span>
<span id="cb5-6"><a href="#cb5-6"></a>        REFLV, ZFURCOMP, PVEN, KHAIR)[<span class="dv">1</span>]</span>
<span id="cb5-7"><a href="#cb5-7"></a>}</span>
<span id="cb5-8"><a href="#cb5-8"></a><span class="kw">plot</span>(KEFARAs <span class="op">~</span><span class="st"> </span>ZFURs, <span class="dt">type =</span> <span class="st">&quot;p&quot;</span>, <span class="dt">pch =</span> <span class="dv">16</span>, <span class="dt">ylab =</span> <span class="st">&quot;effective fur conductivity, W K-1 m-1&quot;</span>, </span>
<span id="cb5-9"><a href="#cb5-9"></a>    <span class="dt">xlab =</span> <span class="st">&quot;fur depth, mm&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="geom_endo" class="section level3">
<h3>GEOM_ENDO</h3>
<p>This subroutine computes aspects of the animal’s geometry. Note that GEOM_ENDO requires outputs from IRPROP on fur properties. Note also that this routine is called ‘allom’ in past versions of ‘Niche Mapper’.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1"></a><span class="co"># input</span></span>
<span id="cb6-2"><a href="#cb6-2"></a>AMASS &lt;-<span class="st"> </span><span class="dv">10</span>  <span class="co"># animal mass (kg)</span></span>
<span id="cb6-3"><a href="#cb6-3"></a>ANDENS &lt;-<span class="st"> </span><span class="dv">1000</span>  <span class="co"># animal density (kg/m3)</span></span>
<span id="cb6-4"><a href="#cb6-4"></a>SUBQFAT &lt;-<span class="st"> </span><span class="dv">1</span>  <span class="co"># is subcutaneous fat present? (0 is no, 1 is yes)</span></span>
<span id="cb6-5"><a href="#cb6-5"></a>FATPCT &lt;-<span class="st"> </span><span class="dv">20</span>  <span class="co"># body fat (%)</span></span>
<span id="cb6-6"><a href="#cb6-6"></a>SHAPE &lt;-<span class="st"> </span><span class="dv">4</span>  <span class="co"># shape, 1 is cylinder, 2 is sphere, 3 is plate, 4 is ellipsoid</span></span>
<span id="cb6-7"><a href="#cb6-7"></a>SHAPE_B &lt;-<span class="st"> </span><span class="fl">2.7</span>  <span class="co"># current ratio between long and short axis (-)</span></span>
<span id="cb6-8"><a href="#cb6-8"></a>SHAPE_C &lt;-<span class="st"> </span>SHAPE_B  <span class="co"># current ratio of length:height (for plate)</span></span>
<span id="cb6-9"><a href="#cb6-9"></a>DHARA &lt;-<span class="st"> </span>DHAR[<span class="dv">1</span>]  <span class="co"># fur diameter, mean (m) (from IRPROP)</span></span>
<span id="cb6-10"><a href="#cb6-10"></a>RHOARA &lt;-<span class="st"> </span>RHOAR[<span class="dv">1</span>]  <span class="co"># hair density, mean (1/m2) (from IRPROP)</span></span>
<span id="cb6-11"><a href="#cb6-11"></a>ZFUR &lt;-<span class="st"> </span>ZZFUR[<span class="dv">1</span>]  <span class="co"># fur depth, mean (m) (from IRPROP)</span></span>
<span id="cb6-12"><a href="#cb6-12"></a>PCOND &lt;-<span class="st"> </span><span class="dv">0</span>  <span class="co"># fraction of body in contact with substrate (fractional, 0-1)</span></span>
<span id="cb6-13"><a href="#cb6-13"></a>SAMODE &lt;-<span class="st"> </span><span class="dv">0</span>  <span class="co"># if 1, uses bird skin surface area scaling from Walsberg</span></span>
<span id="cb6-14"><a href="#cb6-14"></a><span class="co"># and King 1978. JEB Biology 76:185-189, if 2, uses mammal</span></span>
<span id="cb6-15"><a href="#cb6-15"></a><span class="co"># surface area scaling from Stahl (1967) J. of App.</span></span>
<span id="cb6-16"><a href="#cb6-16"></a><span class="co"># Physiology, 453-460.</span></span>
<span id="cb6-17"><a href="#cb6-17"></a>ORIENT &lt;-<span class="st"> </span><span class="dv">0</span>  <span class="co"># if 1, largest surface area normal to sun&#39;s ray&#39;s, if 2, largest surface parallel to sun&#39;s rays, if 0, average of normal/parallel posture</span></span>
<span id="cb6-18"><a href="#cb6-18"></a>Z &lt;-<span class="st"> </span><span class="dv">20</span>  <span class="co"># zenith angle of the sun</span></span>
<span id="cb6-19"><a href="#cb6-19"></a>ZEN &lt;-<span class="st"> </span>pi<span class="op">/</span><span class="dv">180</span> <span class="op">*</span><span class="st"> </span>Z  <span class="co"># convert degrees to radians</span></span>
<span id="cb6-20"><a href="#cb6-20"></a></span>
<span id="cb6-21"><a href="#cb6-21"></a><span class="co"># call the subroutine</span></span>
<span id="cb6-22"><a href="#cb6-22"></a>GEOM.out &lt;-<span class="st"> </span><span class="kw">GEOM_ENDO</span>(AMASS, ANDENS, FATPCT, SHAPE, ZFUR, SUBQFAT, </span>
<span id="cb6-23"><a href="#cb6-23"></a>    SHAPE_B, SHAPE_C, DHARA, RHOARA, PCOND, SAMODE, ORIENT, ZEN)</span>
<span id="cb6-24"><a href="#cb6-24"></a></span>
<span id="cb6-25"><a href="#cb6-25"></a><span class="co"># output</span></span>
<span id="cb6-26"><a href="#cb6-26"></a>VOL &lt;-<span class="st"> </span>GEOM.out[<span class="dv">1</span>]  <span class="co"># volume (m3)</span></span>
<span id="cb6-27"><a href="#cb6-27"></a>D &lt;-<span class="st"> </span>GEOM.out[<span class="dv">2</span>]  <span class="co"># characteristic dimension for convection (m)</span></span>
<span id="cb6-28"><a href="#cb6-28"></a>MASFAT &lt;-<span class="st"> </span>GEOM.out[<span class="dv">3</span>]  <span class="co"># mass body fat (kg)</span></span>
<span id="cb6-29"><a href="#cb6-29"></a>VOLFAT &lt;-<span class="st"> </span>GEOM.out[<span class="dv">4</span>]  <span class="co"># volume body fat (m3)</span></span>
<span id="cb6-30"><a href="#cb6-30"></a>ALENTH &lt;-<span class="st"> </span>GEOM.out[<span class="dv">5</span>]  <span class="co"># length (m)</span></span>
<span id="cb6-31"><a href="#cb6-31"></a>AWIDTH &lt;-<span class="st"> </span>GEOM.out[<span class="dv">6</span>]  <span class="co"># width (m)</span></span>
<span id="cb6-32"><a href="#cb6-32"></a>AHEIT &lt;-<span class="st"> </span>GEOM.out[<span class="dv">7</span>]  <span class="co"># height (m)</span></span>
<span id="cb6-33"><a href="#cb6-33"></a>ATOT &lt;-<span class="st"> </span>GEOM.out[<span class="dv">8</span>]  <span class="co"># total area at fur/feathers-air interface (m2)</span></span>
<span id="cb6-34"><a href="#cb6-34"></a>ASIL &lt;-<span class="st"> </span>GEOM.out[<span class="dv">9</span>]  <span class="co"># silhouette area to use in solar calcs (m2) may be normal, parallel</span></span>
<span id="cb6-35"><a href="#cb6-35"></a><span class="co"># or average set via ORIENT</span></span>
<span id="cb6-36"><a href="#cb6-36"></a>ASILN &lt;-<span class="st"> </span>GEOM.out[<span class="dv">10</span>]  <span class="co"># silhouette area normal to sun (m2)</span></span>
<span id="cb6-37"><a href="#cb6-37"></a>ASILP &lt;-<span class="st"> </span>GEOM.out[<span class="dv">11</span>]  <span class="co"># silhouette area parallel to sun (m2)</span></span>
<span id="cb6-38"><a href="#cb6-38"></a>GMASS &lt;-<span class="st"> </span>GEOM.out[<span class="dv">12</span>]  <span class="co"># mass (g)</span></span>
<span id="cb6-39"><a href="#cb6-39"></a>AREASKIN &lt;-<span class="st"> </span>GEOM.out[<span class="dv">13</span>]  <span class="co"># area of skin (m2)</span></span>
<span id="cb6-40"><a href="#cb6-40"></a>FLSHVL &lt;-<span class="st"> </span>GEOM.out[<span class="dv">14</span>]  <span class="co"># flesh volume (m3)</span></span>
<span id="cb6-41"><a href="#cb6-41"></a>FATTHK &lt;-<span class="st"> </span>GEOM.out[<span class="dv">15</span>]  <span class="co"># fat layer thickness (m)</span></span>
<span id="cb6-42"><a href="#cb6-42"></a>ASEMAJ &lt;-<span class="st"> </span>GEOM.out[<span class="dv">16</span>]  <span class="co"># semimajor axis length (m)</span></span>
<span id="cb6-43"><a href="#cb6-43"></a>BSEMIN &lt;-<span class="st"> </span>GEOM.out[<span class="dv">17</span>]  <span class="co"># b semiminor axis length (m)</span></span>
<span id="cb6-44"><a href="#cb6-44"></a>CSEMIN &lt;-<span class="st"> </span>GEOM.out[<span class="dv">18</span>]  <span class="co"># c semiminor axis length (m)</span></span>
<span id="cb6-45"><a href="#cb6-45"></a><span class="co"># (currently only prolate spheroid)</span></span>
<span id="cb6-46"><a href="#cb6-46"></a>CONVSK &lt;-<span class="st"> </span>GEOM.out[<span class="dv">19</span>]  <span class="co"># area of skin for evaporation (total skin area - hair area) (m2)</span></span>
<span id="cb6-47"><a href="#cb6-47"></a>CONVAR &lt;-<span class="st"> </span>GEOM.out[<span class="dv">20</span>]  <span class="co"># area for convection (total area minus ventral area in contact </span></span>
<span id="cb6-48"><a href="#cb6-48"></a><span class="co"># with the substrate, as determined by PCOND), m2</span></span>
<span id="cb6-49"><a href="#cb6-49"></a>R1 &lt;-<span class="st"> </span>GEOM.out[<span class="dv">21</span>]  <span class="co"># shape-specific core-skin radius in shortest dimension (m)</span></span>
<span id="cb6-50"><a href="#cb6-50"></a>R2 &lt;-<span class="st"> </span>GEOM.out[<span class="dv">22</span>]  <span class="co"># shape-specific core-fur radius in shortest dimension (m)</span></span>
<span id="cb6-51"><a href="#cb6-51"></a></span>
<span id="cb6-52"><a href="#cb6-52"></a>GEOM.lab &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;VOL&quot;</span>, <span class="st">&quot;D&quot;</span>, <span class="st">&quot;MASFAT&quot;</span>, <span class="st">&quot;VOLFAT&quot;</span>, <span class="st">&quot;ALENTH&quot;</span>, <span class="st">&quot;AWIDTH&quot;</span>, </span>
<span id="cb6-53"><a href="#cb6-53"></a>    <span class="st">&quot;AHEIT&quot;</span>, <span class="st">&quot;ATOT&quot;</span>, <span class="st">&quot;ASIL&quot;</span>, <span class="st">&quot;ASILN&quot;</span>, <span class="st">&quot;ASILP&quot;</span>, <span class="st">&quot;GMASS&quot;</span>, <span class="st">&quot;AREASKIN&quot;</span>, </span>
<span id="cb6-54"><a href="#cb6-54"></a>    <span class="st">&quot;FLSHVL&quot;</span>, <span class="st">&quot;FATTHK&quot;</span>, <span class="st">&quot;ASEMAJ&quot;</span>, <span class="st">&quot;BSEMIN&quot;</span>, <span class="st">&quot;CSEMIN&quot;</span>, <span class="st">&quot;CONVSK&quot;</span>, </span>
<span id="cb6-55"><a href="#cb6-55"></a>    <span class="st">&quot;CONVAR&quot;</span>, <span class="st">&quot;R1&quot;</span>, <span class="st">&quot;R2&quot;</span>)</span>
<span id="cb6-56"><a href="#cb6-56"></a><span class="kw">kable</span>(<span class="kw">cbind</span>(GEOM.lab, <span class="kw">t</span>(GEOM.out)))</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">GEOM.lab</th>
<th align="left"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">VOL</td>
<td align="left">0.01</td>
</tr>
<tr class="even">
<td align="left">D</td>
<td align="left">0.215443459147026</td>
</tr>
<tr class="odd">
<td align="left">MASFAT</td>
<td align="left">2</td>
</tr>
<tr class="even">
<td align="left">VOLFAT</td>
<td align="left">0.00221975582685905</td>
</tr>
<tr class="odd">
<td align="left">ALENTH</td>
<td align="left">0.529649771785497</td>
</tr>
<tr class="even">
<td align="left">AWIDTH</td>
<td align="left">0.196166582142777</td>
</tr>
<tr class="odd">
<td align="left">AHEIT</td>
<td align="left">0.196166582142777</td>
</tr>
<tr class="even">
<td align="left">ATOT</td>
<td align="left">0.306057341103935</td>
</tr>
<tr class="odd">
<td align="left">ASIL</td>
<td align="left">0.0640710561559047</td>
</tr>
<tr class="even">
<td align="left">ASILN</td>
<td align="left">0.0921179995701185</td>
</tr>
<tr class="odd">
<td align="left">ASILP</td>
<td align="left">0.0360241127416909</td>
</tr>
<tr class="even">
<td align="left">GMASS</td>
<td align="left">10000</td>
</tr>
<tr class="odd">
<td align="left">AREASKIN</td>
<td align="left">0.269773486865498</td>
</tr>
<tr class="even">
<td align="left">FLSHVL</td>
<td align="left">0.00778024417314096</td>
</tr>
<tr class="odd">
<td align="left">FATTHK</td>
<td align="left">0.00980642236948426</td>
</tr>
<tr class="even">
<td align="left">ASEMAJ</td>
<td align="left">0.264824885892749</td>
</tr>
<tr class="odd">
<td align="left">BSEMIN</td>
<td align="left">0.0980832910713883</td>
</tr>
<tr class="even">
<td align="left">CSEMIN</td>
<td align="left">0.0980832910713883</td>
</tr>
<tr class="odd">
<td align="left">CONVSK</td>
<td align="left">0.262885895484012</td>
</tr>
<tr class="even">
<td align="left">CONVAR</td>
<td align="left">0.306057341103935</td>
</tr>
<tr class="odd">
<td align="left">R1</td>
<td align="left">0.0980832910713883</td>
</tr>
<tr class="even">
<td align="left">R2</td>
<td align="left">0.107083291071388</td>
</tr>
</tbody>
</table>
<p>Plot of current animal configuration.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1"></a><span class="cf">if</span> (SHAPE <span class="op">==</span><span class="st"> </span><span class="dv">4</span>) {</span>
<span id="cb7-2"><a href="#cb7-2"></a>    <span class="co"># ellipsoid</span></span>
<span id="cb7-3"><a href="#cb7-3"></a>    <span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb7-4"><a href="#cb7-4"></a>    <span class="kw">plot</span>(<span class="kw">c</span>(<span class="dv">0</span>, ASEMAJ <span class="op">*</span><span class="st"> </span><span class="dv">2</span> <span class="op">+</span><span class="st"> </span>ZFUR <span class="op">*</span><span class="st"> </span><span class="dv">2</span>), <span class="kw">c</span>(<span class="dv">0</span>, ASEMAJ <span class="op">*</span><span class="st"> </span><span class="dv">2</span> <span class="op">+</span><span class="st"> </span>ZFUR <span class="op">*</span><span class="st"> </span></span>
<span id="cb7-5"><a href="#cb7-5"></a><span class="st">        </span><span class="dv">2</span>), <span class="dt">type =</span> <span class="st">&quot;n&quot;</span>, <span class="dt">main =</span> <span class="st">&quot;ellipsoid, sagittal section&quot;</span>, </span>
<span id="cb7-6"><a href="#cb7-6"></a>        <span class="dt">ylab =</span> <span class="st">&quot;minor axis, m&quot;</span>, <span class="dt">xlab =</span> <span class="st">&quot;major axis, m&quot;</span>, <span class="dt">asp =</span> <span class="dv">1</span>)</span>
<span id="cb7-7"><a href="#cb7-7"></a>    <span class="kw">draw.ellipse</span>(ASEMAJ <span class="op">+</span><span class="st"> </span>ZFUR, ASEMAJ <span class="op">+</span><span class="st"> </span>ZFUR, <span class="dt">col =</span> <span class="st">&quot;black&quot;</span>, </span>
<span id="cb7-8"><a href="#cb7-8"></a>        <span class="dt">border =</span> <span class="st">&quot;black&quot;</span>, <span class="dt">a =</span> ASEMAJ <span class="op">+</span><span class="st"> </span>ZFUR, <span class="dt">b =</span> BSEMIN <span class="op">+</span><span class="st"> </span>ZFUR)</span>
<span id="cb7-9"><a href="#cb7-9"></a>    <span class="kw">draw.ellipse</span>(ASEMAJ <span class="op">+</span><span class="st"> </span>ZFUR, ASEMAJ <span class="op">+</span><span class="st"> </span>ZFUR, <span class="dt">col =</span> <span class="st">&quot;pink&quot;</span>, </span>
<span id="cb7-10"><a href="#cb7-10"></a>        <span class="dt">border =</span> <span class="st">&quot;pink&quot;</span>, <span class="dt">a =</span> ASEMAJ, <span class="dt">b =</span> BSEMIN)</span>
<span id="cb7-11"><a href="#cb7-11"></a>    <span class="kw">draw.ellipse</span>(ASEMAJ <span class="op">+</span><span class="st"> </span>ZFUR, ASEMAJ <span class="op">+</span><span class="st"> </span>ZFUR, <span class="dt">col =</span> <span class="st">&quot;red&quot;</span>, <span class="dt">border =</span> <span class="st">&quot;red&quot;</span>, </span>
<span id="cb7-12"><a href="#cb7-12"></a>        <span class="dt">a =</span> ASEMAJ <span class="op">-</span><span class="st"> </span>FATTHK, <span class="dt">b =</span> BSEMIN <span class="op">-</span><span class="st"> </span>FATTHK)</span>
<span id="cb7-13"><a href="#cb7-13"></a></span>
<span id="cb7-14"><a href="#cb7-14"></a>    <span class="kw">plot</span>(<span class="kw">c</span>(<span class="dv">0</span>, ASEMAJ <span class="op">*</span><span class="st"> </span><span class="dv">2</span> <span class="op">+</span><span class="st"> </span>ZFUR <span class="op">*</span><span class="st"> </span><span class="dv">2</span>), <span class="kw">c</span>(<span class="dv">0</span>, ASEMAJ <span class="op">*</span><span class="st"> </span><span class="dv">2</span> <span class="op">+</span><span class="st"> </span>ZFUR <span class="op">*</span><span class="st"> </span></span>
<span id="cb7-15"><a href="#cb7-15"></a><span class="st">        </span><span class="dv">2</span>), <span class="dt">type =</span> <span class="st">&quot;n&quot;</span>, <span class="dt">main =</span> <span class="st">&quot;ellipsoid, transverse section&quot;</span>, </span>
<span id="cb7-16"><a href="#cb7-16"></a>        <span class="dt">ylab =</span> <span class="st">&quot;minor axis, m&quot;</span>, <span class="dt">xlab =</span> <span class="st">&quot;minor axis, m&quot;</span>, <span class="dt">asp =</span> <span class="dv">1</span>)</span>
<span id="cb7-17"><a href="#cb7-17"></a>    <span class="kw">draw.ellipse</span>(ASEMAJ <span class="op">+</span><span class="st"> </span>ZFUR, ASEMAJ <span class="op">+</span><span class="st"> </span>ZFUR, <span class="dt">col =</span> <span class="st">&quot;black&quot;</span>, </span>
<span id="cb7-18"><a href="#cb7-18"></a>        <span class="dt">border =</span> <span class="st">&quot;black&quot;</span>, <span class="dt">a =</span> BSEMIN <span class="op">+</span><span class="st"> </span>ZFUR, <span class="dt">b =</span> CSEMIN <span class="op">+</span><span class="st"> </span>ZFUR)</span>
<span id="cb7-19"><a href="#cb7-19"></a>    <span class="kw">draw.ellipse</span>(ASEMAJ <span class="op">+</span><span class="st"> </span>ZFUR, ASEMAJ <span class="op">+</span><span class="st"> </span>ZFUR, <span class="dt">col =</span> <span class="st">&quot;pink&quot;</span>, </span>
<span id="cb7-20"><a href="#cb7-20"></a>        <span class="dt">border =</span> <span class="st">&quot;pink&quot;</span>, <span class="dt">a =</span> BSEMIN, <span class="dt">b =</span> CSEMIN)</span>
<span id="cb7-21"><a href="#cb7-21"></a>    <span class="kw">draw.ellipse</span>(ASEMAJ <span class="op">+</span><span class="st"> </span>ZFUR, ASEMAJ <span class="op">+</span><span class="st"> </span>ZFUR, <span class="dt">col =</span> <span class="st">&quot;red&quot;</span>, <span class="dt">border =</span> <span class="st">&quot;red&quot;</span>, </span>
<span id="cb7-22"><a href="#cb7-22"></a>        <span class="dt">a =</span> BSEMIN <span class="op">-</span><span class="st"> </span>FATTHK, <span class="dt">b =</span> CSEMIN <span class="op">-</span><span class="st"> </span>FATTHK)</span>
<span id="cb7-23"><a href="#cb7-23"></a>    <span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">1</span>))</span>
<span id="cb7-24"><a href="#cb7-24"></a>}</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="solar_endo" class="section level3">
<h3>SOLAR_ENDO</h3>
<p>Compute the solar radiation absorbed by different parts of the organism and its environment.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1"></a><span class="co"># environmental variables</span></span>
<span id="cb8-2"><a href="#cb8-2"></a>QSOLR &lt;-<span class="st"> </span><span class="dv">1000</span>  <span class="co"># solar radiation, horizontal plane (W/m2)</span></span>
<span id="cb8-3"><a href="#cb8-3"></a>SHADE &lt;-<span class="st"> </span><span class="dv">0</span>  <span class="co"># shade (%, 0-100)</span></span>
<span id="cb8-4"><a href="#cb8-4"></a>Z &lt;-<span class="st"> </span><span class="dv">20</span>  <span class="co"># zenith angle of sun (degrees from overhead)</span></span>
<span id="cb8-5"><a href="#cb8-5"></a>ABSSB &lt;-<span class="st"> </span><span class="fl">0.8</span>  <span class="co"># solar absorptivity of substrate (fractional, 0-1)</span></span>
<span id="cb8-6"><a href="#cb8-6"></a></span>
<span id="cb8-7"><a href="#cb8-7"></a><span class="co"># traits</span></span>
<span id="cb8-8"><a href="#cb8-8"></a>AREA &lt;-<span class="st"> </span>ATOT  <span class="co"># surface area for solar exchange, m2 (from GEOM)</span></span>
<span id="cb8-9"><a href="#cb8-9"></a>ABSAND &lt;-<span class="st"> </span><span class="fl">0.8</span>  <span class="co"># solar absorptivity of dorsal fur (fractional, 0-1)</span></span>
<span id="cb8-10"><a href="#cb8-10"></a>ABSANV &lt;-<span class="st"> </span><span class="fl">0.8</span>  <span class="co"># solar absorptivity of ventral fur (fractional, 0-1)</span></span>
<span id="cb8-11"><a href="#cb8-11"></a>ASIL &lt;-<span class="st"> </span>ASIL  <span class="co"># silhouette area to sun, m2 (from GEOM)</span></span>
<span id="cb8-12"><a href="#cb8-12"></a>PDIF &lt;-<span class="st"> </span><span class="fl">0.15</span>  <span class="co"># proportion of solar radiation that is diffuse (fractional, 0-1)</span></span>
<span id="cb8-13"><a href="#cb8-13"></a>FASKY &lt;-<span class="st"> </span><span class="fl">0.4</span>  <span class="co"># configuration factor to sky (-)</span></span>
<span id="cb8-14"><a href="#cb8-14"></a>FAVEG &lt;-<span class="st"> </span><span class="dv">0</span>  <span class="co"># configuration factor to vegetation (-)</span></span>
<span id="cb8-15"><a href="#cb8-15"></a></span>
<span id="cb8-16"><a href="#cb8-16"></a><span class="co"># solar radiation normal to sun&#39;s rays</span></span>
<span id="cb8-17"><a href="#cb8-17"></a>ZEN &lt;-<span class="st"> </span>pi<span class="op">/</span><span class="dv">180</span> <span class="op">*</span><span class="st"> </span>Z  <span class="co"># convert degrees to radians</span></span>
<span id="cb8-18"><a href="#cb8-18"></a><span class="cf">if</span> (Z <span class="op">&lt;</span><span class="st"> </span><span class="dv">90</span>) {</span>
<span id="cb8-19"><a href="#cb8-19"></a>    <span class="co"># compute solar radiation on a surface normal to the direct</span></span>
<span id="cb8-20"><a href="#cb8-20"></a>    <span class="co"># rays of the sun</span></span>
<span id="cb8-21"><a href="#cb8-21"></a>    CZ &lt;-<span class="st"> </span><span class="kw">cos</span>(ZEN)</span>
<span id="cb8-22"><a href="#cb8-22"></a>    QNORM &lt;-<span class="st"> </span>QSOLR<span class="op">/</span>CZ</span>
<span id="cb8-23"><a href="#cb8-23"></a>} <span class="cf">else</span> {</span>
<span id="cb8-24"><a href="#cb8-24"></a>    <span class="co"># diffuse skylight only</span></span>
<span id="cb8-25"><a href="#cb8-25"></a>    QNORM &lt;-<span class="st"> </span>QSOLR</span>
<span id="cb8-26"><a href="#cb8-26"></a>}</span>
<span id="cb8-27"><a href="#cb8-27"></a></span>
<span id="cb8-28"><a href="#cb8-28"></a>SOLAR.out &lt;-<span class="st"> </span><span class="kw">SOLAR_ENDO</span>(AREA, ABSAND, ABSANV, ABSSB, ASIL, PDIF, </span>
<span id="cb8-29"><a href="#cb8-29"></a>    QNORM, SHADE, QSOLR, FASKY, FAVEG)</span>
<span id="cb8-30"><a href="#cb8-30"></a></span>
<span id="cb8-31"><a href="#cb8-31"></a>QSOLAR &lt;-<span class="st"> </span>SOLAR.out[<span class="dv">1</span>]  <span class="co"># total (global) solar radiation (W)</span></span>
<span id="cb8-32"><a href="#cb8-32"></a>QSDIR &lt;-<span class="st"> </span>SOLAR.out[<span class="dv">2</span>]  <span class="co"># direct solar radiation (W)</span></span>
<span id="cb8-33"><a href="#cb8-33"></a>QSSKY &lt;-<span class="st"> </span>SOLAR.out[<span class="dv">3</span>]  <span class="co"># diffuse solar radiation from sky (W)</span></span>
<span id="cb8-34"><a href="#cb8-34"></a>QSRSB &lt;-<span class="st"> </span>SOLAR.out[<span class="dv">4</span>]  <span class="co"># diffuse solar radiation reflected from substrate (W)</span></span>
<span id="cb8-35"><a href="#cb8-35"></a>QSDIFF &lt;-<span class="st"> </span>SOLAR.out[<span class="dv">5</span>]  <span class="co"># total diffuse solar radiation (W)</span></span>
<span id="cb8-36"><a href="#cb8-36"></a>QDORSL &lt;-<span class="st"> </span>SOLAR.out[<span class="dv">6</span>]  <span class="co"># dorsal direct solar radiation (W)</span></span>
<span id="cb8-37"><a href="#cb8-37"></a>QVENTR &lt;-<span class="st"> </span>SOLAR.out[<span class="dv">7</span>]  <span class="co"># ventral diffuse solar radiation (W)</span></span>
<span id="cb8-38"><a href="#cb8-38"></a></span>
<span id="cb8-39"><a href="#cb8-39"></a>SOLAR.lab &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;QSOLAR&quot;</span>, <span class="st">&quot;QSDIR&quot;</span>, <span class="st">&quot;QSSKY&quot;</span>, <span class="st">&quot;QSRSB&quot;</span>, <span class="st">&quot;QSDIFF&quot;</span>, </span>
<span id="cb8-40"><a href="#cb8-40"></a>    <span class="st">&quot;QDORSL&quot;</span>, <span class="st">&quot;QVENTR&quot;</span>)</span>
<span id="cb8-41"><a href="#cb8-41"></a><span class="kw">kable</span>(<span class="kw">cbind</span>(SOLAR.lab, <span class="kw">t</span>(SOLAR.out)))</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">SOLAR.lab</th>
<th align="left"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">QSOLAR</td>
<td align="left">90.436692916682</td>
</tr>
<tr class="even">
<td align="left">QSDIR</td>
<td align="left">46.3644357977154</td>
</tr>
<tr class="odd">
<td align="left">QSSKY</td>
<td align="left">14.6907523729889</td>
</tr>
<tr class="even">
<td align="left">QSRSB</td>
<td align="left">29.3815047459777</td>
</tr>
<tr class="odd">
<td align="left">QSDIFF</td>
<td align="left">44.0722571189666</td>
</tr>
<tr class="even">
<td align="left">QDORSL</td>
<td align="left">61.0551881707043</td>
</tr>
<tr class="odd">
<td align="left">QVENTR</td>
<td align="left">29.3815047459777</td>
</tr>
</tbody>
</table>
</div>
<div id="conv_endo" class="section level3">
<h3>CONV_ENDO</h3>
<p>Compute convective heat exchange.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1"></a><span class="co"># input</span></span>
<span id="cb9-2"><a href="#cb9-2"></a>TS &lt;-<span class="st"> </span><span class="dv">33</span>  <span class="co"># skin temperature (°C)</span></span>
<span id="cb9-3"><a href="#cb9-3"></a>TENV &lt;-<span class="st"> </span><span class="dv">20</span>  <span class="co"># air temperature (°C)</span></span>
<span id="cb9-4"><a href="#cb9-4"></a>TFA &lt;-<span class="st"> </span><span class="dv">10</span>  <span class="co"># fur/air interface temperature (°C)</span></span>
<span id="cb9-5"><a href="#cb9-5"></a>SHAPE &lt;-<span class="st"> </span><span class="dv">4</span>  <span class="co"># shape, 1 is cylinder, 2 is sphere, 3 is plate, 4 is ellipsoid</span></span>
<span id="cb9-6"><a href="#cb9-6"></a>SURFAR &lt;-<span class="st"> </span>CONVAR  <span class="co"># surface area for convection, m2 (from GEOM)</span></span>
<span id="cb9-7"><a href="#cb9-7"></a>FLTYPE &lt;-<span class="st"> </span><span class="dv">0</span>  <span class="co"># FLUID TYPE: 0 = AIR; 1 = FRESH WATER; 2 = SALT WATER</span></span>
<span id="cb9-8"><a href="#cb9-8"></a>FURTST &lt;-<span class="st"> </span>FURTST  <span class="co"># test of fur presence (-) from IRPROP </span></span>
<span id="cb9-9"><a href="#cb9-9"></a>VEL &lt;-<span class="st"> </span><span class="dv">1</span>  <span class="co"># wind speed (m/s)</span></span>
<span id="cb9-10"><a href="#cb9-10"></a>ELEV &lt;-<span class="st"> </span><span class="dv">0</span>  <span class="co"># elevation (m)</span></span>
<span id="cb9-11"><a href="#cb9-11"></a>BP &lt;-<span class="st"> </span><span class="dv">-1</span>  <span class="co"># barometric pressure (Pa), negative means altitude is used</span></span>
<span id="cb9-12"><a href="#cb9-12"></a></span>
<span id="cb9-13"><a href="#cb9-13"></a><span class="co"># run subroutine</span></span>
<span id="cb9-14"><a href="#cb9-14"></a>CONV.out &lt;-<span class="st"> </span><span class="kw">CONV_ENDO</span>(TS, TENV, SHAPE, SURFAR, FLTYPE, FURTST, </span>
<span id="cb9-15"><a href="#cb9-15"></a>    D, TFA, VEL, ZFUR, BP, ELEV)</span>
<span id="cb9-16"><a href="#cb9-16"></a></span>
<span id="cb9-17"><a href="#cb9-17"></a>QCONV &lt;-<span class="st"> </span>CONV.out[<span class="dv">1</span>]  <span class="co"># convective heat loss (W)</span></span>
<span id="cb9-18"><a href="#cb9-18"></a>HC &lt;-<span class="st"> </span>CONV.out[<span class="dv">2</span>]  <span class="co"># combined convection coefficient (W/m2 C)</span></span>
<span id="cb9-19"><a href="#cb9-19"></a>HCFREE &lt;-<span class="st"> </span>CONV.out[<span class="dv">3</span>]  <span class="co"># free convection coefficient (W/m2 C)</span></span>
<span id="cb9-20"><a href="#cb9-20"></a>HCFOR &lt;-<span class="st"> </span>CONV.out[<span class="dv">4</span>]  <span class="co"># forced convection coefficient (W/m2 C)</span></span>
<span id="cb9-21"><a href="#cb9-21"></a>HD &lt;-<span class="st"> </span>CONV.out[<span class="dv">5</span>]  <span class="co"># mass transfer coefficient (kg/m2 s)</span></span>
<span id="cb9-22"><a href="#cb9-22"></a>HDFREE &lt;-<span class="st"> </span>CONV.out[<span class="dv">6</span>]  <span class="co"># free mass transfer coefficient (kg/m2 s)</span></span>
<span id="cb9-23"><a href="#cb9-23"></a>HDFORC &lt;-<span class="st"> </span>CONV.out[<span class="dv">7</span>]  <span class="co"># forced mass transfer coefficient (kg/m2 s)</span></span>
<span id="cb9-24"><a href="#cb9-24"></a>ANU &lt;-<span class="st"> </span>CONV.out[<span class="dv">8</span>]  <span class="co"># Nusselt number (-)</span></span>
<span id="cb9-25"><a href="#cb9-25"></a>RE &lt;-<span class="st"> </span>CONV.out[<span class="dv">9</span>]  <span class="co"># Reynold&#39;s number (-)</span></span>
<span id="cb9-26"><a href="#cb9-26"></a>GR &lt;-<span class="st"> </span>CONV.out[<span class="dv">10</span>]  <span class="co"># Grasshof number (-)</span></span>
<span id="cb9-27"><a href="#cb9-27"></a>PR &lt;-<span class="st"> </span>CONV.out[<span class="dv">11</span>]  <span class="co"># Prandtl number (-)</span></span>
<span id="cb9-28"><a href="#cb9-28"></a>RA &lt;-<span class="st"> </span>CONV.out[<span class="dv">12</span>]  <span class="co"># Rayleigh number (-)</span></span>
<span id="cb9-29"><a href="#cb9-29"></a>SC &lt;-<span class="st"> </span>CONV.out[<span class="dv">13</span>]  <span class="co"># Schmidt number (-)</span></span>
<span id="cb9-30"><a href="#cb9-30"></a>BP &lt;-<span class="st"> </span>CONV.out[<span class="dv">14</span>]  <span class="co"># barometric pressure (Pa)</span></span>
<span id="cb9-31"><a href="#cb9-31"></a></span>
<span id="cb9-32"><a href="#cb9-32"></a>CONV.lab &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;QCONV&quot;</span>, <span class="st">&quot;HC&quot;</span>, <span class="st">&quot;HCFREE&quot;</span>, <span class="st">&quot;HCFOR&quot;</span>, <span class="st">&quot;HD&quot;</span>, <span class="st">&quot;HDFREE&quot;</span>, </span>
<span id="cb9-33"><a href="#cb9-33"></a>    <span class="st">&quot;HDFORC&quot;</span>, <span class="st">&quot;ANU&quot;</span>, <span class="st">&quot;RE&quot;</span>, <span class="st">&quot;GR&quot;</span>, <span class="st">&quot;PR&quot;</span>, <span class="st">&quot;RA&quot;</span>, <span class="st">&quot;SC&quot;</span>, <span class="st">&quot;BP&quot;</span>)</span>
<span id="cb9-34"><a href="#cb9-34"></a><span class="kw">kable</span>(<span class="kw">cbind</span>(CONV.lab, <span class="kw">t</span>(CONV.out)))</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">CONV.lab</th>
<th align="left"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">QCONV</td>
<td align="left">-42.3303697396045</td>
</tr>
<tr class="even">
<td align="left">HC</td>
<td align="left">13.8308624086326</td>
</tr>
<tr class="odd">
<td align="left">HCFREE</td>
<td align="left">4.18906008479261</td>
</tr>
<tr class="even">
<td align="left">HCFOR</td>
<td align="left">0</td>
</tr>
<tr class="odd">
<td align="left">HD</td>
<td align="left">0.0166500419458664</td>
</tr>
<tr class="even">
<td align="left">HDFREE</td>
<td align="left">0.00389858046772071</td>
</tr>
<tr class="odd">
<td align="left">HDFORC</td>
<td align="left">0.0127514614781457</td>
</tr>
<tr class="even">
<td align="left">ANU</td>
<td align="left">115.050184709447</td>
</tr>
<tr class="odd">
<td align="left">RE</td>
<td align="left">14271.7036555494</td>
</tr>
<tr class="even">
<td align="left">GR</td>
<td align="left">14679651.4926261</td>
</tr>
<tr class="odd">
<td align="left">PR</td>
<td align="left">0.712515300549836</td>
</tr>
<tr class="even">
<td align="left">RA</td>
<td align="left">10459476.2952353</td>
</tr>
<tr class="odd">
<td align="left">SC</td>
<td align="left">0.595551257906283</td>
</tr>
<tr class="even">
<td align="left">BP</td>
<td align="left">101325</td>
</tr>
</tbody>
</table>
</div>
<div id="sevap_endo" class="section level3">
<h3>SEVAP_ENDO</h3>
<p>Compute evaporative heat exchange.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1"></a>BP &lt;-<span class="st"> </span>BP  <span class="co"># barometric pressure (Pa) (from CONV)</span></span>
<span id="cb10-2"><a href="#cb10-2"></a>TA &lt;-<span class="st"> </span><span class="dv">20</span>  <span class="co"># air temperature (°C)</span></span>
<span id="cb10-3"><a href="#cb10-3"></a>RELHUM &lt;-<span class="st"> </span><span class="dv">20</span>  <span class="co"># relative humidity (%)</span></span>
<span id="cb10-4"><a href="#cb10-4"></a>TC &lt;-<span class="st"> </span><span class="dv">37</span>  <span class="co"># core temperature (°C)</span></span>
<span id="cb10-5"><a href="#cb10-5"></a>TSKIN &lt;-<span class="st"> </span><span class="dv">33</span>  <span class="co"># skin temperature (°C)</span></span>
<span id="cb10-6"><a href="#cb10-6"></a>PCTWET &lt;-<span class="st"> </span><span class="dv">11</span>  <span class="co"># part of the skin surface that is wet (%)</span></span>
<span id="cb10-7"><a href="#cb10-7"></a>FLYHR &lt;-<span class="st"> </span><span class="dv">0</span>  <span class="co"># is flight occurring this hour? (imposes forced evaporative loss)</span></span>
<span id="cb10-8"><a href="#cb10-8"></a>BAREVAP &lt;-<span class="st"> </span><span class="dv">0</span>  <span class="co"># is evaporation partly from bare skin? (0 = no, 1 = yes, % defined with PCTBAREVAP)</span></span>
<span id="cb10-9"><a href="#cb10-9"></a>PCTBAREVAP &lt;-<span class="st"> </span><span class="dv">0</span>  <span class="co"># surface area for evaporation that is skin, e.g. licking paws (%)</span></span>
<span id="cb10-10"><a href="#cb10-10"></a>PCTEYES &lt;-<span class="st"> </span><span class="fl">0.03</span>  <span class="co"># surface area made up by the eye (%) - make zero if sleeping</span></span>
<span id="cb10-11"><a href="#cb10-11"></a>ZFUR &lt;-<span class="st"> </span>ZFUR  <span class="co"># fur depth (m)</span></span>
<span id="cb10-12"><a href="#cb10-12"></a>FURWET &lt;-<span class="st"> </span><span class="dv">0</span>  <span class="co"># part of the fur surface that is wet (%)</span></span>
<span id="cb10-13"><a href="#cb10-13"></a></span>
<span id="cb10-14"><a href="#cb10-14"></a>SEVAP.out &lt;-<span class="st"> </span><span class="kw">SEVAP_ENDO</span>(BP, TA, RELHUM, VEL, TC, TSKIN, ELEV, </span>
<span id="cb10-15"><a href="#cb10-15"></a>    PCTWET, FLYHR, CONVSK, HD, HDFREE, PCTBAREVAP, PCTEYES, ZFUR, </span>
<span id="cb10-16"><a href="#cb10-16"></a>    FURWET, TFA, CONVAR)</span>
<span id="cb10-17"><a href="#cb10-17"></a></span>
<span id="cb10-18"><a href="#cb10-18"></a>QSEVAP &lt;-<span class="st"> </span>SEVAP.out[<span class="dv">1</span>]  <span class="co"># skin evaporative heat loss (W)</span></span>
<span id="cb10-19"><a href="#cb10-19"></a>WEYES &lt;-<span class="st"> </span>SEVAP.out[<span class="dv">2</span>]  <span class="co"># ocular evaporation (kg/s)</span></span>
<span id="cb10-20"><a href="#cb10-20"></a>WCUTHF &lt;-<span class="st"> </span>SEVAP.out[<span class="dv">3</span>]  <span class="co"># forced cutaneous evaporation (kg/s)</span></span>
<span id="cb10-21"><a href="#cb10-21"></a>WCUTF &lt;-<span class="st"> </span>SEVAP.out[<span class="dv">4</span>]  <span class="co"># free cutaneous evaporation (kg/s)</span></span>
<span id="cb10-22"><a href="#cb10-22"></a>WCUT &lt;-<span class="st"> </span>SEVAP.out[<span class="dv">5</span>]  <span class="co"># total cutaneous evaporation (kg/s)</span></span>
<span id="cb10-23"><a href="#cb10-23"></a>WTFUR &lt;-<span class="st"> </span>SEVAP.out[<span class="dv">6</span>]  <span class="co"># total fur evaporation (kg/s)</span></span>
<span id="cb10-24"><a href="#cb10-24"></a>QFSEVAP &lt;-<span class="st"> </span>SEVAP.out[<span class="dv">7</span>]  <span class="co"># fur evaporative heat loss (W))</span></span>
<span id="cb10-25"><a href="#cb10-25"></a></span>
<span id="cb10-26"><a href="#cb10-26"></a>SEVAP.lab &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;QSEVAP&quot;</span>, <span class="st">&quot;WEYES&quot;</span>, <span class="st">&quot;WCUTHF&quot;</span>, <span class="st">&quot;WCUTF&quot;</span>, <span class="st">&quot;WCUT&quot;</span>, </span>
<span id="cb10-27"><a href="#cb10-27"></a>    <span class="st">&quot;WTFUR&quot;</span>, <span class="st">&quot;QFSEVAP&quot;</span>)</span>
<span id="cb10-28"><a href="#cb10-28"></a><span class="kw">kable</span>(<span class="kw">cbind</span>(SEVAP.lab, <span class="kw">t</span>(SEVAP.out)))</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">SEVAP.lab</th>
<th align="left"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">QSEVAP</td>
<td align="left">9.01497449278671</td>
</tr>
<tr class="even">
<td align="left">WEYES</td>
<td align="left">4.23023290455338e-08</td>
</tr>
<tr class="odd">
<td align="left">WCUTHF</td>
<td align="left">0</td>
</tr>
<tr class="even">
<td align="left">WCUTF</td>
<td align="left">3.63184136245377e-06</td>
</tr>
<tr class="odd">
<td align="left">WCUT</td>
<td align="left">3.63184136245377e-06</td>
</tr>
<tr class="even">
<td align="left">WTFUR</td>
<td align="left">0</td>
</tr>
<tr class="odd">
<td align="left">QFSEVAP</td>
<td align="left">0</td>
</tr>
</tbody>
</table>
</div>
<div id="simulsol" class="section level3">
<h3>SIMULSOL</h3>
<p>Setup and the SIMULSOL algorithm to SIMULtaneously SOLve for skin temperature <span class="math inline">\(T_s\)</span> and the temperature of the fur/feather interface <span class="math inline">\(T_fa\)</span> given an environment, shape/posture and skin wetness. SIMULSOL is the core algorithm for computing the heat balance.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1"></a><span class="co"># environment</span></span>
<span id="cb11-2"><a href="#cb11-2"></a>FLTYPE &lt;-<span class="st"> </span><span class="dv">0</span>  <span class="co"># fluid type: 0 = air; 1 = fresh water; 2 = salt water</span></span>
<span id="cb11-3"><a href="#cb11-3"></a>TAREF &lt;-<span class="st"> </span>TA  <span class="co"># reference air temperature (e.g. at 1.2 or 2m) (°C)</span></span>
<span id="cb11-4"><a href="#cb11-4"></a>TLOWER &lt;-<span class="st"> </span>TA  <span class="co"># ground temperature (°C)</span></span>
<span id="cb11-5"><a href="#cb11-5"></a>TSKY &lt;-<span class="st"> </span>TA  <span class="co"># sky temperature (°C)</span></span>
<span id="cb11-6"><a href="#cb11-6"></a>TCONDSB &lt;-<span class="st"> </span>TA  <span class="co"># surface temperature for conduction (°C)</span></span>
<span id="cb11-7"><a href="#cb11-7"></a>TBUSH &lt;-<span class="st"> </span>TA  <span class="co"># bush temperature (°C)</span></span>
<span id="cb11-8"><a href="#cb11-8"></a>TVEG &lt;-<span class="st"> </span>TAREF  <span class="co"># assume vegetation casting shade is at reference (e.g. 1.2m or 2m) air temperature (°C)</span></span>
<span id="cb11-9"><a href="#cb11-9"></a>RH &lt;-<span class="st"> </span><span class="dv">20</span>  <span class="co"># relative humidity (%)</span></span>
<span id="cb11-10"><a href="#cb11-10"></a>VEL &lt;-<span class="st"> </span><span class="dv">1</span>  <span class="co"># wind speed (m/s)</span></span>
<span id="cb11-11"><a href="#cb11-11"></a>BP &lt;-<span class="st"> </span>BP  <span class="co"># barometric pressure (Pa), negative means altitude is used (from CONV)</span></span>
<span id="cb11-12"><a href="#cb11-12"></a>ELEV &lt;-<span class="st"> </span><span class="dv">0</span>  <span class="co"># elevation (m)</span></span>
<span id="cb11-13"><a href="#cb11-13"></a>KSUB &lt;-<span class="st"> </span><span class="fl">2.79</span>  <span class="co"># substrate thermal conductivity (W/m°C)</span></span>
<span id="cb11-14"><a href="#cb11-14"></a></span>
<span id="cb11-15"><a href="#cb11-15"></a><span class="co"># physiology and morphology</span></span>
<span id="cb11-16"><a href="#cb11-16"></a>PCTWET &lt;-<span class="st"> </span><span class="dv">0</span>  <span class="co"># part of the skin surface that is wet (%)</span></span>
<span id="cb11-17"><a href="#cb11-17"></a>AK1 &lt;-<span class="st"> </span><span class="fl">0.9</span>  <span class="co"># initial thermal conductivity of flesh (0.412 - 2.8 W/mK)</span></span>
<span id="cb11-18"><a href="#cb11-18"></a>AK2 &lt;-<span class="st"> </span><span class="fl">0.23</span>  <span class="co"># conductivity of fat (W/mK)</span></span>
<span id="cb11-19"><a href="#cb11-19"></a>XR &lt;-<span class="st"> </span><span class="dv">1</span>  <span class="co"># fractional depth of fur at which longwave radiation is exchanged (0-1)</span></span>
<span id="cb11-20"><a href="#cb11-20"></a>EMISAN &lt;-<span class="st"> </span><span class="fl">0.99</span>  <span class="co"># animal emissivity (-)</span></span>
<span id="cb11-21"><a href="#cb11-21"></a>BAREVAP &lt;-<span class="st"> </span><span class="dv">0</span>  <span class="co"># is evaporation partly from bare skin? (0 = no, 1 = yes, % defined with PCTBAREVAP)</span></span>
<span id="cb11-22"><a href="#cb11-22"></a>PCTBAREVAP &lt;-<span class="st"> </span><span class="dv">0</span>  <span class="co"># surface area for evaporation that is skin, e.g. licking paws (%)</span></span>
<span id="cb11-23"><a href="#cb11-23"></a>PCTEYES &lt;-<span class="st"> </span><span class="fl">0.03</span>  <span class="co"># surface area made up by the eye (%) - make zero if sleeping</span></span>
<span id="cb11-24"><a href="#cb11-24"></a><span class="co"># behaviour</span></span>
<span id="cb11-25"><a href="#cb11-25"></a>FLYHR &lt;-<span class="st"> </span><span class="dv">0</span>  <span class="co"># is flight occurring this hour? (imposes forced evaporative loss)</span></span>
<span id="cb11-26"><a href="#cb11-26"></a></span>
<span id="cb11-27"><a href="#cb11-27"></a><span class="co"># configuration factors</span></span>
<span id="cb11-28"><a href="#cb11-28"></a>FAGRD &lt;-<span class="st"> </span><span class="fl">0.5</span>  <span class="co"># configuration factor to ground (-)</span></span>
<span id="cb11-29"><a href="#cb11-29"></a>FASKY &lt;-<span class="st"> </span><span class="fl">0.5</span>  <span class="co"># configuration factor to sky (-)</span></span>
<span id="cb11-30"><a href="#cb11-30"></a>FAVEG &lt;-<span class="st"> </span><span class="dv">0</span>  <span class="co"># this is for overhead veg (at TAREF) (-)</span></span>
<span id="cb11-31"><a href="#cb11-31"></a>FABUSH &lt;-<span class="st"> </span><span class="dv">0</span>  <span class="co"># this is for veg below/around animal (at TALOC) (-)</span></span>
<span id="cb11-32"><a href="#cb11-32"></a></span>
<span id="cb11-33"><a href="#cb11-33"></a><span class="co"># reference configuration factors</span></span>
<span id="cb11-34"><a href="#cb11-34"></a>FABUSHREF &lt;-<span class="st"> </span>FABUSH  <span class="co"># nearby bush (-)</span></span>
<span id="cb11-35"><a href="#cb11-35"></a>FASKYREF &lt;-<span class="st"> </span>FASKY  <span class="co"># sky (-)</span></span>
<span id="cb11-36"><a href="#cb11-36"></a>FAGRDREF &lt;-<span class="st"> </span>FAGRD  <span class="co"># ground (-)</span></span>
<span id="cb11-37"><a href="#cb11-37"></a>FAVEGREF &lt;-<span class="st"> </span>FAVEG  <span class="co"># vegetation (-)</span></span>
<span id="cb11-38"><a href="#cb11-38"></a></span>
<span id="cb11-39"><a href="#cb11-39"></a>FURTHRMK &lt;-<span class="st"> </span><span class="dv">0</span>  <span class="co"># user-specified fur thermal conductivity (W/m C), not used if 0</span></span>
<span id="cb11-40"><a href="#cb11-40"></a>SHAPE &lt;-<span class="st"> </span><span class="dv">4</span>  <span class="co"># shape, 1 is cylinder, 2 is sphere, 3 is plate, 4 is ellipsoid</span></span>
<span id="cb11-41"><a href="#cb11-41"></a></span>
<span id="cb11-42"><a href="#cb11-42"></a><span class="co"># Initial values</span></span>
<span id="cb11-43"><a href="#cb11-43"></a>TS &lt;-<span class="st"> </span>TC  <span class="co"># current guess of skin temperature (deg C)</span></span>
<span id="cb11-44"><a href="#cb11-44"></a>TFA &lt;-<span class="st"> </span>TA  <span class="co"># current guess of fur/air interface temperature (deg C)</span></span>
<span id="cb11-45"><a href="#cb11-45"></a></span>
<span id="cb11-46"><a href="#cb11-46"></a>DIFTOL &lt;-<span class="st"> </span><span class="fl">0.001</span>  <span class="co"># tolerance for SIMULSOL</span></span>
<span id="cb11-47"><a href="#cb11-47"></a></span>
<span id="cb11-48"><a href="#cb11-48"></a><span class="co"># vector to hold the SIMULSOL results for dorsal and ventral</span></span>
<span id="cb11-49"><a href="#cb11-49"></a><span class="co"># side</span></span>
<span id="cb11-50"><a href="#cb11-50"></a>SIMULSOL.out &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dt">data =</span> <span class="dv">0</span>, <span class="dt">nrow =</span> <span class="dv">2</span>, <span class="dt">ncol =</span> <span class="dv">15</span>)</span>
<span id="cb11-51"><a href="#cb11-51"></a></span>
<span id="cb11-52"><a href="#cb11-52"></a><span class="co"># repeat for each side, dorsal and ventral, of the animal</span></span>
<span id="cb11-53"><a href="#cb11-53"></a><span class="cf">for</span> (S <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">2</span>) {</span>
<span id="cb11-54"><a href="#cb11-54"></a></span>
<span id="cb11-55"><a href="#cb11-55"></a>    <span class="co"># Calculating solar intensity entering fur. This will depend</span></span>
<span id="cb11-56"><a href="#cb11-56"></a>    <span class="co"># on whether we are calculating the fur temperature for the</span></span>
<span id="cb11-57"><a href="#cb11-57"></a>    <span class="co"># dorsal side or the ventral side. The dorsal side will have</span></span>
<span id="cb11-58"><a href="#cb11-58"></a>    <span class="co"># solar inputs from the direct beam hitting the silhouette</span></span>
<span id="cb11-59"><a href="#cb11-59"></a>    <span class="co"># area as well as diffuse solar scattered from the sky. The</span></span>
<span id="cb11-60"><a href="#cb11-60"></a>    <span class="co"># ventral side will have diffuse solar scattered off the</span></span>
<span id="cb11-61"><a href="#cb11-61"></a>    <span class="co"># substrate.</span></span>
<span id="cb11-62"><a href="#cb11-62"></a></span>
<span id="cb11-63"><a href="#cb11-63"></a>    <span class="co"># Setting config factors and solar depending on whether the</span></span>
<span id="cb11-64"><a href="#cb11-64"></a>    <span class="co"># dorsal side (S=1) or ventral side (S=2) is being estimated.</span></span>
<span id="cb11-65"><a href="#cb11-65"></a></span>
<span id="cb11-66"><a href="#cb11-66"></a>    <span class="cf">if</span> (QSOLAR <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span>) {</span>
<span id="cb11-67"><a href="#cb11-67"></a>        <span class="cf">if</span> (S <span class="op">==</span><span class="st"> </span><span class="dv">1</span>) {</span>
<span id="cb11-68"><a href="#cb11-68"></a>            <span class="co"># proportion of upward view that is sky</span></span>
<span id="cb11-69"><a href="#cb11-69"></a>            FASKY &lt;-<span class="st"> </span>FASKYREF<span class="op">/</span>(FASKYREF <span class="op">+</span><span class="st"> </span>FAVEGREF)</span>
<span id="cb11-70"><a href="#cb11-70"></a>            <span class="co"># proportion of upward view that is vegetation (shade)</span></span>
<span id="cb11-71"><a href="#cb11-71"></a>            FAVEG &lt;-<span class="st"> </span>FAVEGREF<span class="op">/</span>(FASKYREF <span class="op">+</span><span class="st"> </span>FAVEGREF)</span>
<span id="cb11-72"><a href="#cb11-72"></a>            FAGRD &lt;-<span class="st"> </span><span class="dv">0</span></span>
<span id="cb11-73"><a href="#cb11-73"></a>            FABUSH &lt;-<span class="st"> </span><span class="dv">0</span></span>
<span id="cb11-74"><a href="#cb11-74"></a>            QSLR &lt;-<span class="st"> </span><span class="dv">2</span> <span class="op">*</span><span class="st"> </span>QSDIR <span class="op">+</span><span class="st"> </span>((QSSKY<span class="op">/</span>FASKYREF) <span class="op">*</span><span class="st"> </span>FASKY)  <span class="co"># direct x 2</span></span>
<span id="cb11-75"><a href="#cb11-75"></a>            <span class="co"># because assuming sun in both directions, and un-adjusting</span></span>
<span id="cb11-76"><a href="#cb11-76"></a>            <span class="co"># QSSKY for config factor imposed in SOLAR_ENDO and back to</span></span>
<span id="cb11-77"><a href="#cb11-77"></a>            <span class="co"># new larger one in both directions doing ventral side</span></span>
<span id="cb11-78"><a href="#cb11-78"></a>        } <span class="cf">else</span> {</span>
<span id="cb11-79"><a href="#cb11-79"></a>            FASKY &lt;-<span class="st"> </span><span class="dv">0</span></span>
<span id="cb11-80"><a href="#cb11-80"></a>            FAVEG &lt;-<span class="st"> </span><span class="dv">0</span></span>
<span id="cb11-81"><a href="#cb11-81"></a>            FAGRD &lt;-<span class="st"> </span>FAGRDREF<span class="op">/</span>(FAGRDREF <span class="op">+</span><span class="st"> </span>FABUSHREF)</span>
<span id="cb11-82"><a href="#cb11-82"></a>            FABUSH &lt;-<span class="st"> </span>FABUSHREF<span class="op">/</span>(FAGRDREF <span class="op">+</span><span class="st"> </span>FABUSHREF)</span>
<span id="cb11-83"><a href="#cb11-83"></a>            QSLR &lt;-<span class="st"> </span>(QVENTR<span class="op">/</span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span>FASKYREF <span class="op">-</span><span class="st"> </span>FAVEGREF)) <span class="op">*</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span></span>
<span id="cb11-84"><a href="#cb11-84"></a><span class="st">                </span>(<span class="dv">2</span> <span class="op">*</span><span class="st"> </span>PCOND))  <span class="co"># un-adjust by </span></span>
<span id="cb11-85"><a href="#cb11-85"></a>            <span class="co"># config factor imposed in SOLAR_ENDO to have it coming in</span></span>
<span id="cb11-86"><a href="#cb11-86"></a>            <span class="co"># both directions, but also cutting down according to</span></span>
<span id="cb11-87"><a href="#cb11-87"></a>            <span class="co"># fractional area conducting to ground (in both directions)</span></span>
<span id="cb11-88"><a href="#cb11-88"></a>        }</span>
<span id="cb11-89"><a href="#cb11-89"></a>    } <span class="cf">else</span> {</span>
<span id="cb11-90"><a href="#cb11-90"></a>        QSLR &lt;-<span class="st"> </span><span class="dv">0</span></span>
<span id="cb11-91"><a href="#cb11-91"></a>        <span class="cf">if</span> (S <span class="op">==</span><span class="st"> </span><span class="dv">1</span>) {</span>
<span id="cb11-92"><a href="#cb11-92"></a>            FASKY &lt;-<span class="st"> </span>FASKYREF<span class="op">/</span>(FASKYREF <span class="op">+</span><span class="st"> </span>FAVEGREF)</span>
<span id="cb11-93"><a href="#cb11-93"></a>            FAVEG &lt;-<span class="st"> </span>FAVEGREF<span class="op">/</span>(FASKYREF <span class="op">+</span><span class="st"> </span>FAVEGREF)</span>
<span id="cb11-94"><a href="#cb11-94"></a>            FAGRD &lt;-<span class="st"> </span><span class="dv">0</span></span>
<span id="cb11-95"><a href="#cb11-95"></a>            FABUSH &lt;-<span class="st"> </span><span class="dv">0</span></span>
<span id="cb11-96"><a href="#cb11-96"></a>        } <span class="cf">else</span> {</span>
<span id="cb11-97"><a href="#cb11-97"></a>            FASKY &lt;-<span class="st"> </span><span class="dv">0</span></span>
<span id="cb11-98"><a href="#cb11-98"></a>            FAVEG &lt;-<span class="st"> </span><span class="dv">0</span></span>
<span id="cb11-99"><a href="#cb11-99"></a>            FAGRD &lt;-<span class="st"> </span>FAGRDREF<span class="op">/</span>(FAGRDREF <span class="op">+</span><span class="st"> </span>FABUSHREF)</span>
<span id="cb11-100"><a href="#cb11-100"></a>            FABUSH &lt;-<span class="st"> </span>FABUSHREF<span class="op">/</span>(FAGRDREF <span class="op">+</span><span class="st"> </span>FABUSHREF)</span>
<span id="cb11-101"><a href="#cb11-101"></a>        }</span>
<span id="cb11-102"><a href="#cb11-102"></a>    }</span>
<span id="cb11-103"><a href="#cb11-103"></a></span>
<span id="cb11-104"><a href="#cb11-104"></a>    <span class="co"># set fur depth and conductivity index for KEFARA, the</span></span>
<span id="cb11-105"><a href="#cb11-105"></a>    <span class="co"># conductivity, is the average (1), front/dorsal (2),</span></span>
<span id="cb11-106"><a href="#cb11-106"></a>    <span class="co"># back/ventral(3) of the body part</span></span>
<span id="cb11-107"><a href="#cb11-107"></a>    <span class="cf">if</span> (QSOLR <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span> <span class="op">|</span><span class="st"> </span>ZZFUR[<span class="dv">2</span>] <span class="op">!=</span><span class="st"> </span>ZZFUR[<span class="dv">3</span>]) {</span>
<span id="cb11-108"><a href="#cb11-108"></a>        <span class="cf">if</span> (S <span class="op">==</span><span class="st"> </span><span class="dv">1</span>) {</span>
<span id="cb11-109"><a href="#cb11-109"></a>            ZL &lt;-<span class="st"> </span>ZZFUR[<span class="dv">2</span>]</span>
<span id="cb11-110"><a href="#cb11-110"></a>            KEFF &lt;-<span class="st"> </span>KEFARA[<span class="dv">2</span>]</span>
<span id="cb11-111"><a href="#cb11-111"></a>        } <span class="cf">else</span> {</span>
<span id="cb11-112"><a href="#cb11-112"></a>            ZL &lt;-<span class="st"> </span>ZZFUR[<span class="dv">3</span>]</span>
<span id="cb11-113"><a href="#cb11-113"></a>            KEFF &lt;-<span class="st"> </span>KEFARA[<span class="dv">3</span>]</span>
<span id="cb11-114"><a href="#cb11-114"></a>        }</span>
<span id="cb11-115"><a href="#cb11-115"></a>    } <span class="cf">else</span> {</span>
<span id="cb11-116"><a href="#cb11-116"></a>        ZL &lt;-<span class="st"> </span>ZZFUR[<span class="dv">1</span>]</span>
<span id="cb11-117"><a href="#cb11-117"></a>        KEFF &lt;-<span class="st"> </span>KEFARA[<span class="dv">1</span>]</span>
<span id="cb11-118"><a href="#cb11-118"></a>    }</span>
<span id="cb11-119"><a href="#cb11-119"></a></span>
<span id="cb11-120"><a href="#cb11-120"></a>    RSKIN &lt;-<span class="st"> </span>R1  <span class="co"># body radius (including fat), m</span></span>
<span id="cb11-121"><a href="#cb11-121"></a>    RFLESH &lt;-<span class="st"> </span>R1 <span class="op">-</span><span class="st"> </span>FATTHK  <span class="co"># body radius flesh only (no fat), m</span></span>
<span id="cb11-122"><a href="#cb11-122"></a>    RFUR &lt;-<span class="st"> </span>R1 <span class="op">+</span><span class="st"> </span>ZL  <span class="co"># body radius including fur, m</span></span>
<span id="cb11-123"><a href="#cb11-123"></a>    D &lt;-<span class="st"> </span><span class="dv">2</span> <span class="op">*</span><span class="st"> </span>RFUR  <span class="co"># diameter, m</span></span>
<span id="cb11-124"><a href="#cb11-124"></a>    RRAD &lt;-<span class="st"> </span>RSKIN <span class="op">+</span><span class="st"> </span>(XR <span class="op">*</span><span class="st"> </span>ZL)  <span class="co"># effective radiation radius, m</span></span>
<span id="cb11-125"><a href="#cb11-125"></a>    LEN &lt;-<span class="st"> </span>ALENTH  <span class="co"># length, m</span></span>
<span id="cb11-126"><a href="#cb11-126"></a></span>
<span id="cb11-127"><a href="#cb11-127"></a>    <span class="cf">if</span> (SHAPE <span class="op">!=</span><span class="st"> </span><span class="dv">4</span>) {</span>
<span id="cb11-128"><a href="#cb11-128"></a>        <span class="co"># ! For cylinder and sphere geometries</span></span>
<span id="cb11-129"><a href="#cb11-129"></a>        RFURCMP &lt;-<span class="st"> </span>RSKIN <span class="op">+</span><span class="st"> </span>ZFURCOMP</span>
<span id="cb11-130"><a href="#cb11-130"></a>    } <span class="cf">else</span> {</span>
<span id="cb11-131"><a href="#cb11-131"></a>        RFURCMP &lt;-<span class="st"> </span>RFUR  <span class="co">#! Note that this value is never used if conduction not being modeled,</span></span>
<span id="cb11-132"><a href="#cb11-132"></a>        <span class="co"># but need to have a value for the calculations</span></span>
<span id="cb11-133"><a href="#cb11-133"></a>    }</span>
<span id="cb11-134"><a href="#cb11-134"></a></span>
<span id="cb11-135"><a href="#cb11-135"></a>    <span class="cf">if</span> (SHAPE <span class="op">==</span><span class="st"> </span><span class="dv">4</span>) {</span>
<span id="cb11-136"><a href="#cb11-136"></a>        <span class="co"># ! For ellipsoid geometry</span></span>
<span id="cb11-137"><a href="#cb11-137"></a>        BLCMP &lt;-<span class="st"> </span>BSEMIN <span class="op">+</span><span class="st"> </span>ZFURCOMP</span>
<span id="cb11-138"><a href="#cb11-138"></a>    } <span class="cf">else</span> {</span>
<span id="cb11-139"><a href="#cb11-139"></a>        BLCMP &lt;-<span class="st"> </span>RFUR  <span class="co">#! Note that this value is never used if conduction not being modeled, </span></span>
<span id="cb11-140"><a href="#cb11-140"></a>        <span class="co"># but need to have a value for the calculations</span></span>
<span id="cb11-141"><a href="#cb11-141"></a>    }</span>
<span id="cb11-142"><a href="#cb11-142"></a></span>
<span id="cb11-143"><a href="#cb11-143"></a>    <span class="co"># Correcting volume to account for subcutaneous fat</span></span>
<span id="cb11-144"><a href="#cb11-144"></a>    <span class="cf">if</span> (SUBQFAT <span class="op">==</span><span class="st"> </span><span class="dv">1</span> <span class="op">&amp;</span><span class="st"> </span>FATTHK <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span>) {</span>
<span id="cb11-145"><a href="#cb11-145"></a>        VOL &lt;-<span class="st"> </span>FLSHVL</span>
<span id="cb11-146"><a href="#cb11-146"></a>    }</span>
<span id="cb11-147"><a href="#cb11-147"></a></span>
<span id="cb11-148"><a href="#cb11-148"></a>    <span class="co"># Calculating the &#39;Cd&#39; variable: Qcond = Cd(Tskin-Tsub),</span></span>
<span id="cb11-149"><a href="#cb11-149"></a>    <span class="co"># where Cd = Conduction area*ksub/subdepth</span></span>
<span id="cb11-150"><a href="#cb11-150"></a>    <span class="cf">if</span> (S <span class="op">==</span><span class="st"> </span><span class="dv">2</span>) {</span>
<span id="cb11-151"><a href="#cb11-151"></a>        AREACND &lt;-<span class="st"> </span>ATOT <span class="op">*</span><span class="st"> </span>(PCOND <span class="op">*</span><span class="st"> </span><span class="dv">2</span>)</span>
<span id="cb11-152"><a href="#cb11-152"></a>        CD &lt;-<span class="st"> </span>(AREACND <span class="op">*</span><span class="st"> </span>KSUB)<span class="op">/</span><span class="fl">0.025</span>  <span class="co"># assume conduction happens from 2.5 cm depth</span></span>
<span id="cb11-153"><a href="#cb11-153"></a>    } <span class="cf">else</span> {</span>
<span id="cb11-154"><a href="#cb11-154"></a>        <span class="co"># doing dorsal side, no conduction. No need to adjust areas</span></span>
<span id="cb11-155"><a href="#cb11-155"></a>        <span class="co"># used for convection.</span></span>
<span id="cb11-156"><a href="#cb11-156"></a>        AREACND &lt;-<span class="st"> </span><span class="dv">0</span></span>
<span id="cb11-157"><a href="#cb11-157"></a>        CD &lt;-<span class="st"> </span><span class="dv">0</span></span>
<span id="cb11-158"><a href="#cb11-158"></a>    }</span>
<span id="cb11-159"><a href="#cb11-159"></a></span>
<span id="cb11-160"><a href="#cb11-160"></a>    <span class="co"># package up inputs</span></span>
<span id="cb11-161"><a href="#cb11-161"></a>    FURVARS &lt;-<span class="st"> </span><span class="kw">c</span>(LEN, ZFUR, FURTHRMK, KEFF, BETARA, FURTST, ZL, </span>
<span id="cb11-162"><a href="#cb11-162"></a>        LHAR[S <span class="op">+</span><span class="st"> </span><span class="dv">1</span>], DHAR[S <span class="op">+</span><span class="st"> </span><span class="dv">1</span>], RHOAR[S <span class="op">+</span><span class="st"> </span><span class="dv">1</span>], REFLFR[S <span class="op">+</span><span class="st"> </span><span class="dv">1</span>], </span>
<span id="cb11-163"><a href="#cb11-163"></a>        KHAIR, S)</span>
<span id="cb11-164"><a href="#cb11-164"></a>    GEOMVARS &lt;-<span class="st"> </span><span class="kw">c</span>(SHAPE, SUBQFAT, CONVAR, VOL, D, CONVAR, CONVSK, </span>
<span id="cb11-165"><a href="#cb11-165"></a>        RFUR, RFLESH, RSKIN, XR, RRAD, ASEMAJ, BSEMIN, CSEMIN, </span>
<span id="cb11-166"><a href="#cb11-166"></a>        CD, PCOND, RFURCMP, BLCMP, KFURCMPRS)</span>
<span id="cb11-167"><a href="#cb11-167"></a>    ENVVARS &lt;-<span class="st"> </span><span class="kw">c</span>(FLTYPE, TA, TS, TBUSH, TVEG, TLOWER, TSKY, TCONDSB, </span>
<span id="cb11-168"><a href="#cb11-168"></a>        RH, VEL, BP, ELEV, FASKY, FABUSH, FAVEG, FAGRD, QSLR)</span>
<span id="cb11-169"><a href="#cb11-169"></a>    TRAITS &lt;-<span class="st"> </span><span class="kw">c</span>(TC, AK1, AK2, EMISAN, FATTHK, FLYHR, FURWET, </span>
<span id="cb11-170"><a href="#cb11-170"></a>        PCTBAREVAP, PCTEYES)</span>
<span id="cb11-171"><a href="#cb11-171"></a></span>
<span id="cb11-172"><a href="#cb11-172"></a>    <span class="co"># set IPT, the geometry assumed in SIMULSOL: 1 = cylinder, 2</span></span>
<span id="cb11-173"><a href="#cb11-173"></a>    <span class="co"># = sphere, 3 = ellipsoid</span></span>
<span id="cb11-174"><a href="#cb11-174"></a>    <span class="cf">if</span> (SHAPE <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">3</span>)) {</span>
<span id="cb11-175"><a href="#cb11-175"></a>        IPT &lt;-<span class="st"> </span><span class="dv">1</span></span>
<span id="cb11-176"><a href="#cb11-176"></a>    }</span>
<span id="cb11-177"><a href="#cb11-177"></a>    <span class="cf">if</span> (SHAPE <span class="op">==</span><span class="st"> </span><span class="dv">2</span>) {</span>
<span id="cb11-178"><a href="#cb11-178"></a>        IPT &lt;-<span class="st"> </span><span class="dv">2</span></span>
<span id="cb11-179"><a href="#cb11-179"></a>    }</span>
<span id="cb11-180"><a href="#cb11-180"></a>    <span class="cf">if</span> (SHAPE <span class="op">==</span><span class="st"> </span><span class="dv">4</span>) {</span>
<span id="cb11-181"><a href="#cb11-181"></a>        IPT &lt;-<span class="st"> </span><span class="dv">3</span></span>
<span id="cb11-182"><a href="#cb11-182"></a>    }</span>
<span id="cb11-183"><a href="#cb11-183"></a></span>
<span id="cb11-184"><a href="#cb11-184"></a>    <span class="co"># call SIMULSOL</span></span>
<span id="cb11-185"><a href="#cb11-185"></a>    SIMULSOL.out[S, ] &lt;-<span class="st"> </span><span class="kw">SIMULSOL</span>(DIFTOL, IPT, FURVARS, GEOMVARS, </span>
<span id="cb11-186"><a href="#cb11-186"></a>        ENVVARS, TRAITS, TFA, PCTWET, TS)</span>
<span id="cb11-187"><a href="#cb11-187"></a>}</span>
<span id="cb11-188"><a href="#cb11-188"></a></span>
<span id="cb11-189"><a href="#cb11-189"></a>SIMULSOL.out &lt;-<span class="st"> </span><span class="kw">cbind</span>(<span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>), SIMULSOL.out)</span>
<span id="cb11-190"><a href="#cb11-190"></a><span class="kw">colnames</span>(SIMULSOL.out) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;SIDE&quot;</span>, <span class="st">&quot;TFA&quot;</span>, <span class="st">&quot;TSKIN&quot;</span>, <span class="st">&quot;QCONV&quot;</span>, </span>
<span id="cb11-191"><a href="#cb11-191"></a>    <span class="st">&quot;QCOND&quot;</span>, <span class="st">&quot;QGENNET&quot;</span>, <span class="st">&quot;QSEVAP&quot;</span>, <span class="st">&quot;QRAD&quot;</span>, <span class="st">&quot;QSLR&quot;</span>, <span class="st">&quot;QRSKY&quot;</span>, <span class="st">&quot;QRBSH&quot;</span>, </span>
<span id="cb11-192"><a href="#cb11-192"></a>    <span class="st">&quot;QRVEG&quot;</span>, <span class="st">&quot;QRGRD&quot;</span>, <span class="st">&quot;QFSEVAP&quot;</span>, <span class="st">&quot;NTRY&quot;</span>, <span class="st">&quot;SUCCESS&quot;</span>)</span>
<span id="cb11-193"><a href="#cb11-193"></a>tSIMULSOL.out &lt;-<span class="st"> </span><span class="kw">t</span>(SIMULSOL.out)</span>
<span id="cb11-194"><a href="#cb11-194"></a><span class="kw">colnames</span>(tSIMULSOL.out) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;DORSAL&quot;</span>, <span class="st">&quot;VENTRAL&quot;</span>)</span>
<span id="cb11-195"><a href="#cb11-195"></a><span class="kw">kable</span>(tSIMULSOL.out)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">DORSAL</th>
<th align="right">VENTRAL</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">SIDE</td>
<td align="right">1.000000</td>
<td align="right">2.0000000</td>
</tr>
<tr class="even">
<td align="left">TFA</td>
<td align="right">39.482699</td>
<td align="right">30.4086839</td>
</tr>
<tr class="odd">
<td align="left">TSKIN</td>
<td align="right">37.833696</td>
<td align="right">34.7073375</td>
</tr>
<tr class="even">
<td align="left">QCONV</td>
<td align="right">83.122683</td>
<td align="right">44.1759448</td>
</tr>
<tr class="odd">
<td align="left">QCOND</td>
<td align="right">0.000000</td>
<td align="right">0.0000000</td>
</tr>
<tr class="even">
<td align="left">QGENNET</td>
<td align="right">-1.644885</td>
<td align="right">4.5234311</td>
</tr>
<tr class="odd">
<td align="left">QSEVAP</td>
<td align="right">0.142354</td>
<td align="right">0.1150878</td>
</tr>
<tr class="even">
<td align="left">QRAD</td>
<td align="right">37.200454</td>
<td align="right">18.9954080</td>
</tr>
<tr class="odd">
<td align="left">QSLR</td>
<td align="right">122.110376</td>
<td align="right">58.7630095</td>
</tr>
<tr class="even">
<td align="left">QRSKY</td>
<td align="right">37.200454</td>
<td align="right">0.0000000</td>
</tr>
<tr class="odd">
<td align="left">QRBSH</td>
<td align="right">0.000000</td>
<td align="right">0.0000000</td>
</tr>
<tr class="even">
<td align="left">QRVEG</td>
<td align="right">0.000000</td>
<td align="right">0.0000000</td>
</tr>
<tr class="odd">
<td align="left">QRGRD</td>
<td align="right">0.000000</td>
<td align="right">18.9954080</td>
</tr>
<tr class="even">
<td align="left">QFSEVAP</td>
<td align="right">0.000000</td>
<td align="right">0.0000000</td>
</tr>
<tr class="odd">
<td align="left">NTRY</td>
<td align="right">1.000000</td>
<td align="right">1.0000000</td>
</tr>
<tr class="even">
<td align="left">SUCCESS</td>
<td align="right">1.000000</td>
<td align="right">1.0000000</td>
</tr>
</tbody>
</table>
</div>
<div id="zbrent_endo-and-respfun" class="section level3">
<h3>ZBRENT_ENDO and RESPFUN</h3>
<p>Finally, find a value of QRESP (heat lost by respiration) to balance the heat budget by solving RESPFUN with ZBRENT.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1"></a><span class="co"># define basal metabolic rate</span></span>
<span id="cb12-2"><a href="#cb12-2"></a>QBASAL &lt;-<span class="st"> </span>(<span class="dv">70</span> <span class="op">*</span><span class="st"> </span>AMASS<span class="op">^</span><span class="fl">0.75</span>) <span class="op">*</span><span class="st"> </span>(<span class="fl">4.185</span><span class="op">/</span>(<span class="dv">24</span> <span class="op">*</span><span class="st"> </span><span class="fl">3.6</span>))  <span class="co"># heat generation (W), from Kleiber 1947</span></span>
<span id="cb12-3"><a href="#cb12-3"></a>DELTAR &lt;-<span class="st"> </span><span class="dv">0</span>  <span class="co"># offset between air temperature and breath (°C)</span></span>
<span id="cb12-4"><a href="#cb12-4"></a>O2GAS &lt;-<span class="st"> </span><span class="fl">20.95</span>  <span class="co"># oxygen concentration of air (%)</span></span>
<span id="cb12-5"><a href="#cb12-5"></a>N2GAS &lt;-<span class="st"> </span><span class="fl">79.02</span>  <span class="co"># nitrogen concentration of air (%)</span></span>
<span id="cb12-6"><a href="#cb12-6"></a>CO2GAS &lt;-<span class="st"> </span><span class="fl">0.0412</span>  <span class="co"># carbon dioxide concentration of air (%)</span></span>
<span id="cb12-7"><a href="#cb12-7"></a>R_PCO2 &lt;-<span class="st"> </span>CO2GAS<span class="op">/</span><span class="dv">100</span>  <span class="co"># reference atmospheric dioxide concentration of air (proportion),</span></span>
<span id="cb12-8"><a href="#cb12-8"></a><span class="co"># to allow for anthropogenic change (%)</span></span>
<span id="cb12-9"><a href="#cb12-9"></a>RQ &lt;-<span class="st"> </span><span class="fl">0.8</span>  <span class="co"># respiratory quotient (fractional, typically 0.7 (fats)</span></span>
<span id="cb12-10"><a href="#cb12-10"></a><span class="co"># to 1 (carbs), with 0.8 typical for protein)</span></span>
<span id="cb12-11"><a href="#cb12-11"></a>EXTREF &lt;-<span class="st"> </span><span class="dv">20</span>  <span class="co"># O2 extraction efficiency (%)</span></span>
<span id="cb12-12"><a href="#cb12-12"></a>RELXIT &lt;-<span class="st"> </span><span class="dv">100</span>  <span class="co"># relative humidity of exhaled air (%)</span></span>
<span id="cb12-13"><a href="#cb12-13"></a>TIMACT &lt;-<span class="st"> </span><span class="dv">1</span>  <span class="co"># multiplier on metabolic rate for activity costs</span></span>
<span id="cb12-14"><a href="#cb12-14"></a>PANT &lt;-<span class="st"> </span><span class="dv">1</span>  <span class="co"># multiplier on breathing rate (-)</span></span>
<span id="cb12-15"><a href="#cb12-15"></a></span>
<span id="cb12-16"><a href="#cb12-16"></a><span class="co"># Now compute a weighted mean heat generation for all the</span></span>
<span id="cb12-17"><a href="#cb12-17"></a><span class="co"># parts/components = (dorsal value *(FASKY+FAVEG))+(ventral</span></span>
<span id="cb12-18"><a href="#cb12-18"></a><span class="co"># value*FAGRD)</span></span>
<span id="cb12-19"><a href="#cb12-19"></a>GEND &lt;-<span class="st"> </span>SIMULSOL.out[<span class="dv">1</span>, <span class="dv">6</span>]</span>
<span id="cb12-20"><a href="#cb12-20"></a>GENV &lt;-<span class="st"> </span>SIMULSOL.out[<span class="dv">2</span>, <span class="dv">6</span>]</span>
<span id="cb12-21"><a href="#cb12-21"></a>DMULT &lt;-<span class="st"> </span>FASKYREF <span class="op">+</span><span class="st"> </span>FAVEGREF</span>
<span id="cb12-22"><a href="#cb12-22"></a>VMULT &lt;-<span class="st"> </span><span class="dv">1</span> <span class="op">-</span><span class="st"> </span>DMULT  <span class="co"># Assume that reflectivity of veg below equals reflectivity of soil </span></span>
<span id="cb12-23"><a href="#cb12-23"></a><span class="co"># so VMULT left as 1 - DMULT</span></span>
<span id="cb12-24"><a href="#cb12-24"></a>X &lt;-<span class="st"> </span>GEND <span class="op">*</span><span class="st"> </span>DMULT <span class="op">+</span><span class="st"> </span>GENV <span class="op">*</span><span class="st"> </span>VMULT  <span class="co"># weighted estimate of metabolic heat generation</span></span>
<span id="cb12-25"><a href="#cb12-25"></a></span>
<span id="cb12-26"><a href="#cb12-26"></a><span class="co"># lung temperature and temperature of exhaled air</span></span>
<span id="cb12-27"><a href="#cb12-27"></a>TS &lt;-<span class="st"> </span>(SIMULSOL.out[<span class="dv">1</span>, <span class="dv">2</span>] <span class="op">+</span><span class="st"> </span>SIMULSOL.out[<span class="dv">2</span>, <span class="dv">2</span>]) <span class="op">*</span><span class="st"> </span><span class="fl">0.5</span></span>
<span id="cb12-28"><a href="#cb12-28"></a>TLUNG &lt;-<span class="st"> </span>(TC <span class="op">+</span><span class="st"> </span>TS) <span class="op">*</span><span class="st"> </span><span class="fl">0.5</span>  <span class="co"># average of skin and core</span></span>
<span id="cb12-29"><a href="#cb12-29"></a>TAEXIT &lt;-<span class="st"> </span><span class="kw">min</span>(TA <span class="op">+</span><span class="st"> </span>DELTAR, TLUNG)  <span class="co"># temperature of exhaled air, °C</span></span>
<span id="cb12-30"><a href="#cb12-30"></a>QMIN &lt;-<span class="st"> </span>QBASAL</span>
<span id="cb12-31"><a href="#cb12-31"></a>QM1 &lt;-<span class="st"> </span>X <span class="op">-</span><span class="st"> </span>(<span class="dv">5</span> <span class="op">*</span><span class="st"> </span>QMIN)</span>
<span id="cb12-32"><a href="#cb12-32"></a>QM2 &lt;-<span class="st"> </span>X <span class="op">+</span><span class="st"> </span>(<span class="dv">10</span> <span class="op">*</span><span class="st"> </span>QMIN)</span>
<span id="cb12-33"><a href="#cb12-33"></a>QSUM &lt;-<span class="st"> </span>X</span>
<span id="cb12-34"><a href="#cb12-34"></a>TOL &lt;-<span class="st"> </span>AMASS <span class="op">*</span><span class="st"> </span><span class="fl">0.01</span></span>
<span id="cb12-35"><a href="#cb12-35"></a>ZBRENT.in &lt;-<span class="st"> </span><span class="kw">c</span>(TA, O2GAS, N2GAS, CO2GAS, BP, QMIN, RQ, TLUNG, </span>
<span id="cb12-36"><a href="#cb12-36"></a>    GMASS, EXTREF, RH, RELXIT, TIMACT, TAEXIT, QSUM, PANT, R_PCO2)</span>
<span id="cb12-37"><a href="#cb12-37"></a></span>
<span id="cb12-38"><a href="#cb12-38"></a><span class="co"># call ZBRENT subroutine which calls RESPFUN</span></span>
<span id="cb12-39"><a href="#cb12-39"></a>ZBRENT.out &lt;-<span class="st"> </span><span class="kw">ZBRENT_ENDO</span>(QM1, QM2, TOL, ZBRENT.in)</span>
<span id="cb12-40"><a href="#cb12-40"></a><span class="kw">colnames</span>(ZBRENT.out) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;RESPFN&quot;</span>, <span class="st">&quot;QRESP&quot;</span>, <span class="st">&quot;GEVAP&quot;</span>, <span class="st">&quot;PCTO2&quot;</span>, </span>
<span id="cb12-41"><a href="#cb12-41"></a>    <span class="st">&quot;PCTN2&quot;</span>, <span class="st">&quot;PCTCO2&quot;</span>, <span class="st">&quot;RESPGEN&quot;</span>, <span class="st">&quot;O2STP&quot;</span>, <span class="st">&quot;O2MOL1&quot;</span>, <span class="st">&quot;N2MOL1&quot;</span>, </span>
<span id="cb12-42"><a href="#cb12-42"></a>    <span class="st">&quot;AIRML1&quot;</span>, <span class="st">&quot;O2MOL2&quot;</span>, <span class="st">&quot;N2MOL2&quot;</span>, <span class="st">&quot;AIRML2&quot;</span>, <span class="st">&quot;AIRVOL&quot;</span>)</span>
<span id="cb12-43"><a href="#cb12-43"></a>tZBRENT.out &lt;-<span class="st"> </span><span class="kw">t</span>(ZBRENT.out)</span>
<span id="cb12-44"><a href="#cb12-44"></a><span class="kw">colnames</span>(tZBRENT.out) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;OUTPUT&quot;</span>)</span>
<span id="cb12-45"><a href="#cb12-45"></a><span class="kw">kable</span>(tZBRENT.out)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">OUTPUT</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">RESPFN</td>
<td align="right">-0.0439807</td>
</tr>
<tr class="even">
<td align="left">QRESP</td>
<td align="right">1.3473811</td>
</tr>
<tr class="odd">
<td align="left">GEVAP</td>
<td align="right">0.0003498</td>
</tr>
<tr class="even">
<td align="left">PCTO2</td>
<td align="right">0.2095000</td>
</tr>
<tr class="odd">
<td align="left">PCTN2</td>
<td align="right">0.7902000</td>
</tr>
<tr class="even">
<td align="left">PCTCO2</td>
<td align="right">0.0004120</td>
</tr>
<tr class="odd">
<td align="left">RESPGEN</td>
<td align="right">2.7426733</td>
</tr>
<tr class="even">
<td align="left">O2STP</td>
<td align="right">0.0010124</td>
</tr>
<tr class="odd">
<td align="left">O2MOL1</td>
<td align="right">0.0002259</td>
</tr>
<tr class="even">
<td align="left">N2MOL1</td>
<td align="right">0.0008519</td>
</tr>
<tr class="odd">
<td align="left">AIRML1</td>
<td align="right">0.0010782</td>
</tr>
<tr class="even">
<td align="left">O2MOL2</td>
<td align="right">0.0001807</td>
</tr>
<tr class="odd">
<td align="left">N2MOL2</td>
<td align="right">0.0008519</td>
</tr>
<tr class="even">
<td align="left">AIRML2</td>
<td align="right">0.0010346</td>
</tr>
<tr class="odd">
<td align="left">AIRVOL</td>
<td align="right">0.0241661</td>
</tr>
</tbody>
</table>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
