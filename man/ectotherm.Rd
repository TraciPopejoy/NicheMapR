% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/ectotherm.R
\encoding{UTF-8}
\name{ectotherm}
\alias{ectotherm}
\title{Ectotherm model}
\usage{
ectotherm(Ww_g, shape, alpha_max, alpha_min, T_F_min, T_F_max, T_B_min, T_RB_min, CT_max, CT_min,
 T_pref, diurn, nocturn, crepus, shade_seek, burrow, climb, shdburrow, mindepth, maxdepth,
 M_1, M_2, M_3, pct_wet, F_O2, delta_air, ...)
}
\arguments{
\item{Ww_g}{= 40, Wet weight of animal (g), note this model is 'steady state' so no lags in heating/cooling due to mass}

\item{shape}{= 3, Organism shape, 0-5, Determines whether standard or custom shapes/surface area/volume relationships are used: 0=plate, 1=cyl, 2=ellips, 3=lizard (desert iguana), 4=frog (leopard frog), 5=custom (see details)}

\item{alpha_max}{= 0.85, Maximum solar absorptivity, 0-1}

\item{alpha_min}{= 0.85, Maximum solar absorptivity, 0-1}

\item{T_F_min}{= 24, Minimum foraging temperature, °C (also affects burrow depth selection)}

\item{T_F_max}{= 34, Maximum foraging temperature, °C}

\item{T_B_min}{= 17.5, Minimum basking temperature, °C}

\item{T_RB_min}{= 17.5, Minimum temperature at which animal will move from retreat to basking site, °C}

\item{T_pref}{= 30, Preferred body temperature, °C}

\item{CT_max}{= 40, Critical thermal maximum, °C (affects burrow depth selection and may be used to impose death from heat stress)}

\item{CT_min}{= 6, Critical thermal minimum, °C (affects burrow depth selection and may be used to impose death from cold stress)}

\item{diurn}{= 1, Diurnal activity allowed?  1=yes, 0=no}

\item{nocturn}{= 0, Nocturnal activity allowed?  1=yes, 0=no}

\item{crepus}{= 0, Crepuscular activity allowed?  1=yes, 0=no}

\item{shade_seek}{= 1, Shade seeking allowed?  1=yes, 0=no}

\item{burrow}{= 1 Shelter in burrow allowed?  1=yes, 0=no}

\item{climb}{= 0, Climbing to seek cooler habitats allowed?  1=yes, 0=no}

\item{shdburrow}{= 0, Choose if the animal's retreat is in the open (0), in the shade when above or below CTmin in sun (1) or in shade always (2)}

\item{mindepth}{= 2, Minimum depth (soil node #) to which animal can retreat if burrowing}

\item{maxdepth}{= 10, Maximum depth (soil node #) to which animal can retreat if burrowing}

\item{M_1}{= 0.013, Metabolic rate parameter 1 V_O2=M_1*M^M_2*10^(M_3*Tb), in ml O2 / h, default parameters for lizards based on Eq. 2 from Andrews & Pough 1985. Physiol. Zool. 58:214-231}

\item{M_2}{= 0.800, Metabolic rate parameter 2}

\item{M_3}{= 0.038, Metabolic rate parameter 3}

\item{pct_wet}{= 0.2, \% of surface area acting as a free-water exchanger, for computing cutaneous water loss}

\item{pct_eyes}{= 0.03, \% of surface area taken up by open eyes, for computing ocular water loss (only when active)}

\item{pct_mouth}{= 5, \% of surface area taken up by open mouth, for computing panting water loss}

\item{pantmax}{= 5, maximum multiplier on breathing rate, for respiratory water loss via panting}

\item{F_O2}{= 20, \% oxygen extraction efficiency, for respiratory water loss}

\item{delta_air}{= 0.1, Temperature difference (°C) between expired and inspired air, for computing respiratory water loss}

\item{aestdepth}{= 10, Depth (soil node #) to which animal retreats if burrowing and aestivating due to desiccation}
}
\description{
An implementation of the Niche Mapper ectotherm model that computes body temperature, water loss,
activity and microhabitat selection. It optionally runs the Dynamic Energy Budget (DEB) model for
computing mass budgets (inc. water budgets) and growth, development, reproduction trajectories
as constrained by food, activity and temperature (see Details). When not running the DEB model
a user-specified mass is used as well as a allometric (mass and body temperature) function to
compute metabolic rate. \cr\cr NOTE: The microclimate model, e.g. \code{\link{micro_global}}, must be run prior to running the ectotherm model
}
\details{

}
\examples{
# run the microclimate model
micro <- micro_global(loc = c(145.620, -16.821)) #Kuranda, Queensland

# retrieve output
metout <- as.data.frame(micro$metout) # above ground microclimatic conditions, min shade
shadmet <- as.data.frame(micro$shadmet) # above ground microclimatic conditions, max shade
soil <- as.data.frame(micro$soil) # soil temperatures, minimum shade
shadsoil <- as.data.frame(micro$shadsoil) # soil temperatures, maximum shade

# append dates
dates <- micro$dates
metout <- cbind(dates, metout)
soil <- cbind(dates, soil)
shadmet <- cbind(dates, shadmet)
shadsoil <- cbind(dates, shadsoil)

# run the ectotherm model
ecto <- ectotherm(T_F_min = 30, T_F_max = 35, T_pref = 33, T_B_min = 20, T_RB_min = 10)

# retrieve output
environ <- as.data.frame(ecto$environ) # activity, Tb and environment
enbal <- as.data.frame(ecto$enbal) # energy balance values
masbal <- as.data.frame(ecto$masbal) # mass balance value (note most missing if DEB model not running)

# append dates
environ <- cbind(dates, environ)
masbal <- cbind(dates, masbal)
enbal <- cbind(dates, enbal)

############### plot results ######################

# Hourly Tb (black), activity (orange, 5 = bask, 10 = forage), depth (brown, m) and shade (green, \%/10)
with(environ, plot(TC ~ dates, ylab = "", xlab="month of year", col = 'black', xlim = c(-0.25, 12), ylim = c(-20, 40), type = "l", yaxt = 'n'))
with(environ, points(ACT * 2 + 7 ~ dates, type = "p", pch = 16, col = "orange"))
with(environ, points(SHADE / 10 - 6 ~ dates, type = "l", col = "dark green"))
with(environ, points(DEP - 10 ~ dates, type = "l", col = "brown"))
abline(ecto$T_F_min, 0, lty = 2, col = 'blue')
abline(ecto$T_F_max, 0, lty = 2, col = 'red')
ytick<-seq(15, 40, by=5)
axis(side=2, at=ytick, labels = TRUE)
mtext(text = c('A', 'B', 'I'), side = 2, line = 1, at = c(11, 9, 7))
ytick<-seq(-6, 4, by=2)
axis(side=2, at=ytick, labels = FALSE)
mtext(text = seq(0, 100, 20), side = 2, line = 1, at = seq(-6, 4, 2), las = 2)
ytick<-seq(-20, -10, by=2)
axis(side=2, at=ytick, labels = FALSE)
mtext(text = rev(seq(0, 100, 20)), side = 2, line = 1, at = seq(-20, -10, 2), las = 2)
abline(h = -10, lty = 2, col = 'grey')
mtext(text = c('body temperature (Â°C)', 'activity', 'shade (\%)', 'depth (cm)'), side = 2, line = 2.5, at = c(30, 9, 0, -15))
text(-0.2, c(ecto$T_F_max + 1, ecto$T_F_min + 1), c('T_F_max', 'T_F_min'), col = c('red', 'blue'), cex = 0.75)

# seasonal activity plot (dark blue = night, light blue = basking, orange = foraging)
forage <- subset(environ, ACT == 2)
bask <- subset(environ, ACT == 1)
night <- subset(metout, ZEN == 90)
day <- subset(metout, ZEN != 90)
with(night, plot(TIME / 60 ~ DOY, ylab = "Hour of Day", xlab = "Day of Year", pch = 15, cex = 2, col = 'dark blue'))
# nighttime hours
with(forage, points(TIME ~ DOY, pch = 15, cex = 2, col = 'orange')) # foraging Tbs
with(bask, points(TIME ~ DOY, pch = 15, cex = 2, col = 'light blue')) # basking Tbs
}
